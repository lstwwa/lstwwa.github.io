<!DOCTYPE html>
<html>
<head>
    <title>lstwwa的小站</title>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="/img/128x128.png">
    
<link rel="stylesheet" href="/css/main.css">

    
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="main">
        <aside>
            <!-- 搜索栏 -->
<div id="search">
    <input class="search-input" type="text" placeholder="🔍网站索引">
</div>

<!-- 侧边目录栏 -->
<div id="tree">
    

    
                    <ul>
                        <li class="directory">
                            <a href="#" class="directory">
                                <i class="fa fa-folder"></i>
                                ceshi
                            </a>
                            
                    <ul>
                        <li class="file">
                            <a href="/ceshi/ceshi/">
                                <i class="fa fa-file"></i>
                                ceshi
                            </a>
                        </li>
                    </ul>
    
                        </li>
                        
                    </ul>
    
                    <ul>
                        <li class="directory">
                            <a href="#" class="directory">
                                <i class="fa fa-folder"></i>
                                代码-安卓开发
                            </a>
                            
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/Activity/">
                                <i class="fa fa-file"></i>
                                Activity
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/Intent/">
                                <i class="fa fa-file"></i>
                                Intent
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/Q&A/">
                                <i class="fa fa-file"></i>
                                Q&A
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/基本UI组件/">
                                <i class="fa fa-file"></i>
                                基本UI组件
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/布局管理器/">
                                <i class="fa fa-file"></i>
                                布局管理器
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/常用安卓功能/">
                                <i class="fa fa-file"></i>
                                常用安卓功能
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/手势监测-GestureDetector/">
                                <i class="fa fa-file"></i>
                                手势监测-GestureDetector
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/无标题/">
                                <i class="fa fa-file"></i>
                                无标题
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/消息-Toast-AliertDialog-Notification/">
                                <i class="fa fa-file"></i>
                                消息-Toast-AliertDialog-Notification
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/菜单-menu/">
                                <i class="fa fa-file"></i>
                                菜单-menu
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/资源-Resources/">
                                <i class="fa fa-file"></i>
                                资源-Resources
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/顶栏-ActionBar/">
                                <i class="fa fa-file"></i>
                                顶栏-ActionBar
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/代码-安卓开发/高级UI组件/">
                                <i class="fa fa-file"></i>
                                高级UI组件
                            </a>
                        </li>
                    </ul>
    
                        </li>
                        
                    </ul>
    
                    <ul>
                        <li class="directory">
                            <a href="#" class="directory">
                                <i class="fa fa-folder"></i>
                                支持-数码产品
                            </a>
                            
                    <ul>
                        <li class="file">
                            <a href="/支持-数码产品/ADB|三星精简列表/">
                                <i class="fa fa-file"></i>
                                ADB|三星精简列表
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/支持-数码产品/ADB|索尼精简列表/">
                                <i class="fa fa-file"></i>
                                ADB|索尼精简列表
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/支持-数码产品/ADB|鸿蒙精简列表/">
                                <i class="fa fa-file"></i>
                                ADB|鸿蒙精简列表
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/支持-数码产品/Galaxy Watch | LSky/">
                                <i class="fa fa-file"></i>
                                Galaxy Watch | LSky
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/支持-数码产品/Mac说明/">
                                <i class="fa fa-file"></i>
                                Mac说明
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/支持-数码产品/Phone | Pixel3(lueline)/">
                                <i class="fa fa-file"></i>
                                Phone | Pixel3(lueline)
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/支持-数码产品/Pixel壁纸合集/">
                                <i class="fa fa-file"></i>
                                Pixel壁纸合集
                            </a>
                        </li>
                    </ul>
    
                    <ul>
                        <li class="file">
                            <a href="/支持-数码产品/QQ国际版支持/">
                                <i class="fa fa-file"></i>
                                QQ国际版支持
                            </a>
                        </li>
                    </ul>
    
                        </li>
                        
                    </ul>
    
</div>


<!-- 最尾部添加，这里就不列以前的代码了 -->
<div id="toc" style="display: none;"></div>

        </aside>
		
		 <asidemenu>
            <!-- 搜索栏 -->
<div id="tmenu">
    <id="tmenu"  title="切换目录与索引">文章目录</i>
</div>

<!-- 侧边目录栏 -->
<div id="tree">


    
</div>


<!-- 最尾部添加，这里就不列以前的代码了 -->
<div id="toc"></div>

        </asidemenu>

        <div id="content">
            <!--
<div>
    <span id="post-author">Lstwwa</span>
    <span id="post-date">2021-04-25 00:00:00</span>
</div>
  -->

<div id="article">
    <ul>
<li>部分未进行整理，若有需求联系邮箱</li>
</ul>
<span id="more"></span> 

<h1 id="前-言"><a href="#前-言" class="headerlink" title="前   言"></a>前   言</h1><p>数字信号处理是一门理论和工程实践密切结合的课程。为了加深对教学内容的理解，应在学习理论的同时，加强上机实验，深入理解和消化基本理论，锻炼初学者独立解决问题的能力。本课程实验要求学生运用MATLAB编程完成一些数字信号处理的基本功能。 </p>
<!-- more -->
<p>MATLAB是一种强大的分析、计算及可视化工具。它以矩阵运算为基础进行数据处理，将高性能的数值计算和可视化集成在一起，提供了大量的内置函数，因而被广泛应用于科学计算、系统控制以及信息处理等领域。在DSP系统开发中，MATLAB丰富的信号处理工具箱是一种非常有效的辅助设计工具。通常，我们采用MATLAB工具与DSP汇编语言结合起来的方法进行设计。MATLAB主要发挥以下作用：</p>
<ul>
<li>1、提供设计数据。利用MATLAB的科学计算功能，对特定的设计任务进行计算，得出的设计数据（如数字滤波器的系数、数字化的输入信号等）可以提供给DSP系统的程序，供实现DSP系统或进行调试时使用。</li>
<li>2、进行模拟仿真。在设计一个实时的DSP系统前，通常先使用MATLAB对算法在DSP上的运行性能进行仿真，仿真结果正确再通过编程将该算法从MATLAB改编成C或DSP汇编语言，在目标DSP上实现。</li>
</ul>
<p>由此可见，学习MATLAB在信号处理方面的知识是非常必要的。<br>用MATLAB开设数字信号处理实验时，学生必须具备电路、信号与系统、数字信号处理及MATLAB语言方面的知识。数字信号处理实验课将为后继的DSP应用、语音处理、现代通信系统等专业课打下基础。<br>本实验讲义依据数字信号处理的基本理论及MATLAB在数字信号处理中的应用选择编排了12个实验。实验内容涉及离散LSI系统的时域及频域分析，离散傅里叶级数及离散傅里叶变换、z变换、抽样定理以及数字滤波器的设计，基本涵盖了本科阶段数字信号处理课程的主要知识点。完全与我校电子、通信专业本科生当前选用的数字信号处理教材同步。希望对学生理解数字信号处理的基本理论、后继专业课的学习以及个人实际动手能力的提高能够提供一定的帮助。<br>另外，本讲义的所有例题程序都经过编者一一验证，所用MATLAB版本为MATLAB7.0。限于编者水平，难免存在一些不足。真诚希望有兴趣的读者提出宝贵建议促进课程发展，共同探秘奇妙的数字信号处理世界。</p>
<h1 id="实验1-用MATLAB产生时域离散信号"><a href="#实验1-用MATLAB产生时域离散信号" class="headerlink" title="实验1  用MATLAB产生时域离散信号"></a>实验1  用MATLAB产生时域离散信号</h1><h2 id="一、-实验目的："><a href="#一、-实验目的：" class="headerlink" title="一、.实验目的："></a>一、.实验目的：</h2><p>1、了解常用时域离散信号及其特点。<br>2、掌握用MATLAB产生时域离散信号的方法。</p>
<h2 id="二、-实验原理："><a href="#二、-实验原理：" class="headerlink" title="二、.实验原理："></a>二、.实验原理：</h2><h3 id="1、时域离散信号的概念"><a href="#1、时域离散信号的概念" class="headerlink" title="1、时域离散信号的概念"></a>1、时域离散信号的概念</h3><p>在时间轴的离散点上取值的信号，称为离散时间信号。通常，离散时间信号用x(n)表示，其幅度可以在某一范围内连续取值。由于信号处理设备或装置（如计算机、专用的信号处理芯片等）均以有限位的二进制数来表示信号的幅度，因此，信号的幅度也必须离散化。我们把时间和幅度均取离散值的信号称为时域离散信号或数字信号。<br>在MATLAB语言中，时域离散信号可以通过编写程序直接产生。</p>
<h4 id="2、常用时域离散信号的生成"><a href="#2、常用时域离散信号的生成" class="headerlink" title="2、常用时域离散信号的生成"></a>2、常用时域离散信号的生成</h4><h5 id="1-单位抽样序列"><a href="#1-单位抽样序列" class="headerlink" title="1) 单位抽样序列"></a>1) 单位抽样序列</h5><p>单位抽样序列的表示式为<br><img src="https://lstwwa.top/%E5%AD%98%E6%A1%A3/%E5%BD%92%E6%A1%A3-%E5%A4%A7%E5%AD%A6%E7%A7%91%E7%9B%AE/%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%AF%BC%E4%B9%A6.html04/25/%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%AF%BC%E4%B9%A6/%E5%8D%95%E4%BD%8D%E6%8A%BD%E6%A0%B7%E5%BA%8F%E5%88%97%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%BC%8F.png"><br>以下三段程序分别用不同的方法来产生单位抽样序列。</p>
<h6 id="例1-1-用MATLAB的关系运算式来产生单位抽样序列。"><a href="#例1-1-用MATLAB的关系运算式来产生单位抽样序列。" class="headerlink" title="例1-1 用MATLAB的关系运算式来产生单位抽样序列。"></a>例1-1 用MATLAB的关系运算式来产生单位抽样序列。</h6><pre><code>n1=-5;n2=5;n0=0;
n=n1:n2;
x=[n==n0];  
stem(n,x, &#39;filled&#39;);
axis([n1,n2,0,1.1*max(x)]);
xlabel(&#39;时间(n)&#39;);ylabel(&#39;幅度x(n)&#39;);
title(&#39;单位脉冲序列&#39;);
</code></pre>
<h6 id="例1-2-用zeros函数和抽样点直接赋值来产生单位抽样序列。"><a href="#例1-2-用zeros函数和抽样点直接赋值来产生单位抽样序列。" class="headerlink" title="例1-2 用zeros函数和抽样点直接赋值来产生单位抽样序列。"></a>例1-2 用zeros函数和抽样点直接赋值来产生单位抽样序列。</h6><pre><code>n1=-5;n2=5;k=0;
n=n1:n2;
nt=length(n);
nk=abs(k-n1)+1;
x=zeros(1,nt);
x(nk)=1;
</code></pre>
<h6 id="例1-3-生成移位的单位脉冲序列。"><a href="#例1-3-生成移位的单位脉冲序列。" class="headerlink" title="例1-3 生成移位的单位脉冲序列。"></a>例1-3 生成移位的单位脉冲序列。</h6><pre><code>n1=-5;n2=5;n0=2;
n=n1:n2;
x=[(n-n0)==0];
stem(n,x,&#39;filled&#39;);
axis([n1,n2,0,1.1*max(x)]);
xlabel(&#39;时间(n)&#39;);ylabel(&#39;幅度x(n)&#39;);
title(&#39;单位脉冲序列&#39;);
运行结果如图1-2所示
</code></pre>
<p>图1-2</p>
<h5 id="2-单位阶跃序列"><a href="#2-单位阶跃序列" class="headerlink" title="2) 单位阶跃序列"></a>2) 单位阶跃序列</h5><p>单位阶跃序列表示式为<br>或<br>以下三段程序分别用不同的方法来产生单位阶跃序列。</p>
<h6 id="例1-4用MATLAB的关系运算式来产生单位阶跃序列。"><a href="#例1-4用MATLAB的关系运算式来产生单位阶跃序列。" class="headerlink" title="例1-4用MATLAB的关系运算式来产生单位阶跃序列。"></a>例1-4用MATLAB的关系运算式来产生单位阶跃序列。</h6><pre><code>n1=-2;n2=8;n0=0;
n=n1:n2;
x=[n&gt;=n0];
stem(n,x,&#39;filled&#39;);
axis([n1,n2,0,1.1*max(x)]);
xlabel(&#39;时间(n)&#39;);ylabel(&#39;幅度x(n)&#39;);
title(&#39;单位阶跃序列&#39;);
box
</code></pre>
<p>运行结果如图1-3所示：</p>
<p>图1-3</p>
<h6 id="例1-5-用zeros和ones函数来产生单位阶跃序列。"><a href="#例1-5-用zeros和ones函数来产生单位阶跃序列。" class="headerlink" title="例1-5 用zeros和ones函数来产生单位阶跃序列。"></a>例1-5 用zeros和ones函数来产生单位阶跃序列。</h6><pre><code>n1=-2;n2=8;k=0;
n=n1:n2;
nt=length(n);
nk=abs(k-n1)+1;
x=[zeros(1,nk-1),ones(1,nt-nk+1)];
绘图部分的程序及作图结果与例1-4相同。.
例1-6生成移位的单位阶跃序列。
n1=-10;n2=10;n0=4;n=n1:n2;
x=[(n-n0)&gt;=0];stem(n,x,&#39;filled&#39;);
axis([n1,n2,0,1.1*max(x)]);
xlabel(&#39;时间(n)&#39;);ylabel(&#39;幅度x(n)&#39;);
title(&#39;移位的单位阶跃序列&#39;);box
</code></pre>
<p>程序运行结果如图1-4所示：</p>
<p>图1-4</p>
<h5 id="3-实指数序列"><a href="#3-实指数序列" class="headerlink" title="3) 实指数序列"></a>3) 实指数序列</h5><p>实指数序列的表示式为     x(n)&#x3D;an     其中a为实数</p>
<h6 id="例1-7-编写产生a-x3D-1-x2F-2和a-x3D-2的实指数连续信号和离散序列的程序"><a href="#例1-7-编写产生a-x3D-1-x2F-2和a-x3D-2的实指数连续信号和离散序列的程序" class="headerlink" title="例1-7 编写产生a&#x3D;1&#x2F;2和a&#x3D;2的实指数连续信号和离散序列的程序"></a>例1-7 编写产生a&#x3D;1&#x2F;2和a&#x3D;2的实指数连续信号和离散序列的程序</h6><pre><code>n1=-10;n2=10;a1=0.5;a2=2;
na1=n1:0;x1=a1.^na1;
na2=0:n2;x2=a2.^na2;
subplot(2,2,1);plot(na1,x1);title(&#39;实指数信号（a&lt;1）&#39;);
subplot(2,2,3);stem(na1,x1,&#39;filled&#39;);title(&#39;实指数序列（a&lt;1）&#39;);
subplot(2,2,2);plot(na2,x2);title(&#39;实指数信号（a&gt;1）&#39;);
subplot(2,2,4);stem(na2,x2,&#39;filled&#39;);title(&#39;实指数序列（a&lt;1）&#39;);box
</code></pre>
<p>程序运行结果如图1-5所示：</p>
<p>图1-5</p>
<h5 id="4）复指数序列"><a href="#4）复指数序列" class="headerlink" title="4）复指数序列"></a>4）复指数序列</h5><p>复指数序列的表示式为     x(n)&#x3D;e(σ+jω)n<br>当ω&#x3D;0时，x(n)为实指数序列;当σ&#x3D;0时，x(n)为虚指数序列，即<br>ejωn&#x3D;cos(ωn)+jsin(ωn)<br>其实部为余弦序列，虚部为正弦序列。</p>
<h6 id="例1-8-编写程序产生σ-x3D-0-1，ω-x3D-0-6的复指数连续信号与离散序列。"><a href="#例1-8-编写程序产生σ-x3D-0-1，ω-x3D-0-6的复指数连续信号与离散序列。" class="headerlink" title="例1-8 编写程序产生σ&#x3D;-0.1，ω&#x3D;0.6的复指数连续信号与离散序列。"></a>例1-8 编写程序产生σ&#x3D;-0.1，ω&#x3D;0.6的复指数连续信号与离散序列。</h6><pre><code>n1=30;a=-0.1;w=0.6;
n=0:n1;
x=exp((a+j*w)*n);
subplot(2,2,1);plot(n,real(x));
title(&#39;复指数信号的实部&#39;);
subplot(2,2,3);stem(n,real(x),&#39;filled&#39;);
title(&#39;复指数序列的实部&#39;);
subplot(2,2,2);plot(n,imag(x));
title(&#39;复指数信号的虚部&#39;);
subplot(2,2,4);stem(n,imag(x),&#39;filled&#39;);
title(&#39;复指数序列的虚部&#39;);
box
</code></pre>
<p>程序运行结果如图1-6所示</p>
<p>图1-6</p>
<h5 id="5）正（余）弦序列"><a href="#5）正（余）弦序列" class="headerlink" title="5）正（余）弦序列"></a>5）正（余）弦序列</h5><p>正（余）弦序列的表示式为    x(n)&#x3D;Umsin(ω0n+Θ)</p>
<h6 id="例1-9-已知一时域周期性正弦信号的频率为1Hz，振幅值为1V。编写程序在图形窗口上显示两个周期的信号波形，并对该信号的一个周期进行32点采样获得离散信号。"><a href="#例1-9-已知一时域周期性正弦信号的频率为1Hz，振幅值为1V。编写程序在图形窗口上显示两个周期的信号波形，并对该信号的一个周期进行32点采样获得离散信号。" class="headerlink" title="例1-9 已知一时域周期性正弦信号的频率为1Hz，振幅值为1V。编写程序在图形窗口上显示两个周期的信号波形，并对该信号的一个周期进行32点采样获得离散信号。"></a>例1-9 已知一时域周期性正弦信号的频率为1Hz，振幅值为1V。编写程序在图形窗口上显示两个周期的信号波形，并对该信号的一个周期进行32点采样获得离散信号。</h6><pre><code>f=1;Um=1;nt=2;N=32;T=1/f; 
dt=T/N;n=0:nt*N-1;
tn=n*dt;x=Um*sin(2*f*pi*tn);
subplot(2,1,1);plot(tn,x);
axis([0,nt*T,1.1*min(x),1.1*max(x)]);ylabel(&#39;x(t)&#39;);
subplot(2,1,2);stem(tn,x);axis([0,nt*T,1.1*min(x),1.1*max(x)]);
ylabel(&#39;x(n)&#39;);box
</code></pre>
<p>程序运行结果如图1-7所示</p>
<p>图1-7</p>
<h5 id="6）矩形波序列"><a href="#6）矩形波序列" class="headerlink" title="6）矩形波序列"></a>6）矩形波序列</h5><p>MATLAB提供有专门函数square用于产生矩形波。其调用格式如下：<br>x&#x3D;square(t) ：类似于sin(t),产生周期为2∏，幅值为±1的方波。<br>x&#x3D;square(t，duty)：产生指定周期的矩形波，其中duty用于指定占空比。<br>将square的参数t换成n，且n取整数，则可以获得矩形序列。</p>
<h6 id="例1-10-一个周期性矩形信号频率为5kHz，信号幅度在0～2V之间，占空比为0-25，。编写程序生成该信号，要求在图形窗口上显示2个周期的信号波形；对信号的一个周期进行16点采样获得离散信号。"><a href="#例1-10-一个周期性矩形信号频率为5kHz，信号幅度在0～2V之间，占空比为0-25，。编写程序生成该信号，要求在图形窗口上显示2个周期的信号波形；对信号的一个周期进行16点采样获得离散信号。" class="headerlink" title="例1-10 一个周期性矩形信号频率为5kHz，信号幅度在0～2V之间，占空比为0.25，。编写程序生成该信号，要求在图形窗口上显示2个周期的信号波形；对信号的一个周期进行16点采样获得离散信号。"></a>例1-10 一个周期性矩形信号频率为5kHz，信号幅度在0～2V之间，占空比为0.25，。编写程序生成该信号，要求在图形窗口上显示2个周期的信号波形；对信号的一个周期进行16点采样获得离散信号。</h6><pre><code>f=5000;nt=2;N=16;T=1/f;
dt=T/N;n=0:nt*N-1;tn=n*dt;
x=square(2*f*pi*tn,25)+1;
subplot(2,1,1);plot(tn,x);
axis([0,nt*T,1.1*min(x),1.1*max(x)]);
ylabel(&#39;x(t)&#39;);subplot(2,1,2);stem(tn,x);
axis([0,nt*T,1.1*min(x),1.1*max(x)]);ylabel(&#39;x(n)&#39;);box
</code></pre>
<p>程序运行结果如图1-8所示：</p>
<p>图1-8</p>
<h2 id="三、-实验内容："><a href="#三、-实验内容：" class="headerlink" title="三、.实验内容："></a>三、.实验内容：</h2><h3 id="1、阅读并上机验证实验原理部分的例题程序，理解每一条语句的含义。"><a href="#1、阅读并上机验证实验原理部分的例题程序，理解每一条语句的含义。" class="headerlink" title="1、阅读并上机验证实验原理部分的例题程序，理解每一条语句的含义。"></a>1、阅读并上机验证实验原理部分的例题程序，理解每一条语句的含义。</h3><p>改变例题中的有关参数（如信号的频率、周期、幅度、显示时间的取值范围、采样点数等），观察对信号波形的影响。</p>
<h3 id="2、编写程序，产生以下离散序列："><a href="#2、编写程序，产生以下离散序列：" class="headerlink" title="2、编写程序，产生以下离散序列："></a>2、编写程序，产生以下离散序列：</h3><p>（1）f(n)&#x3D;δ(n)    (-3≤n≤4)         （2）f(n)&#x3D;u(n)    (-5≤n≤5)<br>（3）f(n)&#x3D; e(0.1+j1.6)n   (0≤n≤16)    （4）f(n)&#x3D;3sin(n&#x2F;4)    (0≤n≤20)</p>
<h3 id="3、一个连续的周期性方波信号频率为200Hz，信号幅度在-1～-1V之间，要求在图形窗口上显示其两个周期的波形。以4kHz的频率对连续信号进行采样，编写程序生成连续信号和其采样获得的离散信号波形。"><a href="#3、一个连续的周期性方波信号频率为200Hz，信号幅度在-1～-1V之间，要求在图形窗口上显示其两个周期的波形。以4kHz的频率对连续信号进行采样，编写程序生成连续信号和其采样获得的离散信号波形。" class="headerlink" title="3、一个连续的周期性方波信号频率为200Hz，信号幅度在-1～+1V之间，要求在图形窗口上显示其两个周期的波形。以4kHz的频率对连续信号进行采样，编写程序生成连续信号和其采样获得的离散信号波形。"></a>3、一个连续的周期性方波信号频率为200Hz，信号幅度在-1～+1V之间，要求在图形窗口上显示其两个周期的波形。以4kHz的频率对连续信号进行采样，编写程序生成连续信号和其采样获得的离散信号波形。</h3><h2 id="四、-实验预习："><a href="#四、-实验预习：" class="headerlink" title="四、.实验预习："></a>四、.实验预习：</h2><h3 id="1、预先阅读附录部分的MATLAB基础介绍，认真阅读实验原理，明确本次实验任务，读懂例题程序，了解实验方法。"><a href="#1、预先阅读附录部分的MATLAB基础介绍，认真阅读实验原理，明确本次实验任务，读懂例题程序，了解实验方法。" class="headerlink" title="1、预先阅读附录部分的MATLAB基础介绍，认真阅读实验原理，明确本次实验任务，读懂例题程序，了解实验方法。"></a>1、预先阅读附录部分的MATLAB基础介绍，认真阅读实验原理，明确本次实验任务，读懂例题程序，了解实验方法。</h3><h3 id="2、根据实验内容预先编写实验程序。"><a href="#2、根据实验内容预先编写实验程序。" class="headerlink" title="2、根据实验内容预先编写实验程序。"></a>2、根据实验内容预先编写实验程序。</h3><h3 id="3、预习思考题：产生单位脉冲序列和单位阶跃序列各有几种方法？如何使用？"><a href="#3、预习思考题：产生单位脉冲序列和单位阶跃序列各有几种方法？如何使用？" class="headerlink" title="3、预习思考题：产生单位脉冲序列和单位阶跃序列各有几种方法？如何使用？"></a>3、预习思考题：产生单位脉冲序列和单位阶跃序列各有几种方法？如何使用？</h3><h2 id="五、实验报告："><a href="#五、实验报告：" class="headerlink" title="五、实验报告："></a>五、实验报告：</h2><h2 id="1、列写调试通过的实验程序，打印实验程序产生的曲线图形。"><a href="#1、列写调试通过的实验程序，打印实验程序产生的曲线图形。" class="headerlink" title="1、列写调试通过的实验程序，打印实验程序产生的曲线图形。"></a>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。</h2><h2 id="2、思考题：通过例题程序，你发现采样频率Fs、采样点数N、采样时间间隔dt在程序编写中有怎样的联系？使用时需注意什么问题？"><a href="#2、思考题：通过例题程序，你发现采样频率Fs、采样点数N、采样时间间隔dt在程序编写中有怎样的联系？使用时需注意什么问题？" class="headerlink" title="2、思考题：通过例题程序，你发现采样频率Fs、采样点数N、采样时间间隔dt在程序编写中有怎样的联系？使用时需注意什么问题？"></a>2、思考题：通过例题程序，你发现采样频率Fs、采样点数N、采样时间间隔dt在程序编写中有怎样的联系？使用时需注意什么问题？</h2><h1 id="实验2-离散LSI系统的时域分析"><a href="#实验2-离散LSI系统的时域分析" class="headerlink" title="实验2  离散LSI系统的时域分析"></a>实验2  离散LSI系统的时域分析</h1><h2 id="一、-实验目的：-1"><a href="#一、-实验目的：-1" class="headerlink" title="一、.实验目的："></a>一、.实验目的：</h2><h3 id="1、加深对离散系统的差分方程、单位脉冲响应、单位阶跃响应和卷积分析方法的理解。"><a href="#1、加深对离散系统的差分方程、单位脉冲响应、单位阶跃响应和卷积分析方法的理解。" class="headerlink" title="1、加深对离散系统的差分方程、单位脉冲响应、单位阶跃响应和卷积分析方法的理解。"></a>1、加深对离散系统的差分方程、单位脉冲响应、单位阶跃响应和卷积分析方法的理解。</h3><h3 id="2、初步了解用MATLAB语言进行离散时间系统时域分析的基本方法。"><a href="#2、初步了解用MATLAB语言进行离散时间系统时域分析的基本方法。" class="headerlink" title="2、初步了解用MATLAB语言进行离散时间系统时域分析的基本方法。"></a>2、初步了解用MATLAB语言进行离散时间系统时域分析的基本方法。</h3><h3 id="3、掌握求解离散时间系统的单位脉冲响应、单位阶跃响应、线性卷积以及差分方程的程序的编写方法，了解常用子函数的调用格式。"><a href="#3、掌握求解离散时间系统的单位脉冲响应、单位阶跃响应、线性卷积以及差分方程的程序的编写方法，了解常用子函数的调用格式。" class="headerlink" title="3、掌握求解离散时间系统的单位脉冲响应、单位阶跃响应、线性卷积以及差分方程的程序的编写方法，了解常用子函数的调用格式。"></a>3、掌握求解离散时间系统的单位脉冲响应、单位阶跃响应、线性卷积以及差分方程的程序的编写方法，了解常用子函数的调用格式。</h3><h2 id="二、实验原理："><a href="#二、实验原理：" class="headerlink" title="二、实验原理："></a>二、实验原理：</h2><h3 id="1、离散LSI系统的响应与激励"><a href="#1、离散LSI系统的响应与激励" class="headerlink" title="1、离散LSI系统的响应与激励"></a>1、离散LSI系统的响应与激励</h3><p>由离散时间系统的时域分析方法可知，一个离散LSI系统的响应与激励可以用如下框图表示：</p>
<p>其输入、输出关系可用以下差分方程描述： </p>
<h3 id="2、用函数impz和dstep求解离散系统的单位脉冲响应和单位阶跃响应。"><a href="#2、用函数impz和dstep求解离散系统的单位脉冲响应和单位阶跃响应。" class="headerlink" title="2、用函数impz和dstep求解离散系统的单位脉冲响应和单位阶跃响应。"></a>2、用函数impz和dstep求解离散系统的单位脉冲响应和单位阶跃响应。</h3><h6 id="例2-1-已知描述某因果系统的差分方程为6y-n-2y-n-2-x3D-x-n-3x-n-1-3x-n-2-x-n-3"><a href="#例2-1-已知描述某因果系统的差分方程为6y-n-2y-n-2-x3D-x-n-3x-n-1-3x-n-2-x-n-3" class="headerlink" title="例2-1 已知描述某因果系统的差分方程为6y(n)+2y(n-2)&#x3D;x(n)+3x(n-1)+3x(n-2)+x(n-3)"></a>例2-1 已知描述某因果系统的差分方程为6y(n)+2y(n-2)&#x3D;x(n)+3x(n-1)+3x(n-2)+x(n-3)</h6><p>满足初始条件y(-1)&#x3D;0，x(-1)&#x3D;0，求系统的单位脉冲响应和单位阶跃响应。<br>解：  将y(n)项的系数a0进行归一化，得到<br>y(n)+1&#x2F;3y(n-2)&#x3D;1&#x2F;6x(n)+1&#x2F;2x(n-1)+1&#x2F;2x(n-2)+1&#x2F;6x(n-3)<br>分析上式可知，这是一个3阶系统，列出其bk和ak系数：<br>          a0&#x3D;1，  a,1&#x3D;0，  a,2&#x3D;1&#x2F;3，  a,3&#x3D;0<br>          b0&#x3D;1&#x2F;6，b,1&#x3D;1&#x2F;2， b,2&#x3D;1&#x2F;2，  b,3&#x3D;1&#x2F;6<br>程序清单如下：<br>    a&#x3D;[1,0,1&#x2F;3,0];<br>    b&#x3D;[1&#x2F;6,1&#x2F;2,1&#x2F;2,1&#x2F;6];<br>    N&#x3D;32;<br>    n&#x3D;0:N-1;<br>    hn&#x3D;impz(b,a,n);<br>    gn&#x3D;dstep(b,a,n);<br>    subplot(1,2,1);stem(n,hn,’k’);<br>    title(‘系统的单位序列响应’);<br>    ylabel(‘h(n)’);xlabel(‘n’);<br>    axis([0,N,1.1<em>min(hn),1.1</em>max(hn)]);<br>    subplot(1,2,2);stem(n,gn,’k’);<br>    title(‘系统的单位阶跃响应’);<br>    ylabel(‘g(n)’);xlabel(‘n’);<br>    axis([0,N,1.1<em>min(gn),1.1</em>max(gn)]);<br>程序运行结果如图2-1所示：</p>
<p>图2-1</p>
<h3 id="3、用函数filtic和filter求解离散系统的单位序列响应和单位阶跃响应。"><a href="#3、用函数filtic和filter求解离散系统的单位序列响应和单位阶跃响应。" class="headerlink" title="3、用函数filtic和filter求解离散系统的单位序列响应和单位阶跃响应。"></a>3、用函数filtic和filter求解离散系统的单位序列响应和单位阶跃响应。</h3><h6 id="例2-2-已知描述某因果系统的差分方程为6y-n-2y-n-4-x3D-x-n-3x-n-2-3x-n-4-x-n-6-，满足初始条件y-1-x3D-0，x-1-x3D-0，求系统的单位脉冲响应和单位阶跃响应。时间轴上N取32点。"><a href="#例2-2-已知描述某因果系统的差分方程为6y-n-2y-n-4-x3D-x-n-3x-n-2-3x-n-4-x-n-6-，满足初始条件y-1-x3D-0，x-1-x3D-0，求系统的单位脉冲响应和单位阶跃响应。时间轴上N取32点。" class="headerlink" title="例2-2 已知描述某因果系统的差分方程为6y(n)-2y(n-4)&#x3D;x(n)-3x(n-2)+3x(n-4)-x(n-6)，满足初始条件y(-1)&#x3D;0，x(-1)&#x3D;0，求系统的单位脉冲响应和单位阶跃响应。时间轴上N取32点。"></a>例2-2 已知描述某因果系统的差分方程为6y(n)-2y(n-4)&#x3D;x(n)-3x(n-2)+3x(n-4)-x(n-6)，满足初始条件y(-1)&#x3D;0，x(-1)&#x3D;0，求系统的单位脉冲响应和单位阶跃响应。时间轴上N取32点。</h6><p>注意：原式非标准形式，必须化为标准形式后再列出系数b,a。<br>程序清单如下：</p>
<pre><code>x01=0;y01=0;
a=[1,0,0,0,-1/3,0,0];
b=[1/6,0,-1/2,0,1/2,0,-1/6];
N=32;n=0:N-1;
xi=filtic(b,a,0);
x1=[n==0];
hn=filter(b,a,x1,xi);
x2=[n&gt;=0];
gn=filter(b,a,x2,xi);
subplot(1,2,1);stem(n,hn,&#39;k&#39;);
title(&#39;系统的单位序列响应&#39;);
ylabel(&#39;h(n)&#39;);xlabel(&#39;n&#39;);
axis([0,N,1.1*min(hn),1.1*max(hn)]);
subplot(1,2,2);stem(n,gn,&#39;k&#39;);
title(&#39;系统的单位阶跃响应&#39;);
ylabel(&#39;g(n)&#39;);xlabel(&#39;n&#39;);
axis([0,N,1.1*min(gn),1.1*max(gn)]);
</code></pre>
<p>程序运行结果如图2-2所示：</p>
<p>图2-2</p>
<h4 id="4、用MATLAB实现线性卷积"><a href="#4、用MATLAB实现线性卷积" class="headerlink" title="4、用MATLAB实现线性卷积"></a>4、用MATLAB实现线性卷积</h4><h5 id="1）用函数conv进行卷积运算："><a href="#1）用函数conv进行卷积运算：" class="headerlink" title="1）用函数conv进行卷积运算："></a>1）用函数conv进行卷积运算：</h5><p>求解两个序列的卷积和，关键在于如何确定卷积结果的时宽区间。MATLAB提供的求卷积函数conv默认两个序列的序号均从n&#x3D;0开始，卷积结果y对应的序列的序号也从n&#x3D;0开始。</p>
<h6 id="例2-3-已知两个序列f1-x3D-0-8n-（0≤n≤20），f2-x3D-u-n-（0≤n≤10），求两个序列的卷积和。"><a href="#例2-3-已知两个序列f1-x3D-0-8n-（0≤n≤20），f2-x3D-u-n-（0≤n≤10），求两个序列的卷积和。" class="headerlink" title="例2-3 已知两个序列f1&#x3D;0.8n  （0≤n≤20），f2&#x3D;u(n)  （0≤n≤10），求两个序列的卷积和。"></a>例2-3 已知两个序列f1&#x3D;0.8n  （0≤n≤20），f2&#x3D;u(n)  （0≤n≤10），求两个序列的卷积和。</h6><pre><code>n1=0:20;
f1=0.8.^n1;
subplot(2,2,1);stem(n1,f1,&#39;filled&#39;);
title(&#39;f1(n)&#39;);
n2=0:10;
N2=length(n2);
f2=ones(1,N2);
subplot(2,2,2);stem(n2,f2,&#39;filled&#39;);
title(&#39;f2(n)&#39;);
y=conv(f1,f2);
subplot(2,1,2);stem(y,&#39;filled&#39;);
</code></pre>
<p>程序运行结果如图2-3所示：</p>
<p>图2-3</p>
<h5 id="2）非零起始序列的卷积运算："><a href="#2）非零起始序列的卷积运算：" class="headerlink" title="2）非零起始序列的卷积运算："></a>2）非零起始序列的卷积运算：</h5><p>当两个序列不是从0开始时，必须对conv函数稍加扩展。<br>由卷积原理可知，若待卷积的两个序列序号分别为{x(n)；nx&#x3D;nxs:nxf}，{h(n)；nh&#x3D;nhs:nhf}，则卷积和y(n)的序号起点和终点分别为：nys&#x3D;nxs+nhs，nyf&#x3D;nxf+nhf。据此可定义通用卷积函数convu：<br>function[y,ny]&#x3D;convu(h,nh,x,nx)<br>nys&#x3D;nh(1)+nx(1);nyf&#x3D;nh(end)+nx(end);<br>y&#x3D;conv(h,x);ny&#x3D;nys:nyf;</p>
<h6 id="例2-4-已知序列f1-x3D-0-5n-0≤n≤10-，f2-x3D-u-n-2-2≤n≤10-，求两个序列的卷积和。"><a href="#例2-4-已知序列f1-x3D-0-5n-0≤n≤10-，f2-x3D-u-n-2-2≤n≤10-，求两个序列的卷积和。" class="headerlink" title="例2-4 已知序列f1&#x3D;0.5n  (0≤n≤10)，f2&#x3D;u(n+2)  (-2≤n≤10)，求两个序列的卷积和。"></a>例2-4 已知序列f1&#x3D;0.5n  (0≤n≤10)，f2&#x3D;u(n+2)  (-2≤n≤10)，求两个序列的卷积和。</h6><p>程序清单如下：</p>
<pre><code>n1=0:10;f1=0.5*n1;
n2=-2:10;nt=length(n2);
f2=ones(1,nt);
[y,ny]=convu(f1,n1,f2,n2);
subplot(2,2,1);stem(n1,f1);
subplot(2,2,2);stem(n2,f2);
subplot(2,1,2);stem(ny,y);
</code></pre>
<p>程序运行结果如图2-4所示：</p>
<p>图2-4</p>
<h5 id="3）卷积积分的动态过程演示："><a href="#3）卷积积分的动态过程演示：" class="headerlink" title="3）卷积积分的动态过程演示："></a>3）卷积积分的动态过程演示：</h5><p>为了更深入地理解序列卷积的原理，下面提供一段演示卷积和的动态过程的程序。</p>
<h6 id="例2-5-动态演示例2-3两个序列f1-x3D-0-8n-（0≤n≤20），f2-x3D-u-n-（0≤n≤10）的卷积和。"><a href="#例2-5-动态演示例2-3两个序列f1-x3D-0-8n-（0≤n≤20），f2-x3D-u-n-（0≤n≤10）的卷积和。" class="headerlink" title="例2-5  动态演示例2-3两个序列f1&#x3D;0.8n  （0≤n≤20），f2&#x3D;u(n)  （0≤n≤10）的卷积和。"></a>例2-5  动态演示例2-3两个序列f1&#x3D;0.8n  （0≤n≤20），f2&#x3D;u(n)  （0≤n≤10）的卷积和。</h6><p>程序清单如下：</p>
<pre><code>clf;
nf1=0:20;f1=0.8.^n1;
lf1=length(n1);nf2=0:10;
lf2=length(n2);f2=ones(1,lf2);
m=max(lf2,lf1);
if lf2&gt;lf1 nf2=0;nf1=lf2-lf1;
elseif lf2&lt;lf1 nf1=0;nf2=lf1-lf2;
else nf2=0;lf1=0;
end;
lt=m;
u=[zeros(1,lt),f2,zeros(1,nf2),zeros(1,lt)];
t1=(-lt+1:2*lt);
f1=[zeros(1,2*lt),f1,zeros(1,nf1)];
hf1=fliplr(f1);
N=length(hf1);
y=zeros(1,3*lt);
for k=0:2*lt
    p=[zeros(1,k),hf1(1:N-k)];
    y1=u.*p;
    yk=sum(y1);
    y(k+lt+1)=yk;
    subplot(4,1,1);stem(t1,u);
    subplot(4,1,2);stem(t1,p);
    subplot(4,1,3);stem(t1,y1);
    subplot(4,1,4);stem(k,yk);
    axis([-20,50,0,5]);hold on
    pause(2);
end
</code></pre>
<p>程序运行结果如图2-5所示：</p>
<p>图2-5</p>
<h4 id="5、离散LSI系统时域响应的求解。"><a href="#5、离散LSI系统时域响应的求解。" class="headerlink" title="5、离散LSI系统时域响应的求解。"></a>5、离散LSI系统时域响应的求解。</h4><p>MATLAB提供了多种方法求解离散LSI系统的响应：</p>
<h5 id="1）用conv函数进行卷积积分，求任意输入的系统零状态响应；"><a href="#1）用conv函数进行卷积积分，求任意输入的系统零状态响应；" class="headerlink" title="1）用conv函数进行卷积积分，求任意输入的系统零状态响应；"></a>1）用conv函数进行卷积积分，求任意输入的系统零状态响应；</h5><h6 id="例2-6-已知描述某因果系统的差分方程为6y-n-2y-n-2-x3D-x-n-3x-n-1-3x-n-2-x-n-3-，"><a href="#例2-6-已知描述某因果系统的差分方程为6y-n-2y-n-2-x3D-x-n-3x-n-1-3x-n-2-x-n-3-，" class="headerlink" title="例2-6 已知描述某因果系统的差分方程为6y(n)+2y(n-2)&#x3D;x(n)+3x(n-1)+3x(n-2)+x(n-3)，"></a>例2-6 已知描述某因果系统的差分方程为6y(n)+2y(n-2)&#x3D;x(n)+3x(n-1)+3x(n-2)+x(n-3)，</h6><p>满足初始条件y(-1)&#x3D;0，x(-1)&#x3D;0。在该系统的输入端加一个矩形脉冲序列，其占空比为0.25，一个周期取16个采样点，求该系统的响应。<br>程序清单如下：</p>
<pre><code>N=16;
n=0:N-1;
x=[ones(1,N/4),zeros(1,3*N/4)];
subplot(2,2,1);stem(n,x);
a=[1,0,1/3,0,];
b=[1/6,1/2,1/2,1/6];
hn=impz(b,a,n);
subplot(2,2,2);stem(n,hn);
y=conv(x,hn);
subplot(2,1,2);stem(y);
</code></pre>
<p>程序运行结果如图2-6所示：</p>
<p>图2-6</p>
<h5 id="2）用dlsim函数求任意输入的系统零状态响应；"><a href="#2）用dlsim函数求任意输入的系统零状态响应；" class="headerlink" title="2）用dlsim函数求任意输入的系统零状态响应；"></a>2）用dlsim函数求任意输入的系统零状态响应；</h5><h6 id="例2-7-已知某IIR数字低通滤波器的系统函数为"><a href="#例2-7-已知某IIR数字低通滤波器的系统函数为" class="headerlink" title="例2-7 已知某IIR数字低通滤波器的系统函数为"></a>例2-7 已知某IIR数字低通滤波器的系统函数为</h6><p>输入两个正弦叠加的序列 ，求该系统的响应。<br>程序清单如下：</p>
<pre><code>nx=0:8*pi;
x=sin(nx/2)+sin(10*nx)/3;
subplot(3,1,1);stem(nx,x);
a=[1,-0.34319,0.60439,-0.20407];
b=[0.1321,0.3963,0.3963,0.1321];
nh=0:9;h=impz(b,a,nh);
subplot(3,1,2);stem(nh,h);
y=dlsim(b,a,x);
subplot(3,1,3);stem(y);
</code></pre>
<p>程序运行结果如图2-7所示</p>
<p>图2-7</p>
<h5 id="3）用filtic和filter函数求任意输入的系统完全响应。"><a href="#3）用filtic和filter函数求任意输入的系统完全响应。" class="headerlink" title="3）用filtic和filter函数求任意输入的系统完全响应。"></a>3）用filtic和filter函数求任意输入的系统完全响应。</h5><h6 id="例2-8-已知描述某系统的差分方程为y-n-1-5y-n-1-0-5-y-n-2-x3D-x-n-n≥0，满足初始条件y-1-x3D-4，y-2-x3D-10，求系统输入为x-n-x3D-0-25-nu-n-时的零输入、零状态及全响应。"><a href="#例2-8-已知描述某系统的差分方程为y-n-1-5y-n-1-0-5-y-n-2-x3D-x-n-n≥0，满足初始条件y-1-x3D-4，y-2-x3D-10，求系统输入为x-n-x3D-0-25-nu-n-时的零输入、零状态及全响应。" class="headerlink" title="例2-8 已知描述某系统的差分方程为y(n)-1.5y(n-1)+0.5 y(n-2)&#x3D;x(n)  n≥0，满足初始条件y(-1)&#x3D;4，y(-2)&#x3D;10，求系统输入为x(n)&#x3D;(0.25)nu(n)时的零输入、零状态及全响应。"></a>例2-8 已知描述某系统的差分方程为y(n)-1.5y(n-1)+0.5 y(n-2)&#x3D;x(n)  n≥0，满足初始条件y(-1)&#x3D;4，y(-2)&#x3D;10，求系统输入为x(n)&#x3D;(0.25)nu(n)时的零输入、零状态及全响应。</h6><p>解  为了更深入地理解filtic和filter函数的用法，先用经典法求得系统完全响应表达式： ，并编写程序绘出其图形，以便与用MATLAB函数求解的结果进行对比。<br>程序清单如下：</p>
<pre><code>a=[1,-1.5,0.5];b=1;
N=20;n=0:N-1;x=0.25.^n;
x0=zeros(1,N);y01=[4,10];
xi=filtic(b,a,y01);y0=filter(b,a,x0,xi);
xi0=filtic(b,a,0);y1=filter(b,a,x,xi0);
y=filter(b,a,x,xi);y2=((1/3)*(1/4).^n+(1/2).^n+(2/3)).*ones(1,N);
subplot(2,3,1);stem(n,x);title(&#39;输入信号x(n)&#39;);
subplot(2,3,2);stem(n,y0);title(&#39;系统的零输入响应&#39;);
subplot(2,3,3);stem(n,y1);title(&#39;系统的零状态响应&#39;);
subplot(2,2,3);stem(n,y);title(&#39;用filter求得的完全响应&#39;);
subplot(2,2,4);stem(n,y2);title(&#39;经典法求得的完全响应&#39;);
</code></pre>
<p>程序运行结果如图2-8所示：</p>
<p>图2-8</p>
<h2 id="三、实验内容："><a href="#三、实验内容：" class="headerlink" title="三、实验内容："></a>三、实验内容：</h2><h3 id="1、输入并运行例题程序，理解每一条语句的含义。"><a href="#1、输入并运行例题程序，理解每一条语句的含义。" class="headerlink" title="1、输入并运行例题程序，理解每一条语句的含义。"></a>1、输入并运行例题程序，理解每一条语句的含义。</h3><h3 id="2、已知描述某离散LSI系统的差分方程为2y-n-3y-n-1-y-n-2-x3D-x-n-1-，分别用impz和dstep函数、filtic和filter函数两种方法求解系统的单位序列响应和单位阶跃响应。"><a href="#2、已知描述某离散LSI系统的差分方程为2y-n-3y-n-1-y-n-2-x3D-x-n-1-，分别用impz和dstep函数、filtic和filter函数两种方法求解系统的单位序列响应和单位阶跃响应。" class="headerlink" title="2、已知描述某离散LSI系统的差分方程为2y(n)-3y(n-1)+y(n-2)&#x3D;x(n-1)，分别用impz和dstep函数、filtic和filter函数两种方法求解系统的单位序列响应和单位阶跃响应。"></a>2、已知描述某离散LSI系统的差分方程为2y(n)-3y(n-1)+y(n-2)&#x3D;x(n-1)，分别用impz和dstep函数、filtic和filter函数两种方法求解系统的单位序列响应和单位阶跃响应。</h3><h3 id="3、编写程序描绘下列序列的卷积波形："><a href="#3、编写程序描绘下列序列的卷积波形：" class="headerlink" title="3、编写程序描绘下列序列的卷积波形："></a>3、编写程序描绘下列序列的卷积波形：</h3><p>（1）f1(n&#x3D;u(n),f2(n)&#x3D;u(n-2),  (0≤n≤10)<br>（2）x(n)&#x3D;sin(n&#x2F;2),h(n)&#x3D;(0.5)n   (-3≤n≤4П)</p>
<h3 id="4、已知某离散LSI系统的单位序列响应为h-n-x3D-3δ-n-3-0-5δ-n-4-0-2δ-n-5-0-7δ-n-6-0-8δ-n-7"><a href="#4、已知某离散LSI系统的单位序列响应为h-n-x3D-3δ-n-3-0-5δ-n-4-0-2δ-n-5-0-7δ-n-6-0-8δ-n-7" class="headerlink" title="4、已知某离散LSI系统的单位序列响应为h(n)&#x3D;3δ(n-3)+0.5δ(n-4)+0.2δ(n-5)+0.7δ(n-6)-0.8δ(n-7)"></a>4、已知某离散LSI系统的单位序列响应为h(n)&#x3D;3δ(n-3)+0.5δ(n-4)+0.2δ(n-5)+0.7δ(n-6)-0.8δ(n-7)</h3><p>求输入为x(n)&#x3D;e-0.5nu(n)时的系统响应。</p>
<h3 id="5、已知描述某离散LSI系统的差分方程为y-n-x3D-0-7y-n-1-2x-n-x-n-2-，求输入为x-n-x3D-u-n-3-时的系统响应。"><a href="#5、已知描述某离散LSI系统的差分方程为y-n-x3D-0-7y-n-1-2x-n-x-n-2-，求输入为x-n-x3D-u-n-3-时的系统响应。" class="headerlink" title="5、已知描述某离散LSI系统的差分方程为y(n)&#x3D;0.7y(n-1)+2x(n)-x(n-2)，求输入为x(n)&#x3D;u(n-3)时的系统响应。"></a>5、已知描述某离散LSI系统的差分方程为y(n)&#x3D;0.7y(n-1)+2x(n)-x(n-2)，求输入为x(n)&#x3D;u(n-3)时的系统响应。</h3><h6 id="例2-8-已知描述某系统的差分方程为y-n-1-5y-n-1-0-5-y-n-2-x3D-x-n-n≥0，满足初始条件y-1-x3D-4，y-2-x3D-10，求系统输入为x-n-x3D-0-25-nu-n-时的零输入、零状态及全响应。-1"><a href="#例2-8-已知描述某系统的差分方程为y-n-1-5y-n-1-0-5-y-n-2-x3D-x-n-n≥0，满足初始条件y-1-x3D-4，y-2-x3D-10，求系统输入为x-n-x3D-0-25-nu-n-时的零输入、零状态及全响应。-1" class="headerlink" title="例2-8 已知描述某系统的差分方程为y(n)-1.5y(n-1)+0.5 y(n-2)&#x3D;x(n)  n≥0，满足初始条件y(-1)&#x3D;4，y(-2)&#x3D;10，求系统输入为x(n)&#x3D;(0.25)nu(n)时的零输入、零状态及全响应。"></a>例2-8 已知描述某系统的差分方程为y(n)-1.5y(n-1)+0.5 y(n-2)&#x3D;x(n)  n≥0，满足初始条件y(-1)&#x3D;4，y(-2)&#x3D;10，求系统输入为x(n)&#x3D;(0.25)nu(n)时的零输入、零状态及全响应。</h6><p>解  为了更深入地理解filtic和filter函数的用法，先用经典法求得系统完全响应表达式： ，并编写程序绘出其图形，以便与用MATLAB函数求解的结果进行对比。<br>程序清单如下：</p>
<pre><code>a=[1,-0.7,0];b=[2,0,-1];
N=20;n=0:N-1; x=[(n-3)&gt;=0];
x0=zeros(1,N);y01=[4,10];
xi=filtic(b,a,y01);y0=filter(b,a,x0,xi);
xi0=filtic(b,a,0);y1=filter(b,a,x,xi0);
y=filter(b,a,x,xi);y2=((1/3)*(1/4).^n+(1/2).^n+(2/3)).*ones(1,N);
subplot(2,3,1);stem(n,x);title(&#39;输入信号x(n)&#39;);
subplot(2,3,2);stem(n,y0);title(&#39;系统的零输入响应&#39;);
subplot(2,3,3);stem(n,y1);title(&#39;系统的零状态响应&#39;);
subplot(2,2,3);stem(n,y);title(&#39;用filter求得的完全响应&#39;);
subplot(2,2,4);stem(n,y2);title(&#39;经典法求得的完全响应&#39;);
</code></pre>
<h2 id="四、实验预习："><a href="#四、实验预习：" class="headerlink" title="四、实验预习："></a>四、实验预习：</h2><p>1、认真阅读实验原理部分，明确实验目的，复习有关离散LSI系统的理论知识。<br>2、读懂实验原理部分的例题程序，熟悉与本实验有关的MATLAB函数。<br>3、根据实验内容预先编写实验程序，并思考本实验提出的有关MATLAB函数在调用时应注意哪些问题。</p>
<h2 id="五、实验报告：-1"><a href="#五、实验报告：-1" class="headerlink" title="五、实验报告："></a>五、实验报告：</h2><p>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、列出本实验提出的有关MATLAB函数在调用时应注意的问题。</p>
<h1 id="实验3-离散LSI系统的频域分析"><a href="#实验3-离散LSI系统的频域分析" class="headerlink" title="实验3  离散LSI系统的频域分析"></a>实验3  离散LSI系统的频域分析</h1><p>一、实验目的：<br>1、加深对离散系统变换域分析——z变换的理解，掌握使用MATLAB进行z变换和逆z变换的常用函数的用法。<br>2、了解离散系统的零极点与系统因果性和稳定性的关系，熟悉使用MATLAB进行离散系统的零极点分析的常用函数的用法。<br>3、加深对离散系统的频率响应特性基本概念的理解，掌握使用MATLAB进行离散系统幅频响应和相频响应特性分析的常用方法。<br>二、实验原理：<br>1、z变换和逆z变换<br>（1）用ztrans函数求无限长序列的z变换。该函数只给出z变换的表达式，而没有给出收敛域。另外，由于这一函数还不尽完善，有的序列的z变换还不能求出，逆z变换也存在同样的问题。<br>例3-1 求以下各序列的z变换<br>      x1(n)&#x3D;an   x2(n)&#x3D;n    x3(n)&#x3D;n(n-1)&#x2F;2   x4(n)&#x3D;ejωon   x5(n)&#x3D;1&#x2F;[n(n-1)]<br>程序清单如下：<br>syms w0 n z a;<br>x1&#x3D;a^n;X1&#x3D;ztrans(x1)<br>x2&#x3D;n;X2&#x3D;ztrans(x2)<br>x3&#x3D;(n*(n-1))&#x2F;2;X3&#x3D;ztrans(x3)<br>x4&#x3D;exp(j<em>w0</em>n);X4&#x3D;ztrans(x4)<br>x5&#x3D;1&#x2F;n*(n-1);X5&#x3D;ztrans(x5)<br>程序运行结果如下：<br>X1 &#x3D;z&#x2F;a&#x2F;(z&#x2F;a-1)<br>X2 &#x3D;z&#x2F;(z-1)^2<br>X3 &#x3D;1&#x2F;2<em>z</em>(z+1)&#x2F;(z-1)^3-1&#x2F;2<em>z&#x2F;(z-1)^2<br>X4 &#x3D;z&#x2F;exp(i</em>w0)&#x2F;(z&#x2F;exp(i*w0)-1)<br>X5 &#x3D;z&#x2F;(z-1)-ztrans(1&#x2F;n,n,z)<br>（2）用iztrans函数求无限长序列的逆z变换。<br>例3-2 求下列函数的逆z变换。</p>
<p>程序清单如下：<br>syms  n z a;<br>X1&#x3D;z&#x2F;(z-1);<br>x1&#x3D;iztrans(X1)<br>X2&#x3D;a<em>z&#x2F;(a-z)^2;<br>x2&#x3D;iztrans(X2)<br>X3&#x3D;z&#x2F;(z-1)^3;<br>x3&#x3D;iztrans(X3)<br>X4&#x3D;(1-z^-n)&#x2F;(1-z^-1);<br>x4&#x3D;iztrans(X4)<br>程序运行结果如下：<br>x1 &#x3D;1<br>x2 &#x3D;a^n</em>n<br>x3 &#x3D;1&#x2F;2<em>n^2-1&#x2F;2</em>n<br>x4 &#x3D;iztrans((1-z^(-n))&#x2F;(1-1&#x2F;z),z,n)<br>2、离散系统的零极点分析（系统极点位置对系统响应的影响）<br>例3-3 研究z右半平面的实数极点对系统的影响。<br>已知系统的零极点增益模型分别为：</p>
<p>求这些系统的零极点分布图以及系统的单位序列响应，判断系统的稳定性。<br>程序清单如下：<br>z1&#x3D;[0]’;p1&#x3D;[0.85]’;k&#x3D;1;<br>[b1,a1]&#x3D;zp2tf(z1,p1,k);<br>subplot(3,2,1);zplane(z1,p1);<br>title(‘极点在单位圆内’);<br>subplot(3,2,2);impz(b1,a1,20);<br>z2&#x3D;[0]’;p2&#x3D;[1]’;<br>[b2,a2]&#x3D;zp2tf(z2,p2,k);<br>subplot(3,2,3);zplane(z2,p2);<br>title(‘极点在单位圆上’);<br>subplot(3,2,4);impz(b2,a2,20);<br>z3&#x3D;[0]’;p3&#x3D;[1.5]’;<br>[b3,a3]&#x3D;zp2tf(z3,p3,k);<br>subplot(3,2,5);zplane(z3,p3);<br>title(‘极点在单位圆外’);<br>subplot(3,2,6);impz(b3,a3,20);<br>程序运行结果如图3-1所示。由图可见，这三个系统的极点均为实数且处于z平面的右半平面。由图可知，当极点位于单位圆内，系统的单位序列响应随着频率的增大而收敛；当极点位于单位圆上，系统的单位序列响应为等幅振荡；当极点位于单位圆外，系统的单位序列响应随着频率的增大而发散。由此可知系统1、2为稳定系统。</p>
<p>图3-1<br>例3-4 研究z左半平面的实数极点对系统的影响。<br>已知系统的零极点增益模型分别为：</p>
<p>求这些系统的零极点分布图以及系统的单位序列响应，判断系统的稳定性。<br>程序清单如下：<br>z1&#x3D;[0]’;p1&#x3D;[-0.85]’;k&#x3D;1;<br>[b1,a1]&#x3D;zp2tf(z1,p1,k);<br>subplot(3,2,1);zplane(z1,p1);<br>title(‘极点在单位圆内’);<br>subplot(3,2,2);impz(b1,a1,20);<br>z2&#x3D;[0]’;p2&#x3D;[-1]’;<br>[b2,a2]&#x3D;zp2tf(z2,p2,k);<br>subplot(3,2,3);zplane(z2,p2);<br>title(‘极点在单位圆上’);<br>subplot(3,2,4);impz(b2,a2,20);<br>z3&#x3D;[0]’;p3&#x3D;[-1.5]’;<br>[b3,a3]&#x3D;zp2tf(z3,p3,k);<br>subplot(3,2,5);zplane(z3,p3);<br>title(‘极点在单位圆外’);<br>subplot(3,2,6);impz(b3,a3,20);<br>程序运行结果如图3-2所示。由图可见，这三个系统的极点均为实数且处于z平面的左半平面。由图可知，当极点位于单位圆内，系统的单位序列响应随着频率的增大而收敛；当极点位于单位圆上，系统的单位序列响应为等幅振荡；当极点位于单位圆外，系统的单位序列响应随着频率的增大而发散。由此可知系统1、2为稳定系统。</p>
<p>图3-2<br>例3-5 研究z右半平面的复数极点对系统响应的影响<br>已知系统的零极点增益模型分别为：</p>
<p>求这些系统的零极点分布图以及系统的单位序列响应，判断系统的稳定性。<br>程序清单如下：<br>z1&#x3D;[0.3,0]’;p1&#x3D;[0.5+0.7j,0.5-0.7j]’;k&#x3D;1;<br>[b1,a1]&#x3D;zp2tf(z1,p1,k);<br>subplot(3,2,1);zplane(z1,p1);<br>title(‘极点在单位圆内’);<br>subplot(3,2,2);impz(b1,a1,20);<br>z2&#x3D;[0.3,0]’;p2&#x3D;[0.6+0.8j,0.6-0.8j]’;<br>[b2,a2]&#x3D;zp2tf(z2,p2,k);<br>subplot(3,2,3);zplane(z2,p2);<br>title(‘极点在单位圆上’);<br>subplot(3,2,4);impz(b2,a2,20);<br>z3&#x3D;[0.3,0]’;p3&#x3D;[1+j,1-j]’;<br>[b3,a3]&#x3D;zp2tf(z3,p3,k);<br>subplot(3,2,5);zplane(z3,p3);<br>title(‘极点在单位圆外’);<br>subplot(3,2,6);impz(b3,a3,20);<br>程序运行结果如图3-3所示。由图可见，这三个系统的极点均为复数且处于z平面的右半平面。由图可知，当极点位于单位圆内，系统的单位序列响应随着频率的增大而收敛；当极点位于单位圆上，系统的单位序列响应为等幅振荡；当极点位于单位圆外，系统的单位序列响应随着频率的增大而发散。由此可知系统1、2为稳定系统。</p>
<p>图3-3<br>由以上三例可得结论：系统只有在极点处于单位圆内才是稳定的。<br>例3-6 已知某离散时间系统的系统函数为</p>
<p>求该系统的零极点及零极点分布图，并判断系统的因果稳定性。<br>程序清单如下：<br>b&#x3D;[0.2,0.1,0.3,0.1,0.2];a&#x3D;[1,-1.1,1.5,-0.7,0.3];<br>rz&#x3D;roots(b)<br>rp&#x3D;roots(a)<br>subplot(2,1,1);zplane(b,a);title(‘系统的零极点分布图’);<br>subplot(2,1,2);impz(b,a,20);title(‘系统的单位序列响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>程序运行结果如下：<br>rz &#x3D;<br>  -0.5000 + 0.8660i    -0.5000 - 0.8660i<br>   0.2500 + 0.9682i    0.2500 - 0.9682i<br>rp &#x3D;<br>   0.2367 + 0.8915i    0.2367 - 0.8915i<br>   0.3133 + 0.5045i    0.3133 - 0.5045i</p>
<p>图3-4<br>由零极点分布图可见，该系统的所有极点均在单位圆内，因此该系统是一个因果稳定系统。<br>3、离散系统的频率响应<br>（1）离散系统的频率响应的基本概念<br>已知稳定系统传递函数的零极点增益模型为</p>
<p>则系统的频响函数为</p>
<p>其中，系统的幅频特性为</p>
<p>系统的相频特性为</p>
<p>由以上各式可见，系统函数与频率响应有着密切的联系。适当地控制系统函数的零极点分布，可以改变离散系统的频响特性：<br>① 在原点（z&#x3D;0）处的零点或极点至单位圆的距离始终保持不变，其值|ejω|&#x3D;1，所以，对幅度响应不起作用；<br>② 单位圆附近的零点对系统幅度响应的谷值位置及深度有明显影响；<br>③ 单位圆内且靠近单位圆附近的极点对系统幅度的峰值位置及大小有明显的影响。<br>（2）系统的频响特性分析<br>例3-7 已知某离散时间系统的系统函数为</p>
<p>求该系统在0～π频率范围内的相对幅频响应与相频响应。<br>程序清单如下：<br>b&#x3D;[0.1321,0,-0.3963,0,0.3963,0,-0.1321];<br>a&#x3D;[1,0,0.34319,0,0.60439,0,0.20407];<br>freqz(b,a);<br>程序运行结果如图3-5所示。该系统是一个IIR数字带通滤波器。其中幅频特性采用归一化的相对幅度值，以分贝（dB）为单位。</p>
<p>图3-5<br>例3-8 已知某离散时间系统的系统函数为</p>
<p>求该系统在0～π频率范围内的绝对幅频响应与相频响应。<br>程序清单如下：<br>b&#x3D;[0.2,0.1,0.3,0.1,0.2];a&#x3D;[1,-1.1,1.5,-0.7,0.3];<br>n&#x3D;(0:500)<em>pi&#x2F;500;<br>[h,w]&#x3D;freqz(b,a,n);<br>subplot(2,1,1);plot(n&#x2F;pi,abs(h));grid;<br>axis([0,1,1.1</em>min(abs(h)),1.1<em>max(abs(h))]);<br>xlabel(‘\omega&#x2F;\pi’);ylabel(‘幅度’);<br>subplot(2,1,2);plot(n&#x2F;pi,angle(h));grid;<br>axis([0,1,1.1</em>min(angle(h)),1.1*max(angle(h))]);<br>xlabel(‘\omega&#x2F;\pi’);ylabel(‘相位’);<br>程序运行结果如图3-6所示。该系统为一低通滤波器。</p>
<p>图3-6<br>例3-9 已知某离散时间系统的系统函数为</p>
<p>求该系统在0～π频率范围内的绝对幅频响应与相频响应、相对幅频响应与相频响应及零极点分布图。<br>程序清单如下：<br>b&#x3D;[0.1,-0.4,0.4,-0.1];<br>a&#x3D;[1,0.3,0.55,0.2];<br>n&#x3D;(0:500)<em>pi&#x2F;500;<br>[h,w]&#x3D;freqz(b,a,n);<br>db&#x3D;20</em>log10(abs(h));<br>subplot(2,2,1);plot(w&#x2F;pi,abs(h));grid;<br>axis([0,1,1.1<em>min(abs(h)),1.1</em>max(abs(h))]);<br>title(‘幅频特性（V）’);<br>xlabel(‘\omega&#x2F;\pi’);ylabel(‘幅度(V)’);<br>subplot(2,2,2);plot(w&#x2F;pi,angle(h));grid;<br>axis([0,1,1.1<em>min(angle(h)),1.1</em>max(angle(h))]);<br>xlabel(‘\omega&#x2F;\pi’);ylabel(‘相位’);<br>title(‘相频特性’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);grid<br>axis([0,1,-100,5]);<br>title(‘幅频特性（dB）’);<br>subplot(2,2,4);zplane(b,a);<br>title(‘零极点分布’);<br>程序运行结果如图3-7所示：</p>
<p>图3-7<br>（3）一个求解频率响应的实用函数。<br>在实际使用freqz进行离散系统频响特性分析时。通常需要求解幅频响应、相频响应、群时延，幅频响应又分为绝对幅频和相对幅频两种表示方法。下面定义函数freqz_m，利用该函数，可方便求出上述各项。freqz_m函数定义如下：<br>function[db,mag,pha,grd,w]&#x3D;freqz_m(b,a);<br>[H,w]&#x3D;freqz(b,a,1000,’whole’);<br>H&#x3D;(H(1:501))’;w&#x3D;(w(1:501))’;<br>mag&#x3D;abs(H);<br>db&#x3D;20*log10((mag+eps)&#x2F;max(mag));<br>pha&#x3D;angle(H);<br>grd&#x3D;grpdelay(b,a,w);<br>例3-10 已知某离散时间系统的系统函数为</p>
<p>求该系统在0～π频率范围内的绝对幅频响应与相频响应、相对幅频响应与相频响应及群时延。<br>程序清单如下：<br>b&#x3D;[0.1321,0,0.3963,0,0.3963,0,0.1321];<br>a&#x3D;[1,0,-0.34319,0,0.60439,0,-0.20407];<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,a);<br>subplot(2,2,1);plot(w&#x2F;pi,mag);grid<br>axis([0,1,1.1<em>min(mag),1.1</em>max(mag)]);<br>title(‘幅频特性（V）’);<br>xlabel(‘\omega&#x2F;\pi’);ylabel(‘幅度(V)’);<br>subplot(2,2,2);plot(w&#x2F;pi,pha);grid;<br>axis([0,1,1.1<em>min(pha),1.1</em>max(pha)]);<br>xlabel(‘\omega&#x2F;\pi’);ylabel(‘相位’);<br>title(‘相频特性’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);grid<br>axis([0,1,-100,5]);<br>title(‘幅频特性（dB）’);<br>subplot(2,2,4);plot(w&#x2F;pi,grd);grid<br>axis([0,1,0,10])title(‘群时延’);<br>程序运行结果如图3-8所示：</p>
<p>图3-8<br>三、实验内容：<br>1、输入并运行例题程序，理解每条语句的含义。<br>2、求下列各序列的z变换：</p>
<p>3、求下列函数的逆z变换</p>
<p>4、求下列系统函数所描述的离散系统的零极点分布图，并判断系统的稳定性<br>（1）<br>（2）<br>5、已知某离散时间系统的系统函数为</p>
<p>求该系统在0～π频率范围内的绝对幅频响应与相频响应、相对幅频响应与相频响应及群时延。<br>四、实验预习：<br>1、认真阅读实验原理部分，明确实验目的，复习有关离散LSI系统频率响应的理论知识。<br>2、读懂实验原理部分的例题程序，熟悉与本实验有关的MATLAB函数。<br>3、根据实验内容预先编写实验程序，并思考本实验提出的有关MATLAB函数在调用时应注意哪些问题。<br>4、预习思考题：<br>① 系统函数零极点的位置与系统单位序列响应有何关系？<br>② 离散系统的零极点对系统幅频响应有何影响？<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、列出本实验提出的有关MATLAB函数在调用时应注意的问题。<br>    3、给出预习思考题答案。</p>
<h1 id="实验4-DFS、DFT与FFT"><a href="#实验4-DFS、DFT与FFT" class="headerlink" title="实验4  DFS、DFT与FFT"></a>实验4  DFS、DFT与FFT</h1><p>一、实验目的：<br>1、加深对周期序列DFS、有限长序列DFT和FFT的基本概念及理论的理解。<br>2、掌握用MATLAB语言求解DFS、DFT、FFT以及相应反变换的方法。<br>3、观察周期序列的重复周期数对序列频谱特性的影响。<br>二、实验原理：<br>1、周期序列的离散傅里叶级数（DFS）<br>（1）DFS的基本概念：<br>离散时间序列x(n)满足x(n)&#x3D; x(n+rN)，称为离散周期序列，用 表示。其中，N为信号的周期，x(n)称为离散周期序列的主值。<br>周期序列 可以用离散傅里叶级数（DFS）表示：</p>
<p>其中， 是周期序列DFS第k次谐波分量的系数，也称为周期序列的频谱，可表示为</p>
<p>以上两式也是周期序列的一对傅里叶级数变换对。<br>令 ，以上DFS变换对又可以写成：</p>
<p>与连续周期信号的傅里叶级数相比，周期序列的离散傅里叶级数有以下特点：<br>① 连续周期信号的傅里叶级数由无穷多个与基波频率成整数倍的谐波分量叠加而成，而周期为N的周期序列的傅里叶级数仅有N个独立的谐波分量。<br>② 周期序列的频谱 也是一个以N为周期的周期序列。<br>（2）周期序列的DFS和IDFS<br>例4-1 已知一个周期性矩形脉冲宽度占整个周期的1&#x2F;4，一个周期的采样点数为16点，编程显示3个周期的序列波形，并：<br>① 用傅里叶级数求信号的幅度谱和相位谱。<br>② 求傅里叶级数逆变换的图形，并与原序列进行比较。<br>程序清单如下：<br>N&#x3D;16;<br>xn&#x3D;[ones(1,N&#x2F;4),zeros(1,3<em>N&#x2F;4)];<br>xn&#x3D;[xn,xn,xn];<br>n&#x3D;0:3</em>N-1;k&#x3D;0:3<em>N-1;<br>Xk&#x3D;xn</em>exp(-j<em>2</em>pi&#x2F;N).^(n’<em>k);<br>x&#x3D;(Xk</em>exp(j<em>2</em>pi&#x2F;N).^(n’<em>k))&#x2F;N;<br>subplot(2,2,1);stem(n,xn);<br>title(‘x(n)’);axis([-1,3</em>N,1.1<em>min(xn),1.1</em>max(xn)]);<br>subplot(2,2,2);stem(n,abs(x));<br>title(‘IDFS|X(k)|’);axis([-1,3<em>N,1.1</em>min(x),1.1<em>max(x)]);<br>subplot(2,2,3),stem(k,abs(Xk));<br>title(‘|X(k)|’);axis([-1,3</em>N,1.1<em>min(abs(Xk)),1.1</em>max(abs(Xk))]);<br>subplot(2,2,4),stem(k,angle(Xk));<br>title(‘arg|X(k)|’);axis([-1,3<em>N,1.1</em>min(angle(Xk)),1.1*max(angle(Xk))]);<br>程序运行结果如图4-1所示：</p>
<p>图4-1<br>由离散傅里叶级数逆变换图形可见，与原序列相比，幅度扩大了32倍。这是因为周期序列为原主值序列周期的3倍，做逆变换时未做处理。可将逆变换程序改为：<br>x&#x3D;(Xk<em>exp(j</em>2<em>pi&#x2F;N).^(n’<em>k))&#x2F;3</em>3</em>N;<br>由上例可见，周期序列的DFS和IDFS是依据变换公式编程的，无论信号序列如何变化，求解的公式总是一样的。因此，可将其编写成通用子程序：<br>① 离散傅里叶级数变换通用子程序dfs.m<br>function[Xk]&#x3D;dfs(xn,N)<br>n&#x3D;0:N-1;<br>k&#x3D;0:N-1;<br>WN&#x3D;exp(-j<em>2</em>pi&#x2F;N);<br>nk&#x3D;n’<em>k;<br>Xk&#x3D;xn</em>WN.^nk;<br>② 离散傅里叶级数逆变换通用子程序idfs.m<br>function[xn]&#x3D;idfs(Xk,N)<br>n&#x3D;0:N-1;<br>k&#x3D;0:N-1;<br>WN&#x3D;exp(j<em>2</em>pi&#x2F;N);<br>nk&#x3D;n’<em>k;<br>xn&#x3D;(Xk</em>WN.^nk)&#x2F;N;<br>例4-2 利用上述两个子程序，重做例4-1<br>程序清单如下：<br>N&#x3D;16;<br>xn&#x3D;[ones(1,N&#x2F;4),zeros(1,3<em>N&#x2F;4)];<br>n&#x3D;0:N-1;<br>k&#x3D;0:N-1;<br>Xk&#x3D;dfs(xn,N);<br>x&#x3D;idfs(Xk,N);<br>subplot(2,2,1);stem(n,xn);<br>title(‘x(n)’);axis([-1,3</em>N,1.1<em>min(xn),1.1</em>max(xn)]);<br>subplot(2,2,2);stem(n,abs(x));<br>title(‘IDFS|X(k)|’);axis([-1,3<em>N,1.1</em>min(x),1.1<em>max(x)]);<br>subplot(2,2,3),stem(k,abs(Xk));<br>title(‘|X(k)|’);axis([-1,3</em>N,1.1<em>min(abs(Xk)),1.1</em>max(abs(Xk))]);<br>subplot(2,2,4),stem(k,angle(Xk));<br>title(‘arg|X(k)|’);axis([-1,3<em>N,1.1</em>min(angle(Xk)),1.1*max(angle(Xk))]);<br>程序运行结果如图4-2所示。由于子程序仅适用于对主值区间进行变换，周期次数无法传递给子程序，因此程序执行结果仅显示一个周期的变换情况。</p>
<p>图4-2<br>（2）周期重复次数对序列频谱的影响<br>理论上讲，周期序列不满足绝对可积条件，因此不能用傅里叶级数来表示。实际处理时可先取K个周期进行处理，然后令K趋于无穷大，分析其极限情况。根据这一分析思路，可以观察序列由非周期到周期变化时，频谱由连续谱逐渐向离散谱过渡的过程。<br>例4-3 已知一矩形脉冲宽度占整个周期的1&#x2F;2，一个周期的采样点数为10点，用DFS求序列的重复周期数分别为1、4、7、10时的幅度谱。<br>程序清单如下：<br>xn&#x3D;[ones(1,5),zeros(1,5)];<br>Nx&#x3D;length(xn);<br>Nw&#x3D;1000;dw&#x3D;2<em>pi&#x2F;Nw;<br>k&#x3D;floor((-Nw&#x2F;2+0.5):(Nw&#x2F;2+0.5));<br>for r&#x3D;0:3<br>    K&#x3D;3</em>r+1;<br>    nx&#x3D;0:(K<em>Nx-1);<br>    x&#x3D;xn(mod(nx,Nx)+1);<br>    Xk&#x3D;x</em>(exp(-j<em>dw</em>nx’<em>k))&#x2F;K;<br>subplot(4,2,2</em>r+1);stem(nx,x);<br>axis([0,K<em>Nx-1,0,1.1]);ylabel(‘x(n)’);<br>subplot(4,2,2</em>r+2);plot(k<em>dw,abs(Xk));<br>axis([-4,4,0,1.1</em>max(abs(Xk))]);ylabel(‘X(k)’);<br>end<br>程序运行结果如图4-3所示。由图可见，序列的重复周期数越多，频谱越是向几个频点集中。当序列的周期数趋于无穷大时，频谱转化为离散谱。</p>
<p>图4-3<br>2、离散傅里叶变换（DFT）<br>（1）DFT与IDFT<br>在实际中常常使用有限长序列。如果有限长序列为x(n)，则该序列的离散傅里叶变换对可表示为</p>
<p>从离散傅里叶变换定义式可以看出，有限长序列在时域上是离散的，在频域上也是离散的，式中 ，即仅在单位圆上N个等间距的点上取值，这为使用计算机进行处理带来了方便。<br>由有限长序列的傅里叶变换和逆变换定义可知，DFT和DFS的变换公式非常相似，因此，在程序编写上也基本一致。<br>例4-4 已知x(n)&#x3D;[0,1,2,3,4,5,6,7]，求其DFT和IDFT。要求：<br>① 画出序列傅里叶变换对应的|X(k)|和arg[X(k)]图形。<br>② 画出x(n)图形，并与IDFT[X(k)]图形进行比较。<br>程序清单如下：<br>xn&#x3D;[0,1,2,3,4,5,6,7];<br>N&#x3D;length(xn);<br>n&#x3D;0:N-1;<br>k&#x3D;0:N-1;<br>Xk&#x3D;xn<em>exp(-j</em>2<em>pi&#x2F;N).^(n’<em>k);<br>x&#x3D;(Xk</em>exp(j</em>2<em>pi&#x2F;N).^(n’<em>k))&#x2F;N;<br>subplot(2,2,1);stem(n,xn);<br>title(‘x(n)’);axis([-1,N,1.1</em>min(xn),1.1</em>max(xn)]);<br>subplot(2,2,2);stem(n,abs(x));<br>title(‘IDFT|X(k)|’);axis([-1,N,1.1<em>min(x),1.1</em>max(x)]);<br>subplot(2,2,3),stem(k,abs(Xk));<br>title(‘|X(k)|’);axis([-1,N,1.1<em>min(abs(Xk)),1.1</em>max(abs(Xk))]);<br>subplot(2,2,4),stem(k,angle(Xk));<br>title(‘arg|X(k)|’);axis([-1,N,1.1<em>min(angle(Xk)),1.1</em>max(angle(Xk))]);<br>程序运行结果如图4-4所示。由图可见，与周期序列不同，有限长序列本身是仅有N点的离散序列，相当于周期序列的主值部分。因此，其频谱也对应序列的主值部分，是长度为N的离散序列。</p>
<p>图4-4<br>（2）DFT与DFS的联系<br>将周期序列的傅里叶级数变换对和有限长序列的离散傅里叶变换对进行比较可见，两者的区别仅仅是将周期序列 换成了有限长序列x(n)，同时，由于式中 的周期性，因而有限长序列的离散傅里叶变换实际上隐含着周期性。<br>例4-5 已知周期序列的主值x(n)&#x3D;[0,1,2,3,4,5,6,7]，求x(n)的周期重复次数为4次时的DFS。要求：<br>① 画出主值序列周期序列的波形。<br>② 画出周期序列傅里叶变换对应的 和arg[ ]的图形。<br>程序清单如下：<br>xn&#x3D;[0,1,2,3,4,5,6,7];<br>N&#x3D;length(xn);<br>m&#x3D;0:N-1;<br>n&#x3D;0:4<em>N-1;<br>k&#x3D;0:4</em>N-1;<br>xn1&#x3D;xn(mod(n,N)+1);<br>Xk&#x3D;xn1<em>exp(-j</em>2<em>pi&#x2F;N).^(n’<em>k);<br>subplot(2,2,1);stem(m,xn);<br>title(‘x(n)’);<br>subplot(2,2,2);stem(n,xn1);<br>title(‘周期序列’);<br>subplot(2,2,3),stem(k,abs(Xk));<br>title(‘|X(k)|’);axis([-1,4</em>N,1.1</em>min(abs(Xk)),1.1<em>max(abs(Xk))]);<br>subplot(2,2,4),stem(k,angle(Xk));<br>title(‘arg|X(k)|’);axis([-1,4</em>N,1.1<em>min(angle(Xk)),1.1</em>max(angle(Xk))]);<br>程序运行结果如图4-5所示。与例4-4相比，有限长序列x(n)可以看成是周期序列 的一个周期；反之，周期序列 可以看成是有限长序列以N为周期的周期延拓。频域上的情况也一样。从这个意义上说，周期序列只有有限个序列值有意义。<br>（3）DFT与DTFT的联系<br> 若离散时间非周期序列为x(n)，则它的离散傅里叶变换（DTFT）对定义为</p>
<p>其中 称为序列的频谱。可表示为 ， 称为序列的幅</p>
<p>图4-5<br>度谱， 称为序列的相位谱。<br>由DTFT的定义可见，序列在时域是离散的、非周期的，在频域是连续的、周期的。<br>与有限长序列相比， 仅在单位圆上取值，X(k)是在单位圆上N个等间距的点上取值。因此，连续谱 可由离散谱X(k)经插值后得到。<br>例4-6 求有限长序列x(n)&#x3D;[0,1,2,3,4,5,6,7]的DTFT，将（ ）区间分成500份。要求：<br>① 画出序列x(n)的图形。<br>② 画出由DTFT求出的幅度谱 和相位谱 的图形。<br>程序清单如下：<br>xn&#x3D;[0,1,2,3,4,5,6,7];<br>N&#x3D;length(xn);<br>n&#x3D;0:N-1;<br>w&#x3D;linspace(-2<em>pi,2</em>pi,500);<br>X&#x3D;xn<em>exp(-j</em>n’<em>w);<br>subplot(3,1,1);stem(n,xn);box on;<br>title(‘x(n)’);<br>subplot(3,1,2);plot(w,abs(X));<br>title(‘|X(e^j\omega)|’);axis([-2</em>pi,2<em>pi,1.1</em>min(abs(X)),1.1<em>max(abs(X))]);<br>subplot(3,1,3),plot(w,angle(X));<br>title(‘e^\phi(\omega)’);axis([-2</em>pi,2<em>pi,1.1</em>min(angle(X)),1.1*max(angle(X))]);<br>程序运行结果如图4-6所示：</p>
<p>图4-6<br>与图4-4相比，两者有一定差别。主要原因在于，该例进行DTFT时， 在单位圆上取250个点进行分割；而图4-4进行DFT时，X(k)是在单位圆上以N&#x3D;8的等间距取值，X(k)的序列长度与 相比不够长。若将x(n)&#x3D;[0,1,2,3,4,5,6,7]补零拓展至长度N&#x3D;100，再求其DFT，如图4-7所示。与例4-6相比，|X(k)|和arg[X(k)]图形接近 和 的图形。注意图4-7对应[0,2π]区间。</p>
<p>图4-7<br>程序清单如下：<br>N&#x3D;100;xn&#x3D;[0,1,2,3,4,5,6,7,zeros(1,N-8)];<br>n&#x3D;0:N-1;k&#x3D;0:N-1;<br>Xk&#x3D;xn<em>exp(-j</em>2<em>pi&#x2F;N).^(n’<em>k);<br>x&#x3D;(Xk</em>exp(j</em>2<em>pi&#x2F;N).^(n’<em>k))&#x2F;N;<br>subplot(2,2,1);stem(n,xn);title(‘x(n)’);axis([-1,N,1.1</em>min(xn),1.1</em>max(xn)]);<br>subplot(2,2,2);stem(n,abs(x));title(‘IDFT|X(k)|’);axis([-1,N,1.1<em>min(x),1.1</em>max(x)]);<br>subplot(2,2,3),stem(k,abs(Xk));<br>title(‘|X(k)|’);axis([-1,N,1.1<em>min(abs(Xk)),1.1</em>max(abs(Xk))]);<br>subplot(2,2,4),stem(k,angle(Xk));<br>title(‘arg|X(k)|’);axis([-1,N,1.1<em>min(angle(Xk)),1.1</em>max(angle(Xk))]);<br>3、FFT<br>（1）MATLAB提供的FFT函数<br> 由理论学习可知，DFT是唯一在时域和频域均离散的变换方法，它适用于有限长序列。尽管这种变换方法是可以用于数值计算的，但如果只是简单地按照定义进行数据处理，当序列长度很大时，将占用很大的内存空间，且运算时间很长。<br> 快速傅里叶变换是用于DFT运算的高效快速算法的统称，FFT只是其中的一种。FFT主要有时域抽取算法和频域抽取算法，基本思想是将一个长度为N的序列分解成多个段序列，如基2算法、基4算法等，大大地缩短了DFT的时间。有关详细理论可参考教材。<br>MATLAB提供了进行FFT的函数fft和ifft分别用于计算DFT和IDFT。<br>例4-7  已知一个长度为8的时域离散信号，n1&#x3D;0，n2&#x3D;7，在n0&#x3D;4前为0，n0以后为1.对其进行FFT变换，作时域信号及DFT、IDFT的图形。<br>程序清单如下：<br>n1&#x3D;0;n2&#x3D;7;n0&#x3D;4;n&#x3D;n1:n2;N&#x3D;length(n);<br>xn&#x3D;[(n-n0)&gt;&#x3D;0];subplot(2,2,1);stem(n,xn);title(‘x(n)’);<br>k&#x3D;0:N-1;Xk&#x3D;fft(xn,N);subplot(2,1,2);stem(k,abs(Xk));title(‘Xk&#x3D;DFT(xn)’);<br>xn1&#x3D;ifft(Xk,N);subplot(2,2,2);stem(n,xn1);title(‘x(n)&#x3D;IDFT(Xk)’);<br>程序运行结果如图4-8所示：</p>
<p>图4-9<br>（2）用FFT进行频谱分析<br>① 对有限长序列进行谱分析<br>一个序号从n1到n2的时域有限长序列x(n)，它的频谱 定义为它的离散傅里叶变换，且在Nyquist频率范围内有界并连续。序列的长度为N，则N&#x3D;n2-n1+1。计算x(n)的DFT得到的是 的N个样本点 。其中数字频率为</p>
<p>式中： 为数字频率的分辨率；k取对应-（N-1）&#x2F;2到（N-1）&#x2F;2区间的整数。<br>在实际使用中，往往要求计算出信号以模拟频率为横坐标的频谱，此时对应的模拟频率为</p>
<p>式中：D为模拟频率的分辨率或频率间隔；Ts为采样信号的周期，Ts&#x3D;1&#x2F;Fs；定义信号的长度L&#x3D;NTs。<br>在使用FFT进行DFT的高效运算时，一般不直接用n从n1到n2的x(n)，而是取 的主值区间（n&#x3D;0,1,…,N-1）的数据，经FFT将产生N个数据，定位在k&#x3D;0,1,…,N-1的数字频率点上，即对应[0,2 ]。如果要显示[- ， ]范围的频谱，则可以使用fftshift(X)进行位移。<br>例4-8 已知有限长序列x(n)&#x3D;[1，2，3，2，1]，其采样频率Fs&#x3D;10Hz。请使用FFT计算其频谱。<br>程序清单如下<br>Fs&#x3D;10;xn&#x3D;[1,2,3,2,1];N&#x3D;length(xn);D&#x3D;2<em>pi</em>Fs&#x2F;N;k&#x3D;floor(-(N-1)&#x2F;2:(N-1)&#x2F;2);<br>X&#x3D;fftshift(fft(xn,N));subplot(1,2,1);plot(k<em>D,abs(X),’o:’);title(‘幅度频谱’);xlabel(‘rad&#x2F;s’);<br>subplot(1,2,2);plot(k</em>D,angle(X),’o:’);title(‘相位频谱’);xlabel(‘rad&#x2F;s’);<br>程序运行结果如图4-10所示：</p>
<p>图4-10<br>由图4-10可知，当有限长序列的长度N&#x3D;5时，频谱的样本点数也为5，频率点之间的间距非常大，即分辨率很低。即使使用了plot命令的插值功能，显示出的曲线仍是断续的，与真实曲线有较大误差。改变分辨率的基本方法是给输入序列补零，即增加频谱的密度。这种方法只是改善了图形的视在分辨率，并不增加频谱的细节信息。<br>将上述有限长序列x(n)[1,2,3,2,1]末尾补零到N&#x3D;1000点，将程序改为：<br>Fs&#x3D;10;N&#x3D;1000;xn&#x3D;[1,2,3,2,1];<br>Nx&#x3D;length(xn);<br>xn&#x3D;[1,2,3,2,1,zeros(1,N-Nx-1)];<br>D&#x3D;2<em>pi</em>Fs&#x2F;N;<br>k&#x3D;floor(-(N-1)&#x2F;2:(N-1)&#x2F;2);<br>X&#x3D;fftshift(fft(xn,N));<br>subplot(1,2,1);plot(k<em>D,abs(X));<br>title(‘幅度频谱’);xlabel(‘rad&#x2F;s’);<br>subplot(1,2,2);plot(k</em>D,angle(X));<br>title(‘相位频谱’);xlabel(‘rad&#x2F;s’);<br>程序的运行结果如图4-11所示，由图可见，图形的分辨率提高，曲线几乎是连续的频谱了。</p>
<p>图4-11<br>例4-9 已知一个矩形窗函数序列为<br>                                x(n)&#x3D;</p>
<p>采样周期Ts&#x3D;0.5s，要求用FFT求其频谱。<br>由于该序列是一个实的偶序列，因而补零时需要仔细分析。假定按N&#x3D;32补零，则主值区域在n&#x3D;0~31，FFT的输入应为<br>xn&#x3D;[ones(1,6),zeros(1,N-11),ones(1,5)]<br>即原来n&#x3D;[-5:-1]的前五个点移到n&#x3D;[27:31]中去了。<br>下面考虑分别用N&#x3D;32、64、512，观察不同N值代入对频谱的影响。<br>程序清单如下：<br>Ts&#x3D;0.5;C&#x3D;[32,64,512];<br>for r&#x3D;0:2;<br>    N&#x3D;C(r+1);<br>    xn&#x3D;[ones(1,6),zeros(1,N-11),ones(1,5)];<br>    D&#x3D;2<em>pi&#x2F;(N</em>Ts);<br>    k&#x3D;floor(-(N-1)&#x2F;2:(N-1)&#x2F;2);<br>    X&#x3D;fftshift(fft(xn,N));<br>    subplot(3,2,2<em>r+1);plot(k</em>D,abs(X));<br>    subplot(3,2,2<em>r+2);stairs(k</em>D,angle(X));<br>end<br>程序运行结果如图4-12所示：</p>
<p>图4-12<br>如果将x(n)的输入写成<br>xn&#x3D;[ones(1,11),zeros(1,N-11)];<br>相当于起点不是取自n&#x3D;0而是n&#x3D;-5，计算的是x(n-5)的频谱。幅度频谱不受影响，相位频谱引入一个线性相位-5ω，如图4-13所示。</p>
<p>图4-13<br>② 对无限长序列进行谱分析<br>用FFT进行无限长序列的频谱分析，首先要将无限长序列截断成一个有限长序列。序列长度的取值对频谱有较大的影响，带来的问题是引起频谱的泄漏和波动。<br>例4-10 已知一个无限长序列为x(n)&#x3D;e-0.5n (n≥0), x(n)&#x3D;0(n＜0),采样频率Fs&#x3D;20Hz，要求用FFT求其频谱。<br>程序清单如下：<br>Fs&#x3D;20;C&#x3D;[8,16,128];<br>for r&#x3D;0:2;<br>    N&#x3D;C(r+1);<br>    n&#x3D;0:N-1;<br>    xn&#x3D;exp(-0.5<em>n);<br>    D&#x3D;2</em>pi<em>Fs&#x2F;N;<br>    k&#x3D;floor(-(N-1)&#x2F;2:(N-1)&#x2F;2);<br>    X&#x3D;fftshift(fft(xn,N));<br>    subplot(3,2,2</em>r+1);plot(k<em>D,abs(X));<br>    axis([-80,80,0,3]);<br>    subplot(3,2,2</em>r+2);stairs(k*D,angle(X));<br>    axis([-80,80,-1,1]);<br>end<br>程序运行结果如图4-14所示。由图可见，N值取得越大，即序列保留的越长，曲线精度越高。</p>
<p>图4-14<br>例4-11 用FFT计算下列连续时间信号的频谱，并观察选择不同的Ts和N值对频谱特性的影响。<br>xa(t)&#x3D;e-0.01t(sin2t+sin2.1t+sin2.2t)    t＞0<br>该题选择了三个非常接近的正弦信号，为了将各频率成分区分出来，在满足奈奎斯特定理的条件下确定采样周期，选择三组数据，分别是Ts&#x3D;0.5s，0.25s，0.125s；再确定N值，分别选择N&#x3D;256和N&#x3D;2048。观察不同Ts和N的组合对频谱分析的影响。<br>程序清单如下：<br>T0&#x3D;[0.5,0.25,0.125,0.125];<br>N0&#x3D;[256,256,256,2048];<br>for r&#x3D;1:4;<br>   Ts&#x3D;T0(r);N&#x3D;N0(r);<br>    n&#x3D;0:N-1;<br>    xn&#x3D;exp(-0.5<em>n);<br>    D&#x3D;2</em>pi&#x2F;(N<em>Ts);<br>    xa&#x3D;exp(-0.01</em>n<em>Ts).</em>(sin(2<em>n</em>Ts)+sin(2.1<em>n</em>Ts)+sin(2.2<em>n</em>Ts));<br>    k&#x3D;floor(-(N-1)&#x2F;2:(N-1)&#x2F;2);<br>    Xa&#x3D;Ts<em>fftshift(fft(xa,N));<br>    subplot(2,2,r);plot(k</em>D,abs(Xa));<br>    axis([1,3,1.1<em>min(abs(Xa)),1.1</em>max(abs(Xa))]);<br>end<br>程序运行结果如图4-15所示。</p>
<p>图4-15<br>由图4-15可以得出以下结论：<br>（1）N同样取256，当Ts越大时，时域信号的长度L&#x3D;NTs保留的越长，分辨率越高，频谱特性误差越小；反之，则分辨率越低，频谱特性误差越大，甚至丢失某些信号分量。<br>（2）Ts相同，当N越大时，在[0,2 ]范围内等间隔抽样点数越多，且时域信号的长度L&#x3D;NTs保留的越长，分辨率越高，频谱特性误差越小；在[0,2 ]范围内等间隔抽样点数越少，时域信号的长度L&#x3D;NTs保留的越短，分辨率越低，频谱特性误差越大，甚至可能漏掉某些重要的信号分量，称为栅栏效应。；<br>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据和图形，结合基本原理理解每一条语句的含义。<br>2、已知某周期序列的主值序列为x(n)&#x3D;[0,1,2,3,2,1,0]，编程显示2个周期的序列波形。要求：<br>① 用傅里叶级数求信号的幅度谱和相位谱，并画出图形<br>② 求傅里叶级数逆变换的图形，并与原序列进行比较。<br>3、已知有限长序列x(n)&#x3D;[1,0.5,0,0.5,1,1,0.5,0]，要求：<br>① 求该序列的DFT、IDFT的图形；<br>② 用FFT算法求该序列的DFT、IDFT的图形；<br>③ 假定采用频率Fs&#x3D;20Hz，序列长度N分别取8、32和64，用FFT计算其幅度谱和相位谱。<br>4、已知一个无限长序列x(n)&#x3D;0.5n（n≥0），采样周期Ts&#x3D;0.2s，要求序列长度分别取8、32和64，用FFT求其频谱。<br>四、实验预习：<br>1、认真阅读实验原理部分，明确实验目的，复习有关DFS、DFT、FFT的理论知识。<br>2、读懂实验原理部分的例题程序，熟悉与本实验有关的MATLAB函数。<br>3、根据实验内容预先编写实验程序，并思考本实验提出的有关MATLAB函数在调用时应注意哪些问题。<br>4、预习思考题：<br>① 离散傅里叶级数与连续性周期信号的傅里叶级数有何不同？周期序列的频谱有何特点？<br>② DFS、DFT、FFT有何联系？<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、列出本实验提出的有关MATLAB函数在调用时应注意的问题。<br>3、给出预习思考题答案。</p>
<h1 id="实验5-抽样定理"><a href="#实验5-抽样定理" class="headerlink" title="实验5  抽样定理"></a>实验5  抽样定理</h1><p>一、实验目的：<br>1、了解用MATLAB语言进行时域、频域抽样及信号重建的方法。<br>2、进一步加深对时域、频域抽样定理的基本原理的理解。<br>3、观察信号抽样与恢复的图形，掌握采样频率的确定方法和内插公式的编程方法。<br>二、实验原理：<br>1、时域抽样与信号的重建<br>（1）对连续信号进行采样<br>例5-1 已知一个连续时间信号 ，取最高有限带宽频率fm&#x3D;5f0，分别显示原连续时间信号波形和Fs&gt;2fm、Fs&#x3D;2fm、Fs&lt;2fm三情况下抽样信号的波形。<br>程序清单如下：<br>%分别取Fs&#x3D;fm，Fs&#x3D;2fm，Fs&#x3D;3fm来研究问题<br>dt&#x3D;0.1;<br>f0&#x3D;1;<br>T0&#x3D;1&#x2F;f0;<br>m&#x3D;5<em>f0;<br>Tm&#x3D;1&#x2F;fm;<br>t&#x3D;-2:dt:2;<br>f&#x3D;sin(2</em>pi<em>f0</em>t)+1&#x2F;3<em>sin(6</em>pi<em>f0</em>t);<br>subplot(4,1,1);<br>plot(t,f);<br>axis([min(t),max(t),1.1<em>min(f),1.1</em>max(f)]);<br>title(‘原连续信号和抽样信号’);<br>for i&#x3D;1:3;<br>    fs&#x3D;i<em>fm;Ts&#x3D;1&#x2F;fs;<br>    n&#x3D;-2:Ts:2;<br>    f&#x3D;sin(2</em>pi<em>f0</em>n)+1&#x2F;3<em>sin(6</em>pi<em>f0</em>n);<br>    subplot(4,1,i+1);stem(n,f,’filled’);<br>    axis([min(n),max(n),1.1<em>min(f),1.1</em>max(f)]);<br>end<br>程序运行结果如图5-1所示：</p>
<p>图5-1<br>（2）连续信号和抽样信号的频谱<br>由理论分析可知，信号的频谱图可以很直观地反映出抽样信号能否恢复原模拟信号。因此，我们对上述三种情况下的时域信号求幅度谱，来进一步分析和验证时域抽样定理。<br>例5-2 编程求解例5-1中连续信号及其三种抽样频率（Fs&gt;2fm、Fs&#x3D;2fm、Fs&lt;2fm）下的抽样信号的幅度谱。<br>程序清单如下：<br>dt&#x3D;0.1;f0&#x3D;1;T0&#x3D;1&#x2F;f0;fm&#x3D;5<em>f0;Tm&#x3D;1&#x2F;fm;<br>t&#x3D;-2:dt:2;N&#x3D;length(t);<br>f&#x3D;sin(2</em>pi<em>f0</em>t)+1&#x2F;3<em>sin(6</em>pi<em>f0</em>t);<br>wm&#x3D;2<em>pi</em>fm;k&#x3D;0:N-1;w1&#x3D;k<em>wm&#x2F;N;<br>F1&#x3D;f</em>exp(-j<em>t’<em>w1)<em>dt;subplot(4,1,1);plot(w1&#x2F;(2</em>pi),abs(F1));<br>axis([0,max(4</em>fm),1.1</em>min(abs(F1)),1.1<em>max(abs(F1))]);<br>for i&#x3D;1:3;<br>    if i&lt;&#x3D;2 c&#x3D;0;else c&#x3D;1;end<br>    fs&#x3D;(i+c)<em>fm;Ts&#x3D;1&#x2F;fs;<br>    n&#x3D;-2:Ts:2;N&#x3D;length(n);<br>    f&#x3D;sin(2</em>pi</em>f0<em>n)+1&#x2F;3</em>sin(6<em>pi</em>f0<em>n);<br>    wm&#x3D;2</em>pi<em>fs;k&#x3D;0:N-1;<br>    w&#x3D;k</em>wm&#x2F;N;F&#x3D;f<em>exp(-j</em>n’<em>w)<em>Ts;<br>    subplot(4,1,i+1);plot(w&#x2F;(2</em>pi),abs(F));<br>    axis([0,max(4</em>fm),1.1<em>min(abs(F)),1.1</em>max(abs(F))]);<br>end<br>程序运行结果如图5-2所示。<br>由图可见，当满足Fs≥2fm条件时，抽样信号的频谱没有混叠现象；当不满足Fs≥2fm条件时，抽样信号的频谱发生了混叠，即图5-2的第二行Fs＜2fm的频谱图，，在fm&#x3D;5f0的范围内，频谱出现了镜像对称的部分。</p>
<p>图5-2<br>（3）由内插公式重建信号<br>信号重建一般采用两种方法：一是用时域信号与理想滤波器系统的单位冲激响应进行卷积积分；二是用低通滤波器对信号进行滤波。本实验只讨论第一种方法。<br>由理论分析可知，理想低通滤波器的单位冲激响应为</p>
<p>抽样信号 通过滤波器输出，其结果应为 与h(t)的卷积积分：</p>
<p>该式称为内插公式。由式可见，xa(t)信号可以由其抽样值xa(nT)及内插函数重构。MATLAB中提供了sinc函数，可以很方便地使用内插公式。<br>例5-3 用上面推导出的内插公式重建例5-1给定的信号。<br>程序清单如下：<br>dt&#x3D;0.01;f0&#x3D;1;T0&#x3D;1&#x2F;f0;fm&#x3D;5<em>f0;Tm&#x3D;1&#x2F;fm;<br>t&#x3D;0:dt:3</em>T0;x&#x3D;sin(2<em>pi</em>f0<em>t)+1&#x2F;3</em>sin(6<em>pi</em>f0<em>t);<br>subplot(4,1,1);plot(t,x);axis([min(t),max(t),1.1</em>min(x),1.1<em>max(x)]);<br>title(‘用时域卷积重建抽样信号’);<br>for i&#x3D;1:3;<br>    fs&#x3D;i</em>fm;Ts&#x3D;1&#x2F;fs;<br>    n&#x3D;0:(3<em>T0)&#x2F;Ts;<br>    t1&#x3D;0:Ts:3</em>T0;<br>    x1&#x3D;sin(2<em>pi</em>f0<em>n&#x2F;fs)+1&#x2F;3</em>sin(6<em>pi</em>f0<em>n&#x2F;fs);<br>    T_N&#x3D;ones(length(n),1)<em>t1-n’<em>Ts</em>ones(1,length(t1));<br>    xa&#x3D;x1</em>sinc(fs</em>pi<em>T_N);<br>    subplot(4,1,i+1);plot(t1,xa);<br>    axis([min(t1),max(t1),1.1</em>min(xa),1.1*max(xa)]);<br>end<br>程序运行结果如图5-3所示：</p>
<p>图5-3<br>2、频域抽样与信号恢复<br>（1）频域抽样定理<br>从理论学习可知，在单位圆上对任意序列的Z变换等间隔采样N点得到：<br>  k&#x3D;0,1,…,N-1<br>该式实现了序列在频域的抽样。<br>那么由频域的抽样得到的频谱的序列能否不失真地恢复原时域信号呢？<br>由理论学习又知，频域抽样定理由下列公式表述：</p>
<p>表明对一个频谱采样后经IDFT生成的周期序列 是原非周期序列x(n)的周期延拓序列，其时域周期等于频域抽样点数N。<br>假定有限长序列x(n)的长度为M，频域抽样点数为N，原时域信号不失真地由频域抽样恢复的条件如下：<br>① 如果x(n)不是有限长序列，则必然造成混叠现象，产生误差；<br>② 如果x(n)是有限长序列，且频域抽样点数N小于序列长度M（即N&lt;M），则x(n)以N为周期进行延拓也将造成混叠，从 中不能无失真地恢复出原信号x(n)。<br>③ 如果x(n)是有限长序列，且频域抽样点数N大于或等于序列长度M（即N≥M），则从 中能无失真地恢复出原信号x(n)，即</p>
<p>（2）从频谱抽样恢复离散时间序列<br>例5-4 已知一个时间序列的频谱为</p>
<p>用IFFT计算并求出其时间序列x(n)，并绘图显示时间序列。<br>分析：该题使用了数字频率，没有给出采样周期，则默认Ts&#x3D;1S,另外，从 的解析式可以直接看出时域序列xn&#x3D;[3,2,1,2,3]。但为说明问题，仍编写程序求解如下：<br>程序清单如下：<br>Ts&#x3D;1;N0&#x3D;[3,5,10];<br>for r&#x3D;1:3;<br>    N&#x3D;N0(r);<br>    D&#x3D;2<em>pi&#x2F;(Ts</em>N);<br>    kn&#x3D;floor(-(N-1)&#x2F;2:-1&#x2F;2);<br>    kp&#x3D;floor(0:(N-1)&#x2F;2);<br>    w&#x3D;[kp,kn]<em>D;<br>    X&#x3D;3+2</em>exp(-j<em>w)+1</em>exp(-j<em>2</em>w)+2<em>exp(-j</em>3<em>w)+3</em>exp(-j<em>4</em>w);<br>    n&#x3D;0:N-1;<br>    x&#x3D;ifft(X,N)<br>    subplot(1,3,r);stem(n*Ts,abs(x));<br>    box<br>end<br>程序运行结果如图5-4所示：</p>
<p>图5-4<br>注意：程序中数字频率的排序进行了处理，这是因为 的排列顺序是从0开始，而不是从-(N-1)&#x2F;2开始。<br>程序运行后将显示数据：<br>x&#x3D;5.0000    5.0000    1.0000<br>x&#x3D;3.0000    2.0000    1.0000    2.0000    3.0000<br>x&#x3D;3.0000 - 0.0000i   2.0000 + 0.0000i   1.0000 - 0.0000i   2.0000 + 0.0000i   3.0000 - 0.0000   -0.0000 + 0.0000i   0 - 0.0000i   -0.0000 + 0.0000i   0.0000 - 0.0000i  -0.0000 + 0.0000i<br>由 的频谱表达式可知，有限长时间序列x(n)的长度M&#x3D;5，现分别取频域抽样点数为N&#x3D;3,5,10，由图5-4显示的结果可以验证：<br>① 当N&#x3D;5和N&#x3D;10时，N≥M，能够不失真地恢复出原信号x(n)；<br>② 当N&#x3D;3时，N＜M，时间序列有泄漏，形成了混叠，不能无失真地恢复出原信号x(n)。混叠的原因是上一周期的后2点与本周期的前两点发生重叠，如下所示：</p>
<p>3   2   1   2   3<br>3   2   1   2   3</p>
<p>例5-5 已知一个频率范围在[-62.8,62.8]rad&#x2F;s间的频谱 ，用IFFT计算并求出时间序列x(n)，用图形显示时间序列。<br>   分析：本题给出了模拟频率Ω，其中Ωm&#x3D;62.8，需将其归一化为数字频率。根据奈奎斯特定理可知，（1&#x2F;Ts）&#x3D;Fs≥(2Ωm&#x2F;2π),可以推导出Ts≤（π&#x2F;Ωm）,取Ts&#x3D;0.05s，即采样频率Fs为20Hz或40π。<br>程序清单如下：<br>wm&#x3D;62.8;Ts&#x3D;pi&#x2F;wm;<br>N0&#x3D;[8,20];<br>for r&#x3D;1:2<br>    N&#x3D;N0(r);<br>    D&#x3D;2<em>pi&#x2F;(Ts</em>N);<br>    k&#x3D;[0:N-1]+eps;<br>    omg&#x3D;k<em>D;<br>    X&#x3D;sin(0.275</em>omg).&#x2F;sin(0.025<em>omg);<br>    n&#x3D;0:N-1;<br>    x&#x3D;abs(ifft(X,N));<br>    subplot(1,2,r);stem(n</em>Ts,abs(x));<br>    box<br>end<br>   程序运行结果如图5-5所示：</p>
<p>图5-5<br>   由N&#x3D;20的结果可知，时间序列x(n)是一个矩形窗。根据DFT的循环移位性质可知，非零数据存在于n&#x3D;-5:5的区域，有限长序列的长度为11。而N&#x3D;8小于有限长序列的长度，其结果发生了混叠，不能无失真地恢复出原信号x(n)。<br>   3、从频谱恢复连续时间信号<br>   实际应用中，离散信号往往来源于对连续信号的采样，因此，这里要讨论从频谱如何计算连续时间信号。<br>   从本质上讲，计算机处理的都是离散信号。当使用计算机处理连续信号时，实际上是用采样周期极小的序列信号来近似为连续信号。因此在处理时，原来对于离散序列处理的理论依然有效。<br>   （1）选择一个符合奈奎斯特定理的很小的采样周期T，将主要的模拟频谱限制在奈奎斯特频率范围内， ；<br>（2）在[ ]的频率区间取N个频率点Ωk，求出对应的数字频谱：</p>
<p>   （3）对 作IDFT，求xa(t)。假定没有发生时间混叠，则</p>
<p>   （4）作图。用plot自动进行插值，获得连续信号。<br>   例5-6 已知图5-6所示的理想低通滤波器的模拟频率Ωc&#x3D;3，在|Ω|≤Ωc范围内幅度为1，|Ω|＞Ωc时幅度为0。要求计算连续脉冲响应xa(t)。</p>
<p>图5-6<br>   分析：由奈奎斯特定理可知采样频率Ωs≥2Ωc,即采样周期Ts≤πΩc恢复原信号时不会发生混叠。选的再小一些可以增加样点数，因此可以选Ts&#x3D;0.1π&#x2F;Ωc&#x3D;0.1047s。同时，为使时间信号尽量接近连续信号，需提高N点的个数。可以由模拟频率的分辨率公式推导：<br>D&#x3D;2π&#x2F;NTs≤0.1Ωc，使频率分辨率小于有效带宽的1&#x2F;10，得到：N≥20π&#x2F;ΩcTs<br>   程序清单如下：<br>wc&#x3D;3;Tmax&#x3D;0.1<em>pi&#x2F;wc;<br>Ts&#x3D;input(‘(Ts&lt;Tmax)Ts&#x3D;’);<br>Nmin&#x3D;20*pi&#x2F;wc&#x2F;Ts;<br>N&#x3D;input(‘(N&gt;Nmin)N&#x3D;’);<br>D&#x3D;2</em>pi&#x2F;(Ts<em>N);<br>M&#x3D;floor(wc&#x2F;D);<br>Xa&#x3D;[ones(1,M+1),zeros(1,N-2</em>M-1),ones(1,M)];<br>n&#x3D;-(N-1)&#x2F;2:(N-1)&#x2F;2;<br>xa&#x3D;abs(fftshift(ifft(Xa&#x2F;Ts)));<br>plot(n*Ts,xa);<br>程序执行过程中，在MATLAB命令窗口将给出提示：输入Ts和N的值，再给出绘图结果。图5-7是分别输入Ts&#x3D;0.1s，N&#x3D;300和Ts&#x3D;0.1s，N&#x3D;1000两组数据的运行结果。</p>
<p>图5-7<br>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据和图形，结合基本原理理解每一条语句的含义。<br>2、已知一个连续时间信号f(t)&#x3D;sinc(t)，取最高有限带宽频率fm&#x3D;1Hz。<br>（1）分别显示原连续信号波形和Fs&#x3D;fm、Fs&#x3D;2fm、Fs&#x3D;3fm三种情况下抽样信号的波形；<br>（2）求解原连续信号和抽样信号的幅度谱；<br>（3）用时域卷积的方法（内插公式）重建信号。<br>3、已知一个时间序列的频谱为：<br>分别取频域抽样点数N为3、5和10，用IFFT计算并求出其时间序列x(n)，绘图显示个时间序列。由此讨论由频域抽样不失真地恢复原时域信号的条件。<br>    4、已知一个频率范围在[-6.28,6.28]rad&#x2F;s的频谱，在模拟频率|Ωc|&#x3D;3.14处幅度为1，其它范围幅度为0.计算其连续信号xa(t)，并绘图显示信号曲线。<br>四、实验预习：<br>1、认真阅读实验原理部分，明确实验目的，读懂例题程序，了解实验方法。<br>2、根据实验任务预先编写实验程序。<br>3、预习思考题：<br>① 什么是内插公式？在MATLAB中内插公式可用什么函数来编写？<br>② 从频域抽样序列不失真地恢复离散时域信号的条件是什么？<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、给出预习思考题答案。<br>    3、思考题：<br>① 试归纳用IFFT数值计算方法从频谱恢复离散时间序列的方法和步骤。<br>② 从频谱恢复连续时间信号与恢复离散时间序列有何不同？</p>
<h1 id="实验6-数字滤波器的网络结构"><a href="#实验6-数字滤波器的网络结构" class="headerlink" title="实验6  数字滤波器的网络结构"></a>实验6  数字滤波器的网络结构</h1><p>一、实验目的：<br>1、加深对数字滤波器分类与结构的了解。<br>2、明确数字滤波器的基本结构及其相互间的转换方法。<br>3、掌握用MATLAB语言进行数字滤波器结构间相互转换的子函数及程序编写方法。<br>二、实验原理：<br>1、数字滤波器的分类<br>离散LSI系统对信号的响应过程实际上就是对信号进行滤波的过程。因此，离散LSI系统又称为数字滤波器。<br>数字滤波器从滤波功能上可以分为低通、高通、带通、带阻以及全通滤波器；根据单位脉冲响应的特性，又可以分为有限长单位脉冲响应滤波器（FIR）和无限长单位脉冲响应滤波器（IIR）。<br>一个离散LSI系统可以用系统函数来表示：</p>
<p>也可以用差分方程来表示：</p>
<p>以上两个公式中，当ak至少有一个不为0时，则在有限Z平面上存在极点，表达的是以一个IIR数字滤波器；当ak全都为0时，系统不存在极点，表达的是一个FIR数字滤波器。FIR数字滤波器可以看成是IIR数字滤波器的ak全都为0时的一个特例。<br>IIR数字滤波器的基本结构分为直接Ⅰ型、直接Ⅱ型、直接Ⅲ型、级联型和并联型。<br>FIR数字滤波器的基本结构分为横截型（又称直接型或卷积型）、级联型、线性相位型及频率采样型等。本实验对线性相位型及频率采样型不做讨论，见实验10、12。<br>另外，滤波器的一种新型结构——格型结构也逐步投入应用，有全零点FIR系统格型结构、全极点IIR系统格型结构以及全零极点IIR系统格型结构。<br>2、IIR数字滤波器的基本结构与实现<br>（1）直接型与级联型、并联型的转换<br>例6-1 已知一个系统的传递函数为</p>
<p>将其从直接型（其信号流图如图6-1所示）转换为级联型和并联型。</p>
<p>图6-1<br>分析：从直接型转换为级联型，就是将系统的传递函数（tf）模型转换为二次分式（sos）模型；从直接型转换为并联型，就是将系统函数的传递函数（tf）模型转换为极点留数（rpk）模型。<br>程序清单如下：<br>b&#x3D;[8,-4,11,-2];<br>a&#x3D;[1,-1.25,0.75,-0.125];<br>[sos,g]&#x3D;tf2sos(b,a)<br>[r,p,k]&#x3D;residuez(b,a)<br>运行结果如下：<br>sos &#x3D;<br>    1.0000   -0.1900         0    1.0000   -0.2500         0<br>    1.0000   -0.3100    1.3161    1.0000   -1.0000    0.5000<br>g &#x3D; 8<br>r &#x3D;<br>  -8.0000 -12.0000i<br>  -8.0000 +12.0000i<br>   8.0000<br>p &#x3D;<br>   0.5000 + 0.5000i<br>   0.5000 - 0.5000i<br>   0.2500<br>k &#x3D;16<br>由sos和g的数据，可以列写出级联型的表达式：</p>
<p>信号流图如图6-2所示：<br> 图6-2<br>由r、p、k的数据，可以列写出并联型的表达式：</p>
<p>上式中出现了复系数，可采用二阶分割将共轭极点组成分母上的实系数二阶环节。这里使用自定义函数dir2par可以实现滤波器结构从直接型向并联型的转换，且用实系数二阶环节表示。在使用该函数时，调用了另一个自定义函数cplxcomp以进行复共轭对的正确排序，保证系统二阶环节的分子、分母一定是实数。dir2par函数和cplxcomp函数定义如下：<br>function I&#x3D;cplxcomp(p1,p2) %按共轭条件排列极点留数对<br>                       %比较两个包含同样标量元素但（可能）具有不同下标的复数对<br>                %本语句必须用在p2&#x3D;cplxpair(p1)语句之后，以重新排序对应的留数向量<br>I&#x3D;[];<br>for j&#x3D;1:length(p2)<br>    for i&#x3D;1:length(p1)<br>        if(abs(p1(i)-p2(j))&lt;0.0001)<br>            I&#x3D;[I,i];<br>        end<br>    end<br>end<br>I&#x3D;I’;</p>
<p>function [C,B,A]&#x3D;dir2par(num,den) %直接型到并联型的转换<br>M&#x3D;length(num);N&#x3D;length(den);<br>[r1,p1,C]&#x3D;residuez(num,den);%先求系统的单根p1对应的留数r1及直接项C<br>p&#x3D;cplxpair(p1,10000000<em>eps);<br>I&#x3D;cplxcomp(p1,p);<br>r&#x3D;r1(I);<br>K&#x3D;floor(N&#x2F;2);B&#x3D;zeros(K,2);A&#x3D;zeros(K,3);<br>if K</em>2&#x3D;&#x3D;N;<br>    for i&#x3D;1:2:N-2;<br>        Brow&#x3D;r(i:1:i+1,:);<br>        Arow&#x3D;p(i:1:i+1,:);<br>        [Brow,Arow]&#x3D;residuez(Brow,Arow,[]);<br>        B(fix((i+1)&#x2F;2),:)&#x3D;real(Brow);<br>        A(fix((i+1)&#x2F;2),:)&#x3D;real(Arow);<br>    end<br>    [Brow,Arow]&#x3D;residuez(r(N-1),p(N-1),[]);<br>    B(K,:)&#x3D;[real(Brow),0];A(K,:)&#x3D;[real(Arow),0];<br>else<br>    for i&#x3D;1:2:N-1;<br>        Brow&#x3D;r(i:1:i+1,:);<br>        Arow&#x3D;p(i:1:i+1,:);<br>        [Brow,Arow]&#x3D;residuez(Brow,Arow,[]);<br>        B(fix((i+1)&#x2F;2),:)&#x3D;real(Brow);<br>        A(fix((i+1)&#x2F;2),:)&#x3D;real(Arow);<br>    end<br>end<br>将例6-1从直接型转换为并联型的程序改写如下：<br>b&#x3D;[8,-4,11,-2];<br>a&#x3D;[1,-1.25,0.75,-0.125];<br>[C,B,A]&#x3D;dir2par(b,a)<br>运行结果如下：<br>C &#x3D;16<br>B &#x3D;<br>  -16.0000   20.0000<br>    8.0000         0<br>A &#x3D;<br>    1.0000   -1.0000    0.5000<br>1.0000   -0.2500         0<br>由A,B,C的数据可以直接写出并联型的表达式：</p>
<p>信号流图如图6-3所示：<br> 图6-3<br>例6-2 已知一个系统的级联型系数公式为</p>
<p>将其从级联型（信号流图如图6-4所示）转换为直接型和并联型结构。<br> 图6-4<br>分析：从级联型转换为直接型，就是将二次分式（sos）模型转换为系统传递函数（tf）模型；再使用dirpar.m和cplxcomp.m函数将直接型转换为并联型。<br>程序清单如下：<br>sos&#x3D;[1  0.9  0  1  -0.25  0<br>     1  -3  2  1    1    0.5];<br> g&#x3D;0.5;<br> [b,a]&#x3D;sos2tf(sos,g)<br> [C,B,A]&#x3D;dir2par(b,a)<br>程序运行结果如下：<br>b &#x3D; 0.5000   -1.0500   -0.3500    0.9000<br>a &#x3D;1.0000    0.7500    0.2500   -0.1250<br>C &#x3D;-7.2000<br>B &#x3D;    3.9846    1.6308<br>    3.7154         0<br>A &#x3D;    1.0000    1.0000    0.5000<br>    1.0000   -0.2500         0<br>由b,a的数据可以直接写出直接型的表达式：</p>
<p>信号流图如图6-5所示：</p>
<p>图6-5<br>由A,B,C的数据可以写出并联型的表达式：</p>
<p>信号流图如图6-6所示：<br> 图6-6<br>（2）直接型转换为全零极点IIR系统的格型结构<br>例6-3 将例6-1给定的系统传递函数</p>
<p>从直接型转换为格型。<br>程序清单如下：<br>b&#x3D;[8,-4,11,-2];<br>a&#x3D;[1,-1.25,0.75,-0.125];<br>[K,C]&#x3D;tf2latc(b,a)<br>[b,a]&#x3D;latc2tf(K,C)<br>程序运行结果如下：<br>K &#x3D;<br>   -0.7327<br>    0.6032<br>   -0.1250<br>C &#x3D;<br>    8.1064<br>    7.4841<br>    8.5000<br>   -2.0000<br>b &#x3D;8.0000   -4.0000   11.0000   -2.0000<br>a &#x3D;1.0000   -1.2500    0.7500   -0.1250<br>由K、C参数可以画出格型结构图，如同图6-7所示：<br> 图6-7<br>（3）直接型转换为全极点IIR系统的格型结构<br>例6-4 将一个全极点IIR系统的传递函数</p>
<p>从直接型转换为格型结构。<br>程序清单如下：<br>b&#x3D;[1];a&#x3D;[1,-1.25,0.75,-0.125];<br>K&#x3D;tf2latc(b,a)<br>[b,a]&#x3D;latc2tf(K)<br>程序运行结果如下：<br>K &#x3D; -0.7327<br>    0.6032<br>   -0.1250<br>b &#x3D;    1.0000   -1.2500    0.7500   -0.1250<br>a &#x3D;     1<br>格型结构信号流图如图6-8所示：<br> 图6-8<br>3、FIR数字滤波器的基本结构与实现<br>（1）横截型与级联型之间的转换<br>例6-5 已知一个FIR系统的传递函数为</p>
<p>将其从横截型（信号流图如图6-9所示）转换为级联型。</p>
<p>图6-9<br>分析：从横截型转换为级联型就是将系统传递函数（tf）模型转换为二次分式（sos）模型。程序清单如下：<br>b&#x3D;[2,0.9,1.55,2.375];<br>a&#x3D;[1];<br>[sos,g]&#x3D;tf2sos(b,a)<br>[b,a]&#x3D;sos2tf(sos,g)<br>程序运行结果如下：<br>sos &#x3D;<br>    1.0000    0.9500         0    1.0000         0         0<br>    1.0000   -0.5000    1.2500    1.0000         0         0<br>g &#x3D;     2<br>b &#x3D;    2.0000    0.9000    1.5500    2.3750<br>a &#x3D;     1     0     0     0<br>由sos和g的数据可以写出级联型的表达式：</p>
<p>信号流图如图6-10所示：</p>
<p>图6-10<br>（2）横截型转换为全零点FIR系统的格型结构<br>例6-6 已知一个FIR系统的传递函数为</p>
<p>将其从横截型转换为全零点FIR系统的格型结构<br>程序清单如下：<br>b&#x3D;[1,2.7917,2,1.375,0.3333];<br>a&#x3D;[1];<br>K&#x3D;tf2latc(b,a)<br>[b,a]&#x3D;latc2tf(K)<br>程序运行结果如下：<br>K &#x3D;<br>    2.0004<br>    0.2498<br>    0.5001<br>    0.3333<br>b &#x3D;    1.0000    2.7917    2.0000    1.3750    0.3333<br>a &#x3D;     1<br>由K参数画出的格型结构图如图6-11所示：<br> 图6-11<br>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据，结合基本原理理解每一条语句的含义。<br>2、已知一个IIR系统的传递函数为</p>
<p>将其从直接型转换为级联型、并联型和格型结构，并画出各种结构的信号流图。<br>3、已知一个FIR系统的传递函数为</p>
<p>将其从横截型转换为级联型和格型结构，并画出各种结构的信号流图。<br>四、实验预习：<br>1、认真阅读实验原理部分，明确实验目的，读懂例题程序，了解实验方法。<br>2、根据实验内容预先编写实验程序。<br>3、预习思考题：<br>①  什么是数字滤波器？数字滤波器是如何分类的？<br>②  归纳各类数字滤波器的基本结构。<br>五、实验报告：<br>1、列写调试通过的实验程序，并给出程序运行结果。<br>2、给出预习思考题答案。</p>
<h1 id="实验7-用MATLAB设计IIR数字滤波器（一）"><a href="#实验7-用MATLAB设计IIR数字滤波器（一）" class="headerlink" title="实验7  用MATLAB设计IIR数字滤波器（一）"></a>实验7  用MATLAB设计IIR数字滤波器（一）</h1><p>一、实验目的：<br>1、加深对IIR数字滤波器的基本设计方法的理解。<br>2、掌握用模拟滤波器原型设计IIR数字滤波器的方法。<br>3、了解MATLAB有关IIR数字滤波器设计的子函数的调用方法。<br>二、实验原理：<br>1、脉冲响应不变法的基本知识<br>脉冲响应不变法又称冲激响应不变法，是将系统从s平面映射到z平面的一种变换方法，使数字滤波器的单位脉冲响应h(n)模仿模拟滤波器的冲激响应ha(n)。其变换关系式为z&#x3D;esT<br>由于esT是一个周期函数，因而s平面虚轴上每一段2π&#x2F;T的线段都映射到z平面单位圆上一周。由于重叠映射，因而冲激响应不变法是一种多值映射关系。数字滤波器的频率响应是原模拟滤波器的频率响应的周期延拓（如图7-1）所示。只有当模拟滤波器的频率响应是有限带宽，且频带宽度|Ω|≤(π&#x2F;T)&#x3D;ΩS&#x2F;2，才能避免数字滤波器的频率响应发生混叠现象。因此，脉冲响应不变法只适用于限带的模拟滤波器，对于高频区幅频特性不等于零的高通和带阻滤波器不适用。</p>
<p>图7-1<br>用脉冲响应不变法设计IIR数字滤波器的步骤如下：<br>① 输入给定的数字滤波器的设计指标；<br>② 根据公式Ω&#x3D;ω&#x2F;T将数字滤波器设计指标转换为模拟滤波器设计指标；<br>③ 确定模拟滤波器的最小阶数和截止频率；<br>④ 计算模拟低通原型滤波器的系统传递函数；<br>⑤ 利用模拟域频率变换法求解实际模拟滤波器的系统传递函数；<br>⑥ 用脉冲响应不变法将模拟滤波器转换为数字滤波器。<br>2、用脉冲响应不变法设计IIR数字低通滤波器<br>例7-1 采用脉冲响应不变法设计一个巴特沃斯数字低通滤波器，要求：ωp&#x3D;0.25π，Rp&#x3D;1dB；ωs&#x3D;0.4П，As&#x3D;15dB，滤波器采样频率Fs&#x3D;2000Hz。<br>程序清单如下：<br>wp&#x3D;0.25<em>pi;    %滤波器的通带截止频率<br>ws&#x3D;0.4</em>pi;     %滤波器的阻带截止频率<br>Rp&#x3D;1;As&#x3D;15;    %滤波器的通阻带衰减指标<br>ripple&#x3D;10^(-Rp&#x2F;20); %滤波器的通带衰减对应的幅度值<br>Attn&#x3D;10^(-As&#x2F;20);   %滤波器的阻带衰减对应的幅度值<br>%转换为模拟滤波器的技术指标<br>Fs&#x3D;2000;T&#x3D;1&#x2F;Fs;Omgp&#x3D;wp<em>Fs;Omgs&#x3D;ws</em>Fs;<br>%模拟原型滤波器计算<br>[n,Omgc]&#x3D;buttord(Omgp,Omgs,Rp,As,’s’)  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;buttap(n);    %设计归一化的巴特沃思模逆滤波器原型<br>ba1&#x3D;k0<em>real(poly(z0));   %求原型滤波器的系数b<br>aa1&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba,aa]&#x3D;lp2lp(ba1,aa1,Omgc);  %变换为模拟低通滤波器<br>%用脉冲响应不变法计算数字滤波器系数<br>[bd,ad]&#x3D;impinvar(ba,aa,Fs)<br>[C,B,A]&#x3D;dir2par(bd,ad)      %转换成并联型<br>[H,w]&#x3D;freqz(bd,ad);         %求数字系统的频率特性<br>dbH&#x3D;20</em>log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);plot(w&#x2F;pi,abs(H));<br>ylabel(‘|H|’);title(‘幅度响应’);axis([0,1,0,1.1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,Attn,ripple,1]);grid<br>subplot(2,2,2);plot(w&#x2F;pi,angle(H)&#x2F;pi);<br>ylabel(‘\phi’);title(‘相位响应’);axis([0,1,-1,1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-1,0,1]);grid<br>subplot(2,2,3);plot(w&#x2F;pi,dbH);title(‘幅度响应(dB)’);<br>ylabel(‘dB’);xlabel(‘频率(\pi)’);axis([0,1,-40,5]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-50,-15,-1,0]);grid<br>subplot(2,2,4);zplane(bd,ad);axis([-1.1,1.1,-1.1,1.1]);title(‘零极点图’);<br>程序运行结果如下：<br>n &#x3D;     6<br>Omgc &#x3D;  1.8897e+003<br>bd &#x3D;   -0.0000    0.0031    0.0419    0.0569    0.0125    0.0003<br>ad &#x3D;    1.0000   -2.5418    3.1813   -2.3124    1.0072   -0.2457    0.0260<br>C &#x3D;     []<br>B &#x3D;<br>    2.4935   -0.5514<br>   -2.8792    1.1587<br>    0.3857   -0.5987<br>A &#x3D;<br>    1.0000   -0.7790    0.1612<br>    1.0000   -0.8049    0.2628<br>    1.0000   -0.9579    0.6132<br>频率特性如图7-2所示：</p>
<p>图7-2<br>由频率特性曲线可知，该设计结果在通带的截止频率满足Rp≤1dB，在阻带的截止频率满足As≥15dB,且系统的极点全部在单位圆内，是一个稳定系统。这个巴特沃斯数字低通滤波器的传递函数为：</p>
<p>3、用脉冲响应不变法设计IIR数字带通滤波器<br>例7-2 用脉冲响应不变法设计一个切比雪夫Ⅰ型数字带通滤波器，要求：通带ωp1&#x3D;0.3π,ωp2&#x3D;0.7π,Rp&#x3D;1dB；阻带ωs1&#x3D;0.1π,ωs2&#x3D;0.9π,As&#x3D;15dB，滤波器采样频率Fs&#x3D;2000Hz。<br>程序清单如下：<br>wp1&#x3D;0.3<em>pi;wp2&#x3D;0.7</em>pi;     %滤波器的通带截止频率<br>ws1&#x3D;0.1<em>pi;ws2&#x3D;0.9</em>pi;     %滤波器的阻带截止频率<br>Rp&#x3D;1;As&#x3D;15;    %滤波器的通阻带衰减指标<br>%转换为模拟滤波器的技术指标<br>Fs&#x3D;2000;T&#x3D;1&#x2F;Fs;<br>Omgp1&#x3D;wp1<em>Fs;Omgp2&#x3D;wp2</em>Fs;Omgp&#x3D;[Omgp1,Omgp2];<br>Omgs1&#x3D;ws1<em>Fs;Omgs2&#x3D;ws2</em>Fs;Omgs&#x3D;[Omgs1,Omgs2];<br>bw&#x3D;Omgp2-Omgp1;w0&#x3D;sqrt(Omgp1<em>Omgp2); %模拟通带带宽和中心频率<br>%模拟原型滤波器计算<br>[n,Omgn]&#x3D;cheb1ord(Omgp,Omgs,Rp,As,’s’)  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;cheb1ap(n,Rp);    %设计归一化的模拟滤波器原型<br>ba1&#x3D;k0</em>real(poly(z0));   %求原型滤波器的系数b<br>aa1&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba,aa]&#x3D;lp2bp(ba1,aa1,w0,bw);  %变换为模拟带通滤波器<br>%用脉冲响应不变法计算数字滤波器系数<br>[bd,ad]&#x3D;impinvar(ba,aa,Fs)<br>[C,B,A]&#x3D;dir2par(bd,ad)      %转换成并联型<br>[H,w]&#x3D;freqz(bd,ad);         %求数字系统的频率特性<br>dbH&#x3D;20*log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);plot(w&#x2F;pi,abs(H));ylabel(‘|H|’);title(‘幅度响应’);axis([0,1,0,1.1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,Attn,ripple,1]);grid<br>subplot(2,2,2);plot(w&#x2F;pi,angle(H)&#x2F;pi);ylabel(‘\phi’);title(‘相位响应’);axis([0,1,-1,1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-1,0,1]);grid<br>subplot(2,2,3);plot(w&#x2F;pi,dbH);title(‘幅度响应(dB)’);<br>ylabel(‘dB’);xlabel(‘频率(\pi)’);axis([0,1,-40,5]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-50,-15,-1,0]);grid<br>subplot(2,2,4);zplane(bd,ad);axis([-1.1,1.1,-1.1,1.1]);title(‘零极点图’);<br>程序运行结果如下：<br>n &#x3D;     3<br>Omgn &#x3D;  1.0e+003 *<br>    1.8850    4.3982<br>bd &#x3D;   -0.0000    0.1391   -0.3388    0.1299    0.1719   -0.1075<br>ad &#x3D;    1.0000   -0.4014    1.0997   -0.1566    0.8054   -0.0994    0.2888<br>C &#x3D;     []<br>B &#x3D;<br>   -0.4259   -0.1000<br>    0.6210   -0.1740<br>   -0.1951    0.0871<br>A &#x3D;<br>    1.0000    0.8994    0.6495<br>    1.0000   -0.2408    0.5374<br>    1.0000   -1.0599    0.8275<br>频率特性如图7-3所示：</p>
<p>图7-3<br>由频率特性曲线可知，该设计结果在通带的截止频率满足Rp≤1dB，在阻带的截止频率满足As≥15dB,且系统的极点全部在单位圆内，是一个稳定系统。系统的传递函数为：</p>
<p>4、观察脉冲响应不变现象和混叠现象<br>例7-3 采用脉冲响应不变法设计一个切比雪夫Ⅱ型数字低通滤波器，要求：ωp&#x3D;0.25π, Rp&#x3D;1dB；ωs&#x3D;0.4π,As&#x3D;40dB滤波器采样频率Fs&#x3D;2000Hz。在同一图形界面上显示原模拟低通滤波器和数字低通滤波器的冲激响应和幅频特性并进行比较，观察脉冲响应不变现象及幅频响应有无混叠现象。<br>程序清单如下：<br>wp&#x3D;0.25<em>pi;    %滤波器的通带截止频率<br>ws&#x3D;0.4</em>pi;     %滤波器的阻带截止频率<br>Rp&#x3D;1;As&#x3D;40;    %滤波器的通阻带衰减指标<br>%转换为模拟滤波器的技术指标<br>Fs&#x3D;2000;T&#x3D;1&#x2F;Fs;<br>Omgp&#x3D;wp<em>Fs;Omgs&#x3D;ws</em>Fs;<br>%模拟原型滤波器计算<br>[n,Omgc]&#x3D;cheb2ord(Omgp,Omgs,Rp,As,’s’);  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;cheb2ap(n,As);    %设计归一化的模拟滤波器原型<br>ba1&#x3D;k0<em>real(poly(z0));   %求原型滤波器的系数b<br>aa1&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba,aa]&#x3D;lp2lp(ba1,aa1,Omgc);  %变换为模拟低通滤波器<br>[bd,ad]&#x3D;impinvar(ba,aa,Fs);%用脉冲响应不变法计算数字滤波器系数<br>%模拟滤波器与数字滤波器的冲激响应<br>t&#x3D;0:T:(30</em>T);nt&#x3D;length(t);<br>ha&#x3D;impulse(ba,aa,t);<br>h&#x3D;impz(bd,ad,nt);<br>subplot(2,1,1),plot(t,ha<em>T,’r’),hold on<br>stem(t,h,’k’)<br>title(‘模拟与数字滤波器的冲激响应’);<br>%模拟滤波器与数字滤波器的幅频响应<br>wb&#x3D;[0:Fs]<em>2</em>pi;<br>Ha&#x3D;freqs(ba,aa,wb);<br>H&#x3D;freqz(bd,ad,wb&#x2F;Fs);<br>subplot(2,1,2)<br>plot(wb&#x2F;(2</em>pi),abs(Ha)&#x2F;max(abs(Ha)),’r’),hold on<br>plot(wb&#x2F;(2*pi),abs(H)&#x2F;max(abs(H)),’k’);<br>程序运行结果如图7-4所示：</p>
<p>图7-4<br>由图(a)可见，数字低通滤波器的冲激响应是对模拟低通滤波器冲激响应的等间隔采样，即脉冲响应不变的意义。图(b)中实线表现了原模拟低通滤波器的幅频曲线，虚线表现了数字低通滤波器的幅频曲线。图形横轴取0<del>Fs的频率范围，可以看出，数字滤波器的幅频特性是对模拟滤波器幅频特性的周期延拓，在0</del>Fs的频率范围内，关于Fs&#x2F;2对称。<br>例7-4采用脉冲响应不变法设计一个切比雪夫Ⅱ型数字高通滤波器，要求：ωp&#x3D;0.4π，Rp&#x3D;1dB；ωs&#x3D;0.25π，As&#x3D;40dB，滤波器采样频率Fs&#x3D;2000Hz。与低通滤波器相比仅将ωp与ωs数据对换。<br>程序清单如下：<br>wp&#x3D;0.25<em>pi;    %滤波器的阻带截止频率<br>ws&#x3D;0.4</em>pi;     %滤波器的通带截止频率<br>Rp&#x3D;1;As&#x3D;40;    %滤波器的通阻带衰减指标<br>%转换为模拟滤波器的技术指标<br>Fs&#x3D;2000;T&#x3D;1&#x2F;Fs;<br>Omgp&#x3D;wp<em>Fs;Omgs&#x3D;ws</em>Fs;<br>%模拟原型滤波器计算<br>[n,Omgc]&#x3D;cheb2ord(Omgp,Omgs,Rp,As,’s’);  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;cheb2ap(n,As);    %设计归一化的模拟滤波器原型<br>ba1&#x3D;k0<em>real(poly(z0));   %求原型滤波器的系数b<br>aa1&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba,aa]&#x3D;lp2hp(ba1,aa1,Omgc);  %变换为模拟高通滤波器<br>[bd,ad]&#x3D;impinvar(ba,aa,Fs);%用脉冲响应不变法计算数字滤波器系数<br>%模拟滤波器与数字滤波器的幅频响应<br>wb&#x3D;[0:Fs]<em>2</em>pi;<br>Ha&#x3D;freqs(ba,aa,wb);<br>H&#x3D;freqz(bd,ad,wb&#x2F;Fs);<br>plot(wb&#x2F;(2</em>pi),abs(Ha)&#x2F;max(abs(Ha)),’r’),hold on<br>plot(wb&#x2F;(2*pi),abs(H)&#x2F;max(abs(H)),’k’);<br>运行结果如图7-5所示。高通数字滤波器幅频曲线与模拟高通滤波器的幅频曲线比较，产生了很大的频响混叠，不能满足设计要求。</p>
<p>图7-5<br>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据和图形，结合基本原理理解每一条语句的含义。<br>2、采用脉冲响应不变法设计一个椭圆数字带通滤波器，要求：通带ωp1&#x3D;0.3π,ωp2&#x3D;0.7π,Rp&#x3D;1dB；阻带ωs1&#x3D;0.1π,ωs2&#x3D;0.9π,As&#x3D;15dB，滤波器采样频率Fs&#x3D;2000Hz。绘图显示数字滤波器的幅频特性和零极点分布图，并写出该系统的传递函数。<br>3、采用脉冲响应不变法设计一个切比雪夫Ⅱ型数字带阻滤波器，要求：通带在ωp1≤0.1π,ωp2≥0.9π范围,Rp&#x3D;1dB；阻带在0.3π≤ωs≤0.7π范围，As&#x3D;40dB，滤波器采样频率Fs&#x3D;2000Hz。在同一坐标下绘图显示原模拟带阻滤波器和数字带阻滤波器的幅频特性，观察频响特性的混叠现象。<br>四、实验预习：<br>1、认真阅读实验原理部分，明确实验目的，读懂例题程序，了解实验方法。<br>2、根据实验内容预先编写实验程序。<br>3、预习思考题：<br>① 什么是脉冲响应不变法？使用脉冲响应不变法设计数字滤波器有哪些基本步骤？<br>② 为什么脉冲响应不变法不能用于设计数字高通和带阻滤波器？<br>③ 数字滤波器的频率响应与模拟滤波器的频率响应有何区别？<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、列出本实验提出的有关MATLAB函数在调用时应注意的问题。<br>    3、给出预习思考题答案。</p>
<h1 id="实验8-用MATLAB设计IIR数字滤波器（二）"><a href="#实验8-用MATLAB设计IIR数字滤波器（二）" class="headerlink" title="实验8  用MATLAB设计IIR数字滤波器（二）"></a>实验8  用MATLAB设计IIR数字滤波器（二）</h1><p>一、实验目的：<br>1、加深对IIR数字滤波器基本设计方法的理解。<br>2、掌握用模拟滤波器原型设计IIR数字滤波器的方法。<br>3、了解MATLAB有关IIR数字滤波器设计函数的调用方法。<br>二、实验原理：<br>1、双线性变换法的基本知识<br>双线性变换法是将整个s平面映射到z平面，其映射关系为<br>    或<br>双线性变换法克服了脉冲响应不变法从s平面到z平面的多值映射的缺点，消除了频谱混叠现象。但其在变换过程中产生了非线性畸变，在设计IIR数字滤波器的过程中需要进行一定的修正。<br>用双线性变换法设计IIR数字滤波器的步骤如下：<br>① 输入给定的数字滤波器的设计指标；<br>② 根据公式Ω&#x3D;(2&#x2F;T)tan(ω&#x2F;2)进行预修正，将数字滤波器设计指标转换为模拟滤波器设计指标；<br>③ 确定模拟滤波器的最小阶数和截止频率；<br>④ 计算模拟低通原型滤波器的系统传递函数；<br>⑤ 利用模拟域频率变换法求解实际模拟滤波器的系统传递函数；<br>⑥ 用双线性变换法将模拟滤波器转换为数字滤波器。<br>2、用双线性变换法设计IIR数字低通滤波器<br>例8-1 设计一个巴特沃斯数字低通滤波器，要求：ωp&#x3D;0.25π，Rp&#x3D;1dB；ωs&#x3D;0.4π，As&#x3D;15dB，滤波器采样频率Fs&#x3D;100Hz。<br>程序清单如下：<br>wp&#x3D;0.25<em>pi;    %滤波器的通带截止频率<br>ws&#x3D;0.4</em>pi;     %滤波器的阻带截止频率<br>Rp&#x3D;1;As&#x3D;15;    %滤波器的通阻带衰减指标<br>ripple&#x3D;10^(-Rp&#x2F;20); %滤波器的通带衰减对应的幅度值<br>Attn&#x3D;10^(-As&#x2F;20);   %滤波器的阻带衰减对应的幅度值<br>%转换为模拟滤波器的技术指标<br>Fs&#x3D;100;T&#x3D;1&#x2F;Fs;<br>Omgp&#x3D;(2&#x2F;T)<em>tan(wp&#x2F;2);%原型通带频率的预修正<br>Omgs&#x3D;(2&#x2F;T)<em>tan(ws&#x2F;2);%原型阻带频率的预修正<br>%模拟原型滤波器计算<br>[n,Omgc]&#x3D;buttord(Omgp,Omgs,Rp,As,’s’)  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;buttap(n);    %设计归一化的巴特沃思模拟滤波器原型<br>ba1&#x3D;k0</em>real(poly(z0));   %求原型滤波器的系数b<br>aa1&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba,aa]&#x3D;lp2lp(ba1,aa1,Omgc);  %变换为模拟低通滤波器<br>%也可将以上4行替换为[bb,aa]&#x3D;butter(n,Omgc,’s’);直接求模拟滤波器系数<br>%用双线性变换法计算数字滤波器系数<br>[bd,ad]&#x3D;bilinear(ba,aa,Fs)<br>[sos,g]&#x3D;tf2sos(bd,ad)      %转换成级联型<br>%求数字系统的频率特性<br>[H,w]&#x3D;freqz(bd,ad);<br>dbH&#x3D;20</em>log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);plot(w&#x2F;pi,abs(H));<br>ylabel(‘|H|’);title(‘幅度响应’);axis([0,1,0,1.1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,Attn,ripple,1]);grid<br>subplot(2,2,2);plot(w&#x2F;pi,angle(H)&#x2F;pi);<br>ylabel(‘\phi’);title(‘相位响应’);axis([0,1,-1,1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-1,0,1]);grid<br>subplot(2,2,3);plot(w&#x2F;pi,dbH);title(‘幅度响应(dB)’);<br>ylabel(‘dB’);xlabel(‘频率(\pi)’);axis([0,1,-40,5]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-50,-15,-1,0]);grid<br>subplot(2,2,4);zplane(bd,ad);<br>axis([-1.1,1.1,-1.1,1.1]);title(‘零极点图’);<br>程序运行结果如下：<br>n &#x3D;     5<br>Omgc &#x3D;  103.2016<br>bd &#x3D;    0.0072    0.0362    0.0725    0.0725    0.0362    0.0072<br>ad &#x3D;    1.0000   -1.9434    1.9680   -1.0702    0.3166   -0.0392<br>sos &#x3D;<br>    1.0000    0.9956         0    1.0000   -0.3193         0<br>    1.0000    2.0072    1.0072    1.0000   -0.6984    0.2053<br>    1.0000    1.9972    0.9973    1.0000   -0.9257    0.5976<br>g &#x3D;    0.0072<br>频率特性如图8-1所示：</p>
<p>图8-1<br>由频率特性曲线可知，该设计结果再通阻带截止频率处能满足Rp≤1dB、As≥15dB的设计指标要求，系统的极点全部在单位圆内，是一个稳定系统。由n&#x3D;5可知，该滤波器是一个5阶系统，原型Ha(s)在s&#x3D;-∞处有5个零点，映射到z&#x3D;-1处。该滤波器的传递函数为</p>
<p>3、用双线性变换法设计IIR数字高通滤波器<br>例8-2 设计一个椭圆数字高通滤波器，要求：通带fp&#x3D;250Hz，Rp&#x3D;1dB；阻带fs&#x3D;150Hz，As&#x3D;20dB，滤波器采样频率Fs&#x3D;1000Hz。<br>程序清单如下：<br>fs&#x3D;150;fp&#x3D;250;Fs&#x3D;1000;T&#x3D;1&#x2F;Fs;<br>wp&#x3D;fp&#x2F;Fs<em>2</em>pi;    %滤波器的通带截止频率<br>ws&#x3D;fs&#x2F;Fs<em>2</em>pi;     %滤波器的阻带截止频率<br>Rp&#x3D;1;As&#x3D;20;    %滤波器的通阻带衰减指标<br>ripple&#x3D;10^(-Rp&#x2F;20); %滤波器的通带衰减对应的幅度值<br>Attn&#x3D;10^(-As&#x2F;20);   %滤波器的阻带衰减对应的幅度值<br>%转换为模拟滤波器的技术指标<br>Omgp&#x3D;(2&#x2F;T)<em>tan(wp&#x2F;2);%原型通带频率的预修正<br>Omgs&#x3D;(2&#x2F;T)<em>tan(ws&#x2F;2);%原型阻带频率的预修正<br>%模拟原型滤波器计算<br>[n,Omgc]&#x3D;ellipord(Omgp,Omgs,Rp,As,’s’)  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;ellipap(n,Rp,As);    %设计归一化的椭圆滤波器原型<br>ba1&#x3D;k0</em>real(poly(z0));   %求原型滤波器的系数b<br>aa1&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba,aa]&#x3D;lp2hp(ba1,aa1,Omgc);  %变换为模拟高通滤波器<br>%用双线性变换法计算数字滤波器系数<br>[bd,ad]&#x3D;bilinear(ba,aa,Fs)<br>%求数字系统的频率特性<br>[H,w]&#x3D;freqz(bd,ad);<br>dbH&#x3D;20</em>log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);plot(w&#x2F;2&#x2F;pi<em>Fs,abs(H),’k’);<br>ylabel(‘|H|’);title(‘幅度响应’);axis([0,Fs&#x2F;2,0,1.1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,fs,fp,Fs&#x2F;2]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,Attn,ripple,1]);grid<br>subplot(2,2,2);plot(w&#x2F;2&#x2F;pi</em>Fs,angle(H)&#x2F;pi<em>180,’k’);<br>ylabel(‘\phi’);title(‘相位响应’);axis([0,Fs&#x2F;2,-180,180]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,fs,fp,Fs&#x2F;2]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-180,0,180]);grid<br>subplot(2,2,3);plot(w&#x2F;2&#x2F;pi</em>Fs,dbH);title(‘幅度响应(dB)’);<br>ylabel(‘dB’);xlabel(‘频率(\pi)’);axis([0,Fs&#x2F;2,-40,5]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,fs,fp,Fs&#x2F;2]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-50,-20,-1,0]);grid<br>subplot(2,2,4);zplane(bd,ad);<br>axis([-1.1,1.1,-1.1,1.1]);title(‘零极点图’);<br>程序运行结果如下：<br>n &#x3D;     3<br>Omgc &#x3D;  2.0000e+003<br>bd &#x3D;    0.2545   -0.4322    0.4322   -0.2545<br>ad &#x3D;    1.0000    0.1890    0.7197    0.1574<br>频率特性如图8-2所示：</p>
<p>图8-2<br>4、用双线性变换法设计IIR数字带通滤波器<br>例8-3 设计一个切比雪夫Ⅰ型数字带通滤波器，要求：通带ωp1&#x3D;0.3π,ωp2&#x3D;0.7π,Rp&#x3D;1dB；阻带ωs1&#x3D;0.2π,ωs2&#x3D;0.8π,As&#x3D;20dB滤波器采样周期Ts&#x3D;0.001s。<br>程序清单如下：<br>wp1&#x3D;0.3<em>pi;wp2&#x3D;0.7</em>pi;     %滤波器的通带截止频率<br>ws1&#x3D;0.2<em>pi;ws2&#x3D;0.8</em>pi;     %滤波器的阻带截止频率<br>Rp&#x3D;1;As&#x3D;20;    %滤波器的通阻带衰减指标<br>%转换为模拟滤波器的技术指标<br>T&#x3D;0.001;Fs&#x3D;1&#x2F;T;<br>Omgp1&#x3D;(2&#x2F;T)<em>tan(wp1&#x2F;2);Omgp2&#x3D;(2&#x2F;T)<em>tan(wp2&#x2F;2);<br>Omgp&#x3D;[Omgp1,Omgp2];<br>Omgs1&#x3D;(2&#x2F;T)<em>tan(ws1&#x2F;2);Omgs2&#x3D;(2&#x2F;T)<em>tan(ws2&#x2F;2);<br>Omgs&#x3D;[Omgs1,Omgs2];<br>bw&#x3D;Omgp2-Omgp1;w0&#x3D;sqrt(Omgp1</em>Omgp2); %模拟通带带宽和中心频率<br>%bw&#x3D;Omgs2-Omgs1;w0&#x3D;sqrt(Omgs1</em>Omgs2); 设计cheb2时用模拟阻带带宽和中心频率，<br>ripple&#x3D;10^(-Rp&#x2F;20); %滤波器的通带衰减对应的幅度值<br>Attn&#x3D;10^(-As&#x2F;20);   %滤波器的阻带衰减对应的幅度值<br>%模拟原型滤波器计算<br>[n,Omgn]&#x3D;cheb1ord(Omgp,Omgs,Rp,As,’s’)  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;cheb1ap(n,Rp);    %设计归一化的模拟滤波器原型<br>%[n,Omgn]&#x3D;cheb2ord(Omgp,Omgs,Rp,As,’s’)<br>%[z0,p0,k0]&#x3D;cheb2ap(n,As);    %设计归一化的cheb2型模拟滤波器原型<br>ba1&#x3D;k0</em>real(poly(z0));   %求原型滤波器的系数b<br>aa1&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba,aa]&#x3D;lp2bp(ba1,aa1,w0,bw);  %变换为模拟带通滤波器<br>%用双线性变换法计算数字滤波器系数<br>[bd,ad]&#x3D;bilinear(ba,aa,Fs)<br> %求数字系统的频率特性<br>[H,w]&#x3D;freqz(bd,ad);<br>dbH&#x3D;20</em>log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);plot(w&#x2F;pi,abs(H));<br>ylabel(‘|H|’);title(‘幅度响应’);axis([0,1,0,1.1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.2,0.3,0.7,0.8]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,Attn,ripple,1]);grid<br>subplot(2,2,2);plot(w&#x2F;pi,angle(H)&#x2F;pi*180);<br>ylabel(‘\phi’);title(‘相位响应’);axis([0,1,-180,180]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.2,0.3,0.7,0.8]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-180,-90,0,90,180]);grid<br>subplot(2,2,3);plot(w&#x2F;pi,dbH);title(‘幅度响应(dB)’);<br>ylabel(‘dB’);xlabel(‘频率(\pi)’);axis([0,1,-60,5]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.2,0.3,0.7,0.8]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-60,-20,-1,0]);grid<br>subplot(2,2,4);zplane(bd,ad);<br>axis([-1.1,1.1,-1.1,1.1]);<br>title(‘零极点图’);<br>程序运行结果如下：<br>n &#x3D;     3<br>Omgn &#x3D;  1.0e+003 *    1.0191    3.9252<br>    bd &#x3D;    0.0736   -0.0000   -0.2208    0.0000    0.2208    0.0000   -0.0736<br>ad &#x3D;    1.0000   -0.0000    0.9761   -0.0000    0.8568   -0.0000    0.2919<br>频率特性如图8-3所示：</p>
<p>图8-3<br>由频率特性曲线可知，该设计结果再通阻带截止频率处能满足Rp≤1dB、As≥20dB的设计指标要求，系统的极点全部在单位圆内，是一个稳定系统。由n&#x3D;3可知，由3阶的模拟低通滤波器原型用双线性变换法设计出来的切比雪夫Ⅰ型数字带通滤波器是一个6阶系统。其传递函数为：</p>
<p>5、用双线性变换法设计IIR数字带阻滤波器<br>例8-4设计一个切比雪夫Ⅰ型数字带阻滤波器，要求：下通带ωp1&#x3D;0.2π，上通带ωp2&#x3D;0.8π，Rp&#x3D;1dB；阻带下限ωs1&#x3D;0.3π，阻带上限ωs2&#x3D;0.7π，As&#x3D;20dB滤波器采样频率Fs&#x3D;1000Hz。<br>程序清单如下：<br>ws1&#x3D;0.3<em>pi;ws2&#x3D;0.7</em>pi;     %滤波器的阻带截止频率<br>wp1&#x3D;0.2<em>pi;wp2&#x3D;0.8</em>pi;     %滤波器的通带截止频率<br>Rp&#x3D;1;As&#x3D;20;    %滤波器的通阻带衰减指标<br>%转换为模拟滤波器的技术指标<br>T&#x3D;0.001;Fs&#x3D;1&#x2F;T;<br>Omgp1&#x3D;(2&#x2F;T)<em>tan(wp1&#x2F;2);Omgp2&#x3D;(2&#x2F;T)<em>tan(wp2&#x2F;2);<br>Omgp&#x3D;[Omgp1,Omgp2];<br>Omgs1&#x3D;(2&#x2F;T)<em>tan(ws1&#x2F;2);Omgs2&#x3D;(2&#x2F;T)<em>tan(ws2&#x2F;2);<br>Omgs&#x3D;[Omgs1,Omgs2];<br>bw&#x3D;Omgp2-Omgp1;w0&#x3D;sqrt(Omgp1</em>Omgp2); %模拟通带带宽和中心频率<br>%bw&#x3D;Omgs2-Omgs1;w0&#x3D;sqrt(Omgs1</em>Omgs2); 设计cheb2时用模拟阻带带宽和中心频率，<br>ripple&#x3D;10^(-Rp&#x2F;20); %滤波器的通带衰减对应的幅度值<br>Attn&#x3D;10^(-As&#x2F;20);   %滤波器的阻带衰减对应的幅度值<br>%模拟原型滤波器计算<br>[n,Omgn]&#x3D;cheb1ord(Omgp,Omgs,Rp,As,’s’)  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;cheb1ap(n,Rp);    %设计归一化的模拟滤波器原型<br>%[n,Omgn]&#x3D;cheb2ord(Omgp,Omgs,Rp,As,’s’)<br>%[z0,p0,k0]&#x3D;cheb2ap(n,As);    %设计归一化的cheb2型模拟滤波器原型<br>ba1&#x3D;k0</em>real(poly(z0));   %求原型滤波器的系数b<br>aa1&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba,aa]&#x3D;lp2bs(ba1,aa1,w0,bw);  %变换为模拟带通滤波器<br>%用双线性变换法计算数字滤波器系数<br>[bd,ad]&#x3D;bilinear(ba,aa,Fs)<br> %求数字系统的频率特性<br>[H,w]&#x3D;freqz(bd,ad);<br>dbH&#x3D;20</em>log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);plot(w&#x2F;pi,abs(H));<br>ylabel(‘|H|’);xlabel(‘频率(\pi)’);title(‘幅度响应’);axis([0,1,0,1.1]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.2,0.3,0.7,0.8]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,Attn,ripple,1]);grid<br>subplot(2,2,2);plot(w&#x2F;pi,angle(H)&#x2F;pi*180);<br>ylabel(‘\phi’);xlabel(‘频率(\pi)’);title(‘相位响应’);axis([0,1,-180,180]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.2,0.3,0.7,0.8]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-180,-90,0,90,180]);grid<br>subplot(2,2,3);plot(w&#x2F;pi,dbH);title(‘幅度响应(dB)’);<br>ylabel(‘dB’);xlabel(‘频率(\pi)’);axis([0,1,-60,5]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.2,0.3,0.7,0.8]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-60,-20,-1,0]);grid<br>subplot(2,2,4);zplane(bd,ad);<br>axis([-1.1,1.1,-1.1,1.1]);title(‘零极点图’);<br>程序运行结果如下：<br>n &#x3D;     3<br>Omgn &#x3D;  1.0e+003 *<br>0.6498	6.1554<br>    bd &#x3D;    0.0736   -0.0000    0.2208    0.0000    0.2208   -0.0000    0.0736<br>ad &#x3D;    1.0000    0.0000   -0.9761   -0.0000    0.8568    0.0000   -0.2919<br>频率特性及零极点图如图8-4所示：</p>
<p>图8-4</p>
<p>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据和图形，结合基本原理理解每一条语句的含义。<br>2、用双线性变换法设计切比雪夫Ⅱ型数字滤波器，列出传递函数并描绘模拟和数字滤波器的幅频响应曲线。<br>① 设计一个数字低通滤波器，要求：ωp&#x3D;0.2π，Rp&#x3D;1dB；阻带：ωs&#x3D;0.35π，As&#x3D;15dB，<br>滤波器采样频率Fs&#x3D;10Hz。<br>② 设计一个数字高通滤波器，要求：ωp&#x3D;0.35π，Rp&#x3D;1dB；阻带：ωs&#x3D;0.2π，As&#x3D;15dB，<br>滤波器采样频率Fs&#x3D;10Hz。<br>3、设计一个切比雪夫Ⅱ型数字带通滤波器，要求：fp1&#x3D;200Hz，fp2&#x3D;300Hz，Rp&#x3D;1dB；<br>fs1&#x3D;150Hz，fs2&#x3D;350Hz，As&#x3D;20dB；滤波器采样周期Ts&#x3D;0.001s。列出传递函数并作频率响应曲线和零极点分布图。<br>四、实验预习：<br>1、认真阅读实验原理，明确本次实验任务，读懂例题程序，了解实验方法。<br>2、根据实验内容，预先编写实验程序。<br>3、预习思考题：<br>① 什么是双线性变换法？使用双线性变换法设计数字滤波器有哪些步骤？<br>② 使用双线性变换法时，模拟频率与数字频率有何关系？会带来什么影响？如何解决？<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、列出本实验提出的有关MATLAB函数在调用时应注意的问题。<br>    3、给出预习思考题答案。</p>
<h1 id="实验9-用MATLAB设计IIR数字滤波器（三）"><a href="#实验9-用MATLAB设计IIR数字滤波器（三）" class="headerlink" title="实验9  用MATLAB设计IIR数字滤波器（三）"></a>实验9  用MATLAB设计IIR数字滤波器（三）</h1><p>一、实验目的：<br>1、加深对IIR数字滤波器基本设计方法的理解。<br>2、掌握MATLAB有关直接设计IIR模拟和数字滤波器的函数用法，明确设计模拟滤波器和数字滤波器的区别。<br>3、初步了解采样频率的选择与数字滤波器实现的关系。<br>二、实验原理：<br>1、用直接法设计模拟和数字滤波器<br>前面讨论的IIR数字滤波器设计，采用先设计模拟低通原型滤波器，再变换成实际模拟滤波器的方法，如图9-1所示的方法1。这个过程一般要使用以下几条程序：<br>[z0,p0,k0]&#x3D;buttap(n);        %归一化原型设计<br>ba&#x3D;k0*real(poly(z0));        %求原型滤波器系数b<br>aa&#x3D;real(poly(p0));           %求原型滤波器系数a<br>[ba1,aa1]&#x3D;lp2lp(ba,aa,Omgc);  %变换为模拟低通滤波器系数b，a<br>本实验介绍的模拟滤波器设计方法——直接法，则采用图9-1所示的方法2。只需要一条程序就可替代上面4行：[ba1,aa1]&#x3D;butter(n,wc,’s’);这条程序执行后，将生成一组实际的模拟滤波器系数。’s’不可省，若缺省，则设计结果为数字滤波器。如：[ba1,aa1]&#x3D;butter(n,wn);这条程序执行后，整个设计即进行到图9-1所示的最后一步。</p>
<p>图9-1<br>2、IIR数字滤波器设计方法比较<br>例9-1 设计一个巴特沃斯数字低通滤波器，要求：通带fp&#x3D;150Hz，Rp&#x3D;3dB；阻带fs&#x3D;250Hz，As&#x3D;20dB，滤波器采样频率Fs&#x3D;800Hz。<br>说明：用图9-1所示的方法1、方法2及直接法求解。程序清单如下：<br>fp&#x3D;150;fs&#x3D;250;Fs&#x3D;800;T&#x3D;1&#x2F;Fs;<br>wp&#x3D;fp&#x2F;Fs<em>2</em>pi;    %滤波器的通带截止频率<br>ws&#x3D;fs&#x2F;Fs<em>2</em>pi;     %滤波器的阻带截止频率<br>Rp&#x3D;3;As&#x3D;20;    %滤波器的通阻带衰减指标<br>%转换为模拟滤波器的技术指标<br>Omgp&#x3D;(2&#x2F;T)<em>tan(wp&#x2F;2);%原型通带频率的预修正<br>Omgs&#x3D;(2&#x2F;T)<em>tan(ws&#x2F;2);%原型阻带频率的预修正<br>%方法1：模拟原型滤波器计算<br>%模拟原型滤波器计算<br>[n,Omgc]&#x3D;buttord(Omgp,Omgs,Rp,As,’s’)  %计算阶数n和截止频率<br>[z0,p0,k0]&#x3D;buttap(n);    %设计归一化的巴特沃思模拟滤波器原型<br>ba&#x3D;k0</em>real(poly(z0));   %求原型滤波器的系数b<br>aa&#x3D;real(poly(p0));      %求原型滤波器的系数a<br>[ba1,aa1]&#x3D;lp2lp(ba,aa,Omgc);  %变换为模拟低通滤波器<br>[bd1,ad1]&#x3D;bilinear(ba1,aa1,Fs)   %用双线性变换法计算数字滤波器系数<br>[H1,w1]&#x3D;freqz(bd1,ad1);    %求数字系统的频率特性<br>dbH1&#x3D;20</em>log10((abs(H1)+eps)&#x2F;max(abs(H1)));<br>%方法2：直接求模拟滤波器系数<br>[ba2,aa2]&#x3D;butter(n,Omgc,’s’);[bd2,ad2]&#x3D;bilinear(ba2,aa2,Fs)<br>[H2,w2]&#x3D;freqz(bd2,ad2);dbH2&#x3D;20<em>log10((abs(H2)+eps)&#x2F;max(abs(H2)));<br>%方法3：直接求数字滤波器系数<br>[n3,wc3]&#x3D;buttord(wp&#x2F;pi,ws&#x2F;pi,Rp,As);<br>[bd3,ad3]&#x3D;butter(n3,wc3)[H3,w3]&#x3D;freqz(bd3,ad3);<br>dbH3&#x3D;20</em>log10((abs(H3)+eps)&#x2F;max(abs(H3)));<br>subplot(3,2,1);plot(w1&#x2F;2&#x2F;pi<em>Fs,dbH1,’k’);<br>ylabel(‘dB’);title(‘方法1 幅度响应（dB）’);axis([0,Fs&#x2F;2,-40,5]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,150,250,400]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-20,-3,0,10]);grid<br>subplot(3,2,2);plot(w1&#x2F;2&#x2F;pi</em>Fs,angle(H1)&#x2F;pi*180);<br>ylabel(‘\phi’);title(‘相位响应’);axis([0,Fs&#x2F;2,-180,180]);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,150,250,400]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-180,0,180]);grid<br>程序运行结果如下：<br>n &#x3D;     3<br>Omgc &#x3D;  1.1133e+003<br>bd1 &#x3D;    0.0911    0.2734    0.2734    0.0911<br>ad1 &#x3D;    1.0000   -0.6526    0.4465   -0.0649<br>bd2 &#x3D;    0.0911    0.2734    0.2734    0.0911<br>ad2 &#x3D;    1.0000   -0.6526    0.4465   -0.0649<br>bd3 &#x3D;    0.0911    0.2734    0.2734    0.0911<br>ad3 &#x3D;    1.0000   -0.6526    0.4465   -0.0649<br>频率响应特性曲线如图9-2所示。由图可见，三种设计的结果完全相同；从程序结构上看，直接法更简单。<br>由于大规模集成电路和计算机技术的迅速发展，模拟滤波器设计只是为了最终设计数字滤波器做准备，因此，下面仅讨论数字滤波器的设计。<br>3、用MATLAB直接法设计IIR数字滤波器<br>例9-2 设计一个巴特沃斯数字高通滤波器，要求：ωp&#x3D;0.25П，Rp&#x3D;1dB；ωs&#x3D;0.4П，As&#x3D;20dB，滤波器采样频率Fs&#x3D;100Hz。要求描绘其幅频特性和相频特性曲线，列写系统传递函数表达式。<br>程序清单如下：<br>ws&#x3D;0.25;wp&#x3D;0.4;Rp&#x3D;1;As&#x3D;20;Fs&#x3D;200;[n,wc]&#x3D;buttord(wp,ws,Rp,As) [b,a]&#x3D;butter(n,wc,’high’)</p>
<p>图9-2<br>freqz(b,a);<br>figure(2)<br>freqz(b,a,512,Fs);<br>程序运行结果如下：<br>n &#x3D;     6<br>wc &#x3D;    0.3475<br>b &#x3D;    0.1049   -0.6291    1.5728   -2.0971    1.5728   -0.6291    0.1049<br>a &#x3D;    1.0000   -1.8123    2.0099   -1.2627    0.5030   -0.1116    0.0110<br>该系统的传递函数为</p>
<p>特性曲线如图9-3所示：</p>
<p>（a）                                     （b）<br>图9-3<br>例9-3 采用MATLAB直接法设计一个切比雪夫Ⅰ型带通滤波器，要求：ωp1&#x3D;0.25П，ωp2&#x3D;0.75П，Rp&#x3D;1dB；ωs1&#x3D;0.85П，ωs2&#x3D;0.15П，As&#x3D;20dB。描绘滤波器归一化的绝对和相对幅频特性、相频特性、零极点分布图，列出系统传递函数式。<br>程序清单如下：<br>ws1&#x3D;0.15;ws2&#x3D;0.85;ws&#x3D;[ws1,ws2];<br>wp1&#x3D;0.25;wp2&#x3D;0.75;wp&#x3D;[wp1,wp2];<br>Rp&#x3D;1;As&#x3D;20;<br>[n,wc]&#x3D;cheb1ord(wp,ws,Rp,As)<br>[b,a]&#x3D;cheby1(n,Rp,wc)<br>[H,w]&#x3D;freqz(b,a);dbH&#x3D;20*log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);plot(w&#x2F;pi,abs(H));<br>axis([0,1,0,1.1]);<br>xlabel(‘频率(\pi)’);ylabel(‘|H|’);<br>title(‘幅度响应’)<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws1,wp1,wp2,ws2,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0.1,0.8913,1]);grid<br>subplot(2,2,2);plot(w&#x2F;pi,angle(H));<br>axis([0,1,-4,4]);<br>xlabel(‘频率(\pi)’);ylabel(‘\phi’);<br>title(‘相位响应（\pi）’)<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws1,wp1,wp2,ws2,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>subplot(2,2,3);plot(w&#x2F;pi,dbH);<br>axis([0,1,-40,1]);<br>xlabel(‘频率(\pi)’);ylabel(‘dB’);<br>title(‘幅度响应（dB）’)<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws1,wp1,wp2,ws2,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-20,-1,0]);grid<br>subplot(2,2,4);zplane(b,a);<br>title(‘零极图’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0]);grid<br>程序运行结果如下：<br>n&#x3D;     3<br>wc &#x3D;    0.2500    0.7500<br>b &#x3D;    0.1321         0   -0.3964         0    0.3964         0   -0.1321<br>a &#x3D;    1.0000    0.0000    0.3432   -0.0000    0.6044   -0.0000    0.2041<br>    特性曲线如图9-4所示：</p>
<p>图9-4<br>系统传递函数为：</p>
<p>例9-4 采用MATLAB直接法设计一个切比雪夫Ⅱ型带阻滤波器，要求：fp1&#x3D;1.5kHz，fp2&#x3D;8.5kHz，Rp&#x3D;1dB；fs1&#x3D;2.5kHz，fs2&#x3D;7.5kHz，As&#x3D;20dB，滤波器采样频率Fs&#x3D;20kHz。描绘滤波器归一化的绝对和相对幅频特性、相频特性、零极点分布图，列出系统传递函数式。<br>程序清单如下：<br>Fs&#x3D;20;ws1&#x3D;2.5&#x2F;(Fs&#x2F;2);ws2&#x3D;7.5&#x2F;(Fs&#x2F;2);ws&#x3D;[ws1,ws2];<br>wp1&#x3D;1.5&#x2F;(Fs&#x2F;2);wp2&#x3D;8.5&#x2F;(Fs&#x2F;2);wp&#x3D;[wp1,wp2];Rp&#x3D;1;As&#x3D;20;<br>[n,wc]&#x3D;cheb2ord(wp,ws,Rp,As)<br>[b,a]&#x3D;cheby2(n,As,wc,’stop’)<br>[H,f]&#x3D;freqz(b,a,512,Fs);dbH&#x3D;20*log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);plot(f,abs(H));<br>axis([0,10,0,1.1]);xlabel(‘频率(kHz)’);ylabel(‘|H|’);title(‘幅度响应’)<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,1.5,2.5,7.5,8.5,10]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0.1,0.8913,1]);grid<br>subplot(2,2,2);plot(f,angle(H));<br>axis([0,10,-4,4]);xlabel(‘频率(kHz)’);ylabel(‘\phi’);title(‘相位响应（\pi）’)<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,1.5,2.5,7.5,8.5,10]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>subplot(2,2,3);plot(f,dbH);<br>axis([0,10,-40,1]);xlabel(‘频率(Hz)’);ylabel(‘dB’);title(‘幅度响应（dB）’)<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,1.5,2.5,7.5,8.5,10]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-20,-1,0]);grid<br>subplot(2,2,4);zplane(b,a);title(‘零极图’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0]);grid<br>程序运行结果如下：<br>n &#x3D;     3<br>wc &#x3D;    0.2500    0.7500<br>b &#x3D;    0.1876   -0.0000    0.2412   -0.0000    0.2412   -0.0000    0.1876<br>a &#x3D;    1.0000   -0.0000   -0.6020    0.0000    0.4957   -0.0000   -0.0359<br>特性曲线如图9-5所示：</p>
<p>图9-5<br>4、采样频率对数字滤波器传递函数的影响<br>前面设计的IIR数字滤波器，从设计指标到频率响应曲线、零极点分布图都满足设计要求，是否实际的系统就一定能实现呢？不一定。因为MATLAB与DSP硬件系统在运算精度、动态范围上是不同的。MATLAB计算的精度往往高于硬件系统能够达到的精度。在DSP上使用C或汇编语言进行运算，一般采用单精度的浮点数或定点数。另外，A&#x2F;D、D&#x2F;A转换使用的芯片，其位数通常也比较低，这些都将造成一定的误差。例如，DSP采用定点运算，首先需要对IIR数字滤波器设计的一组传递函数系数进行归一化处理，然后再转换为一组定点数，即化为一组-32768~32767之间的整数。<br>下面我们通过例题来观察不同采样频率对经处理后的数字滤波器系数的影响。<br>例9-5设计一个巴特沃斯数字低通滤波器，要求：通带fp&#x3D;150Hz，Rp&#x3D;1dB；阻带fs&#x3D;250Hz，As&#x3D;20dB，改变滤波器采样频率Fs，观察不同采样频率对经处理后的数字滤波器系数的影响。<br>程序清单如下：<br>Fs&#x3D;600;fp&#x3D;150;fs&#x3D;250;<br>wp&#x3D;fp&#x2F;Fs<em>2;ws&#x3D;fs&#x2F;Fs</em>2;<br>Rp&#x3D;1;As&#x3D;20;<br>[n,wc]&#x3D;buttord(wp,ws,Rp,As);<br>[b,a]&#x3D;butter(n,wc)<br>%进行归一化处理，转换成-32768到32767之间的整数<br>c&#x3D;max(abs(b));d&#x3D;max(abs(a));maxba&#x3D;max(c,d);<br>bd&#x3D;round(b&#x2F;maxba<em>32767)<br>ad&#x3D;round(a&#x2F;maxba</em>32767)<br>zplane(b,a)<br>程序运行结果如下：<br>b &#x3D;    0.3324    0.9972    0.9972    0.3324<br>a &#x3D;    1.0000    0.9687    0.5842    0.1064<br>bd &#x3D;       10892       32676       32676       10892<br>ad &#x3D;       32767       31741       19141        3488<br>Fs&#x3D;2000Hz时，运行结果如下：<br>b &#x3D;    0.0002    0.0010    0.0026    0.0034    0.0026    0.0010    0.0002<br>a &#x3D;    1.0000   -3.8778    6.5266   -6.0382    3.2201   -0.9349    0.1151<br>bd &#x3D;     1     5    13    17    13     5     1<br>ad &#x3D;    5020   -19468   32767    -30315    16167    -4693    578<br>由图9-6(a)所示的零极点分布图可见，这是一个稳定系统。当Fs&#x3D;600Hz时，既满足Fs≥2fs，又不是远大于2fs，设计的滤波器系数在数量级上比较一致，且没有出现大于1的系数，不会由于进行定点数的处理而损失某些数据。<br>由图9-6(b)所示的零极点分布图可见，这也是一个稳定系统。但由于原大于1的系数被归一化，损失了部分信息，因此把这些数据输入DSP硬件系统进行处理时，这个数字滤波器就会出现很大误差，甚至不能实现。</p>
<p>图9-6<br>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据和图形，结合基本原理理解每一条语句的含义。<br>2、采用MATLAB直接法设计一个切比雪夫Ⅱ型低通滤波器，要求：ωp&#x3D;0.2π，Rp&#x3D;1dB； ωs&#x3D;0.3π，As&#x3D;20dB。描绘滤波器绝对和相对幅频特性、相频特性、零极点分布图，列出系统传递函数式。<br>3、采用MATLAB直接法设计一个椭圆型数字高通滤波器，要求：ωp&#x3D;0.3π，Rp&#x3D;1dB； ωs&#x3D;0.2π，As&#x3D;20dB。描绘滤波器绝对和相对幅频特性、相频特性、零极点分布图，列出系统传递函数式。<br>4、采用MATLAB直接法设计一个巴特沃斯带通数字滤波器，要求：fp1&#x3D;3.5kHz，fp2&#x3D;6.5kHz，Rp&#x3D;3dB；fs1&#x3D;2.5kHz，fs2&#x3D;7.5kHz，As&#x3D;15dB,滤波器采样频率Fs&#x3D;20kHz。描绘滤波器归一化的绝对和相对幅频特性、相频特性、零极点分布图，列出系统传递函数式。<br>5、采用MATLAB直接法设计一个切比雪夫Ⅰ型数字带阻滤波器，要求：fp1&#x3D;1kHz，fp2&#x3D;4.5kHz，Rp&#x3D;1dB；fs1&#x3D;2kHz，fs2&#x3D;3.5kHz，As&#x3D;20dB,滤波器采样频率Fs&#x3D;10kHz。描绘滤波器绝对和相对幅频特性、相频特性、零极点分布图，列出系统传递函数式。<br>四、实验预习：<br>1、认真阅读实验原理，明确本次实验任务，读懂例题程序，了解实验方法。<br>2、根据实验内容，预先编写实验程序。<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、列出本实验提出的有关MATLAB函数在调用时应注意的问题。</p>
<h1 id="实验10-用MATLAB设计FIR数字滤波器（一）"><a href="#实验10-用MATLAB设计FIR数字滤波器（一）" class="headerlink" title="实验10  用MATLAB设计FIR数字滤波器（一）"></a>实验10  用MATLAB设计FIR数字滤波器（一）</h1><p>一、实验目的：<br>1、加深对线性相位FIR数字滤波器的理解。<br>2、掌握线性相位滤波器符幅特性和零极点分布的研究方法。<br>3、了解用MATLAB研究线性相位滤波器特性时程序编写的方法和思路。<br>二、实验原理：<br>1、线性相位FIR滤波器的特性<br>与IIR滤波器相比，FIR滤波器在保证幅度特性满足技术要求的同时，很容易做到严格的线性相位特性。设FIR滤波器单位脉冲响应h(n)长为N，其系统函数为</p>
<p>当滤波器的系数N满足一定的对称条件时，就可以获得线性相位。线性相位FIR滤波器共分为四种类型，分别为：<br>（1）类型Ⅰ：系数对称，即h(n)&#x3D;h(N-1-n)，N为奇数。<br>（2）类型Ⅱ：系数对称，即h(n)&#x3D;h(N-1-n)，N为偶数。<br>（3）类型Ⅲ：系数反对称，即h(n)&#x3D; -h(N-1-n)，N为奇数。<br>（4）类型Ⅳ：系数反对称，即h(n)&#x3D; -h(N-1-n)，N为偶数。<br>对于上述四类线性相位FIR数字滤波器，有自定义函数amplres可以求解考虑正负号的幅频特性。定义如下：<br>%给定FIR滤波器的系数，求滤波器符幅特性<br>function[A,w,type,tao]&#x3D;amplres(h)<br>%h&#x3D;FIR滤波器的脉冲响应或系数向量<br>%A&#x3D;滤波器符幅特性<br>%w&#x3D;频率向量，在0到pi之间分成500份，501个点<br>%type&#x3D;线性相位滤波器的类型<br>%tao&#x3D;符幅特性的群时延<br>N&#x3D;length(h);tao&#x3D;(N-1)&#x2F;2;<br>L&#x3D;floor((N-1)&#x2F;2);%求滤波器的阶次及符幅特性的阶次<br>n&#x3D;1:L+1;<br>w&#x3D;[0:500]<em>2</em>pi&#x2F;500;%取滤波器频率向量<br>if all(abs(h(n)-h(N-n-1))&lt;1e-10)%判断滤波器系数，若为对称<br>    A&#x3D;2*h(n)*cos(((N+1)&#x2F;2-n)’*w)-mod(N,2)<em>h(L+1);<br>    %对称条件下计算A（两种类型）<br>    %在N&#x3D;奇数时，h(L+1)多算一倍，要减掉。N为偶数时<br>    %乘以mod(N,2)以取消该项<br>    A&#x3D;2</em>h(n)*sin(((N+1)&#x2F;2-n)’*w)%反对称条件下计算A（两种类型）<br>    type&#x3D;4-mod(N,2)；%判断并给出类型<br>else error(‘错误：这不是线性相位滤波器！’)<br>end<br>另外FIR滤波器的H(z)是z-1的N-1次多项式，它在z平面上有N-1个零点，原点z&#x3D;0是N-1阶重极点。由于线性相位FIR滤波器的极点都在原点处，因此不存在稳定性的问题。但有必要研究零点对滤波器特性的影响。<br>2、第一类线性相位滤波器（类型Ⅰ）<br>例10-1 已知FIR线性相位系统h&#x3D;[3,-1,-5,4,6,4,-5,-1,3]，要求：描绘系统的冲激响应和符幅特性。<br>程序清单如下：<br>h&#x3D;[3,-1,-5,4,6,4,-5,-1,3];M&#x3D;length(h);n&#x3D;0:M-1;<br>[A,w,type,tao]&#x3D;amplres(h);type<br>subplot(2,1,1),stem(n,h);ylabel(‘h(n)’);xlabel(‘n’);<br>subplot(2,1,2),plot(w&#x2F;pi,A);ylabel(‘A’);xlabel(‘\pi’);<br>程序运行结果如下：<br>type &#x3D;     1<br>滤波器冲激响应和符幅特性如图10-1所示：</p>
<p>图10-1<br>由图可见，这是一个第一类线性相位滤波器。滤波器的系数N(&#x3D;9)为奇数，且h(n)&#x3D;h(N-1-n)，幅度特性关于ω&#x3D;π对称，在ω&#x3D;0和ω&#x3D;π处可以取任何值，可以用于实现低通、高通、带通、带阻等各种滤波器的设计。<br>3、第二类线性相位滤波器（类型Ⅱ）<br>例10-2 已知FIR线性相位系统h&#x3D;[3,-1,-5,4,4,-5,-1,3]，要求：描绘系统的冲激响应和符幅特性。<br>程序清单如下：<br>h&#x3D;[3,-1,-5,4,4,-5,-1,3];<br>M&#x3D;length(h);n&#x3D;0:M-1;<br>[A,w,type,tao]&#x3D;amplres(h);type<br>subplot(2,1,1),stem(n,h);<br>ylabel(‘h(n)’);xlabel(‘n’);<br>subplot(2,1,2),plot(w&#x2F;pi,A);<br>ylabel(‘A’);xlabel(‘\pi’);<br>程序运行结果如下：<br>type &#x3D;     2<br>滤波器冲激响应和符幅特性如图10-2所示：</p>
<p>图10-2<br>由图可见，这是一个第二类线性相位滤波器。滤波器的系数N(&#x3D;8)为偶数，且h(n)&#x3D;h(N-1-n)，幅度特性关于ω&#x3D;π反对称，在ω&#x3D;0处可以取任何值，在ω&#x3D;π处必定为零，不能用于实现高通和带阻滤波器的设计。<br>4、第三类线性相位滤波器（类型Ⅲ）<br>例10-3 已知FIR线性相位系统h&#x3D;[3,-1,-5,4,0,-4,5,1,-3]，要求：描绘系统的冲激响应和符幅特性。<br>程序清单如下：<br>h&#x3D;[3,-1,-5,4,0,-4,5,1,-3];M&#x3D;length(h);n&#x3D;0:M-1;<br>[A,w,type,tao]&#x3D;amplres(h);type<br>subplot(2,1,1),stem(n,h);ylabel(‘h(n)’);xlabel(‘n’);<br>subplot(2,1,2),plot(w&#x2F;pi,A);ylabel(‘A’);xlabel(‘\pi’);<br>程序运行结果如下：<br>type &#x3D;     3<br>滤波器冲激响应和符幅特性如图10-3所示：</p>
<p>图10-3<br>由图可见，这是一个第三类线性相位滤波器。滤波器的系数N(&#x3D;9)为奇数，且h(n)&#x3D;-h(N-1-n)，幅度特性关于ω&#x3D;π反对称，在ω&#x3D;0和ω&#x3D;π处必定为零，只能用于实现带通滤波器的设计。<br>5、第四类线性相位滤波器（类型Ⅳ）<br>例10-4 已知FIR线性相位系统h&#x3D;[3,-1,-5,4,-4,5,1,-3]，要求：描绘系统的冲激响应和符幅特性。<br>程序清单如下：<br>h&#x3D;[3,-1,-5,4,-4,5,1,-3];M&#x3D;length(h);n&#x3D;0:M-1;<br>[A,w,type,tao]&#x3D;amplres(h);type<br>subplot(2,1,1),stem(n,h);ylabel(‘h(n)’);xlabel(‘n’);<br>subplot(2,1,2),plot(w&#x2F;pi,A);ylabel(‘A’);xlabel(‘\pi’);<br>程序运行结果如下：<br>type &#x3D;     4<br>滤波器冲激响应和符幅特性如图10-4所示：</p>
<p>图10-4<br>由图可见，这是一个第四类线性相位滤波器。滤波器的系数N(&#x3D;8)为偶数，且h(n)&#x3D;-h(N-1-n)，幅度特性关于ω&#x3D;π对称，在ω&#x3D;0处必定为零，ω&#x3D;π处可取任意值，只能用于实现高通、带通滤波器的设计。<br>6、线性相位FIR数字滤波器零点分布特点<br>线性相位FIR数字滤波器的零点分布有三种情况：<br>（1）在zi&#x3D;1或zi&#x3D;-1位的零点单独出现；<br>（2）实数零点或在单位圆上的复数零点按z1与1&#x2F;z1成对出现。<br>（3）非单位圆上的复数零点，则按z1、z1<em>、1&#x2F;z1、（1&#x2F;z1）</em>四个点同时出现。<br>例10-5 求例10-1线性相位系统的零极点分布图，并证明实数零点和复数零点成组出现的特点。<br>程序清单如下：<br>h&#x3D;[3,-1,-5,4,6,4,-5,-1,3];M&#x3D;length(h);n&#x3D;0:M-1;rz&#x3D;roots(h)<br>for i&#x3D;1:8<br>    r(i)&#x3D;1&#x2F;rz(i);<br>end<br>r’<br>zplane(h,1)<br>程序运行结果如图10-5和表10-1所示。由图可见，序号为1、2、6、7的四个复数为一组；在实轴上的3、8两个实数为一组；处于单位圆上的4、5为一组。</p>
<p>图10-5</p>
<p>表10-1<br>i	rz	1&#x2F;rz<br>1	1.1674 + 0.7868i	0.5891 + 0.3970i<br>2	1.1674 - 0.7868i	0.5891 - 0.3970i<br>3	-1.3732	-0.7283<br>4	-0.5391 + 0.8423i	-0.5391 + 0.8423i<br>5	-0.5391 - 0.8423i	-0.5391 - 0.8423i<br>6	0.5891 + 0.3970i	1.1674 + 0.7868i<br>7	0.5891 - 0.3970i	1.1674 - 0.7868i<br>8	-0.7283	-1.3723</p>
<pre><code>用类似的方法可分析例10-2、10-3、10-4的线性相位系统的零极点分布图，读者可自行分析。
</code></pre>
<p>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据和图形，结合基本原理理解每一条语句的含义。<br>2、由序列h0&#x3D;[3,-1,2,-3]为基础构成四种类型的线性相位FIR滤波器，即：<br>① h1&#x3D;[3,-1,2,-3,5,-3,2,-1,3]           ② h2&#x3D;[3,-1,2,-3,-3,2,-1,3]<br>③ h1&#x3D;[3,-1,2,-3,0,3,-2,1,-3]           ④ h4&#x3D;[3,-1,2,-3,3,-2,1,-3]<br>分别求它们的冲激响应和符幅特性，并在同一图形窗口上描绘出来，进行比较。<br>3、求解线性相位系统h&#x3D;[3,-1,2,-3,5,-3,2,-1,3]的零极点分布图，并观察实数零点和复数零点成组出现的特点。<br>四、实验预习：<br>1、认真阅读实验原理，明确本次实验任务，读懂例题程序，了解实验方法。<br>2、根据实验内容，预先编写实验程序。<br>3、预习思考题：<br>① 线性相位FIR数字滤波器如何分类？各种类型线性相位滤波器的冲激响应和符幅特性有什么特点？<br>② 线性相位FIR滤波器的零点分布有何特点？<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、给出预习思考题答案。</p>
<h1 id="实验11-用MATLAB设计FIR数字滤波器（二）"><a href="#实验11-用MATLAB设计FIR数字滤波器（二）" class="headerlink" title="实验11  用MATLAB设计FIR数字滤波器（二）"></a>实验11  用MATLAB设计FIR数字滤波器（二）</h1><p>一、实验目的：<br>1、加深对窗函数法设计FIR数字滤波器的基本原理的理解。<br>2、学习用MATLAB语言的窗函数法编写设计FIR数字滤波器的程序。<br>3、了解MATLAB语言有关窗函数法设计FIR数字滤波器的常用函数用法。<br>二、实验原理：<br>1、用窗函数法设计FIR数字滤波器<br>FIR数字滤波器的系统函数为</p>
<p>这个公式也可以看成是离散LSI系统的系统函数</p>
<p>分母a0为1，其余ak全都为0时的一个特例。由于极点全部集中在零点，稳定和线性相位特性是FIR滤波器的突出优点，因此在实际中广泛使用。<br>FIR滤波器的设计任务是选择有限长度的h(n)，使传输函数H(ejω)满足技术要求。主要设计方法有窗函数法、频率采样法和切比雪夫等波纹逼近法等。本实验主要介绍窗函数法。<br>用窗函数法设计FIR数字滤波器的基本步骤如下：<br>（1）根据过渡带和阻带衰减指标选择窗函数的类型，估算滤波器的阶数N。<br>（2）由数字滤波器的理想频率响应H(ejω)求出其单位冲激响应hd(n)。<br>可用自定义函数ideal_lp实现理想数字低通滤波器频率响应的求解。<br>程序清单如下：<br>function hd&#x3D;ideal_lp(wc,N) %点0到N-1之间的理想脉冲响应<br>%wc&#x3D;截止频率（弧度）<br>%N&#x3D;理想滤波器的长度<br>tao&#x3D;(N-1)&#x2F;2;<br>n&#x3D;[0:(N-1)];<br>m&#x3D;n-tao+eps; %加一个小数以避免0作除数<br>hd&#x3D;sin(wc<em>m).&#x2F;(pi</em>m);<br>其它选频滤波器可以由低通频响特性合成。如一个通带在ωc1～ωc2之间的带通滤波器在给定N值的条件下，可以用下列程序实现：<br>Hd&#x3D;ideal_lp(wc2,N)-ideal_lp(wc1,N)<br>（3）计算数字滤波器的单位冲激响应h(n)&#x3D;w(n)hd(n)。<br>（4）检查设计的滤波器是否满足技术指标。<br>如果设计的滤波器不满足技术指标，则需要重新选择或调整窗函数的类型，估算滤波器的阶数N。再重复前面的四个步骤，直到满足指标。<br>常用的窗函数有矩形窗、三角形窗、汉宁窗、哈明窗、切比雪夫窗、布莱克曼窗、凯塞窗等，MATLAB均有相应的函数可以调用。另外，MATLAB信号处理工具箱还提供了fir1函数，可以用于窗函数法设计FIR滤波器。<br>由于第一类线性相位滤波器（类型Ⅰ）能进行低通、高通、带通、带阻滤波器的设计，因此，本实验所有滤波器均采用第一类线性相位滤波器。<br>2、各种窗函数特性的比较<br>例11-1 在同一图形坐标上显示矩形窗、三角形窗、汉宁窗、哈明窗、布莱克曼窗、凯塞窗的特性曲线。<br>程序清单如下：<br>N&#x3D;64;beta&#x3D;7.865;n&#x3D;1:N;<br>wbo&#x3D;boxcar(N);<br>wtr&#x3D;triang(N);<br>whn&#x3D;hanning(N);<br>whm&#x3D;hamming(N);<br>wbl&#x3D;blackman(N);<br>wka&#x3D;kaiser(N,beta);<br>plot(n,wbo,’-‘,n,wtr,’*’,n,whn,’+’,n,whm,’.’,n,wbl,’o’,n,wka,’d’);<br>axis([0,N,0,1.1]);<br>legend(‘矩形’,’三角形’,’汉宁’,’哈明’,’布莱克曼’,’凯塞’)<br>程序运行结果如图11-1所示。<br>为了便于滤波器设计，表11-1给出了六种窗函数的特性参数。</p>
<p>表11-1 六种窗函数的特性参数表<br>窗函数	旁瓣峰值&#x2F;dB	近似过渡带宽	精确过渡带宽	阻带最小衰减&#x2F;dB<br>矩形窗	-13	4<br>1.8<br>21<br>三角形窗	-25	8<br>6.1<br>25<br>汉宁窗	-31	8<br>6.2<br>44<br>哈明窗	-41	8<br>6.6<br>53<br>布莱克曼窗	-57	12<br>11<br>74<br>凯塞窗	-57		10<br>80</p>
<p>   图11-1<br>3、用窗函数法设计FIR数字低通滤波器<br>例11-2 用矩形窗设计一个FIR数字低通滤波器，要求：N&#x3D;64，截止频率ωc&#x3D;0.4 ，描绘理想和实际滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线。<br>程序清单如下：<br>wc&#x3D;0.4<em>pi;<br>N&#x3D;64;n&#x3D;0:N-1;<br>hd&#x3D;ideal_lp(wc,N);<br>windows&#x3D;(boxcar(N))’;<br>b&#x3D;hd.<em>windows;<br>[H,w]&#x3D;freqz(b,1);<br>dbH&#x3D;20</em>log10(abs(H)+eps)&#x2F;max(abs(H));<br>subplot(2,2,1),stem(n,hd);<br>axis([0,N,1.1</em>min(hd),1.1<em>max(hd)]);title(‘理想脉冲响应’);<br>xlabel(‘n’);ylabel(‘hd(n)’);<br>subplot(2,2,2);stem(n,windows);<br>axis([0,N,0,1.1]);title(‘窗函数特性’);<br>xlabel(‘n’);ylabel(‘wd(n)’);<br>subplot(2,2,3);stem(n,b);<br>axis([0,N,1.1</em>min(b),1.1*max(b)]);title(‘实际脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,4);plot(w&#x2F;pi,dbH);<br>axis([0,1,-80,10]);title(‘幅度频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘H(e^{j\omega})’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wc&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-50,-20,-3,0]);grid<br>程序运行结果如图11-2所示：</p>
<p>图11-2<br>例11-3 选择合适的窗函数设计一个FIR数字低通滤波器，要求：通带截止频率为ωp&#x3D;0.3 ，Rp&#x3D;0.05dB；阻带截止频率为ωs&#x3D;0.45 ，As&#x3D;50dB。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>分析：根据设计指标要求，并查表11-1，选择哈明窗。程序清单如下：<br>wp&#x3D;0.3<em>pi;ws&#x3D;0.45</em>pi;deltaw&#x3D;ws-wp;N0&#x3D;ceil(6.6<em>pi&#x2F;deltaw);<br>N&#x3D;N0+mod(N0+1,2) %为实现FIR类型1偶对称滤波器，应确保N为奇数<br>windows&#x3D;(hamming(N))’;wc&#x3D;(ws+wp)&#x2F;2;<br>hd&#x3D;ideal_lp(wc,N);b&#x3D;hd.<em>windows;<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);n&#x3D;0:N-1;dw&#x3D;2</em>pi&#x2F;1000;<br>Rp&#x3D;-(min(db(1:wp&#x2F;dw+1))) %检验通带波动<br>As&#x3D;-round(max(db(ws&#x2F;dw+1:501))) %检验最小阻带衰减<br>subplot(2,2,1);stem(n,b);axis([0,N,1.1</em>min(b),1.1*max(b)]);title(‘实际脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);subplot(2,2,2);stem(n,windows);<br>axis([0,N,0,1.1]);title(‘窗函数特性’);xlabel(‘n’);ylabel(‘wd(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);axis([0,1,-80,10]);title(‘幅度频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘H(e^{j\omega})’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wp&#x2F;pi,ws&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-50,-20,-3,0]);grid<br>subplot(2,2,4);plot(w&#x2F;pi,pha);axis([0,1,-4,4]);title(‘相位频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘\phi(\omega)’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wp&#x2F;pi,ws&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-3.1416,0,3.1416,4]);grid<br>程序运行结果如下：<br>N &#x3D;    45<br>Rp &#x3D;    0.0428<br>As &#x3D;    50<br>特性曲线如图11-3所示。</p>
<p>图11-3<br>例11-4 用MATLAB信号处理工具箱的fir1函数设计一个FIR数字低通滤波器，要求：通带截止频率为ωp&#x3D;0.3 ，Rp&#x3D;0.05dB；阻带截止频率为ωs&#x3D;0.45 ，As&#x3D;50dB。<br>程序清单如下：<br>wp&#x3D;0.3<em>pi;ws&#x3D;0.45</em>pi;<br>deltaw&#x3D;ws-wp;<br>N0&#x3D;ceil(6.6<em>pi&#x2F;deltaw);<br>N&#x3D;N0+mod(N0+1,2) %为实现FIR类型1偶对称滤波器，应确保N为奇数<br>windows&#x3D;hamming(N);%使用哈明窗，此句可省略<br>wc&#x3D;(ws+wp)&#x2F;2&#x2F;pi;%截止频率取归一化通阻带频率的平均值<br>b&#x3D;fir1(N-1,wc,windows);%用fir1函数求系统函数系数，windows可省略<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>n&#x3D;0:N-1;dw&#x3D;2</em>pi&#x2F;1000;<br>Rp&#x3D;-(min(db(1:wp&#x2F;dw+1))) %检验通带波动<br>As&#x3D;-round(max(db(ws&#x2F;dw+1:501))) %检验最小阻带衰减<br>其余部分与例11-3完全相同。<br>4、用窗函数法设计FIR数字高通滤波器<br>例11-5选择合适的窗函数设计一个FIR数字高通滤波器，要求：通带截止频率为ωp&#x3D;0.45 ，Rp&#x3D;0.5dB；阻带截止频率为ωs&#x3D;0.3 ，As&#x3D;20dB。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>分析：根据设计指标，查表11-1，应选择三角形窗。程序清单如下：<br>wp&#x3D;0.45<em>pi;ws&#x3D;0.3</em>pi;<br>deltaw&#x3D;wp-ws;<br>N0&#x3D;ceil(6.1<em>pi&#x2F;deltaw);<br>N&#x3D;N0+mod(N0+1,2) %为实现FIR类型1偶对称滤波器，应确保N为奇数<br>windows&#x3D;(triang(N))’;<br>wc&#x3D;(ws+wp)&#x2F;2;<br>hd&#x3D;ideal_lp(pi,N)-ideal_lp(wc,N);<br>b&#x3D;hd.<em>windows;<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>n&#x3D;0:N-1;dw&#x3D;2</em>pi&#x2F;1000;<br>Rp&#x3D;-(min(db(wp&#x2F;dw+1:501))) %检验通带波动<br>As&#x3D;-round(max(db(1:ws&#x2F;dw+1))) %检验最小阻带衰减<br>subplot(2,2,1);stem(n,b);<br>axis([0,N,1.1</em>min(b),1.1*max(b)]);title(‘实际脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,2);stem(n,windows);<br>axis([0,N,0,1.1]);title(‘窗函数特性’);<br>xlabel(‘n’);ylabel(‘wd(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);<br>axis([0,1,-40,2]);title(‘幅度频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘H(e^{j\omega})’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws&#x2F;pi,wp&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-20,-3,0]);grid<br>subplot(2,2,4);plot(w&#x2F;pi,pha);<br>axis([0,1,-4,4]);title(‘相位频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘\phi(\omega)’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws&#x2F;pi,wp&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>程序运行结果如下：<br>N &#x3D;    41<br>Rp &#x3D;    0.3625<br>As &#x3D;    25<br>特性曲线如图11-5所示：</p>
<p>图11-5<br>例11-6 用MATLAB信号处理工具箱提供的fir1函数设计一个FIR数字高通滤波器，要求：通带截止频率为fp&#x3D;450Hz，Rp&#x3D;0.5dB；阻带截止频率为fs&#x3D;300Hz，As&#x3D;20dB；采样频率Fs&#x3D;2000Hz。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>分析：根据设计指标选择三角形窗。程序清单如下：<br>fs&#x3D;300;fp&#x3D;450;Fs&#x3D;2000;<br>ws&#x3D;fs&#x2F;(Fs&#x2F;2)<em>pi;wp&#x3D;fp&#x2F;(Fs&#x2F;2)<em>pi;deltaw&#x3D;wp-ws;<br>N0&#x3D;ceil(6.1</em>pi&#x2F;deltaw);N&#x3D;N0+mod(N0+1,2)<br>windows&#x3D;triang(N);wc&#x3D;(ws+wp)&#x2F;2&#x2F;pi;<br>b&#x3D;fir1(N-1,wc,’high’,windows);<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>n&#x3D;0:N-1;dw&#x3D;2</em>pi&#x2F;1000;<br>Rp&#x3D;-(min(db(wp&#x2F;dw+1:501))) %检验通带波动<br>As&#x3D;-round(max(db(1:ws&#x2F;dw+1))) %检验最小阻带衰减<br>subplot(2,2,1);stem(n,b);<br>axis([0,N,1.1<em>min(b),1.1</em>max(b)]);<br>title(‘实际脉冲响应’);xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,2);stem(n,windows);<br>axis([0,N,0,1.1]);title(‘窗函数特性’);xlabel(‘n’);ylabel(‘wd(n)’);<br>subplot(2,2,3);plot(w&#x2F;2&#x2F;pi<em>Fs,db);<br>axis([0,Fs&#x2F;2,-40,2]);title(‘幅度频率响应’);<br>xlabel(‘f(Hz)’);ylabel(‘H(e^{j\omega})’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,fs,fp,Fs&#x2F;2]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-20,-3,0]);grid<br>subplot(2,2,4);plot(w&#x2F;2&#x2F;pi</em>Fs,pha);<br>axis([0,Fs&#x2F;2,-4,4]);title(‘相位频率响应’);<br>xlabel(‘f(Hz)’);ylabel(‘\phi(\omega)’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,fs,fp,Fs&#x2F;2]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>程序运行结果如下：<br>N &#x3D;    41<br>Rp &#x3D;    0.3625<br>As &#x3D;    25<br>特性曲线如图11-6所示：</p>
<p>图11-6<br>5、用窗函数法设计FIR带通数字滤波器<br>例11-7选择合适的窗函数设计一个FIR数字带通滤波器，要求：下阻带截止频率为ωs1&#x3D;0.2 ，As&#x3D;65dB；通带低端截止频率ωp1&#x3D;0.3 ，Rp&#x3D;0.05dB；通带高端截止频率ωp2&#x3D;0.7 ，Rp&#x3D;0.05dB；上阻带截止频率为ωs2&#x3D;0.8 ，As&#x3D;65dB。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>分析：根据设计指标应选择布莱克曼窗。程序清单如下：<br>wp1&#x3D;0.3<em>pi;wp2&#x3D;0.7</em>pi;<br>ws1&#x3D;0.2<em>pi;ws2&#x3D;0.8</em>pi;<br>wp&#x3D;[wp1,wp2];<br>ws&#x3D;[ws1,ws2];<br>deltaw&#x3D;wp1-ws1;<br>N0&#x3D;ceil(11<em>pi&#x2F;deltaw);<br>N&#x3D;N0+mod(N0+1,2) %为实现FIR类型1偶对称滤波器，应确保N为奇数<br>windows&#x3D;(blackman(N))’;<br>wc1&#x3D;(ws1+wp1)&#x2F;2;wc2&#x3D;(ws2+wp2)&#x2F;2;<br>hd&#x3D;ideal_lp(wc2,N)-ideal_lp(wc1,N);<br>b&#x3D;hd.<em>windows;<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>n&#x3D;0:N-1;dw&#x3D;2</em>pi&#x2F;1000;<br>Rp&#x3D;-(min(db(wp1&#x2F;dw+1:wp2&#x2F;dw+1))) %检验通带波动<br>ws0&#x3D;[1:ws1&#x2F;dw+1,ws2&#x2F;dw+1:501];%建立阻带频率样点数组<br>As&#x3D;-round(max(db(ws0))) %检验最小阻带衰减<br>subplot(2,2,1);stem(n,b);<br>axis([0,N,1.1</em>min(b),1.1*max(b)]);title(‘实际脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,2);stem(n,windows);<br>axis([0,N,0,1.1]);title(‘窗函数特性’);<br>xlabel(‘n’);ylabel(‘wd(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);<br>axis([0,1,-150,10]);title(‘幅度频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘H(e^{j\omega})’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws1&#x2F;pi,wp1&#x2F;pi,wp2&#x2F;pi,ws2&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-100,-65,-20,-3,0]);grid<br>subplot(2,2,4);plot(w&#x2F;pi,pha);<br>axis([0,1,-4,4]);title(‘相位频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘\phi(\omega)’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws1&#x2F;pi,wp1&#x2F;pi,wp2&#x2F;pi,ws2&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>程序运行结果如下：<br>N &#x3D;   111<br>Rp &#x3D;    0.0033<br>As &#x3D;    73<br>特性曲线如图11-7所示。<br>注意：带通滤波器的设计指标中，两边过渡带的宽度一般应该一致，deltaw可以由任意一边的带宽来确定。如果两边过渡带的宽度不一致。则应求两个过渡带中较小的一个作为设计依据（带阻滤波器的设计同此），此时，deltaw一句改为：<br>deltaw&#x3D;min((wp1-ws1),(ws2-wp2));<br>由程序运行结果可见，用布莱克曼窗设计的结果不仅满足指标要求，且具有很小的通带波动，很高的阻带衰减，过渡带很窄。</p>
<p>图11-7<br>例11-8 用MATLAB信号处理工具箱提供的fir1函数设计一个FIR数字带通滤波器，要求：下阻带截止频率为fs1&#x3D;100Hz，As&#x3D;65dB；通带低端截止频率fp1&#x3D;150 Hz，Rp&#x3D;0.05dB；通带高端截止频率fp2&#x3D;350Hz，Rp&#x3D;0.05dB；上阻带截止频率为fs2&#x3D;400Hz，As&#x3D;65dB；采样频率Fs&#x3D;1000Hz。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>程序清单如下：<br>fp1&#x3D;150;fp2&#x3D;350;<br>fs1&#x3D;100;fs2&#x3D;400;<br>Fs&#x3D;1000;<br>ws1&#x3D;fs1&#x2F;(Fs&#x2F;2)<em>pi;<br>ws2&#x3D;fs2&#x2F;(Fs&#x2F;2)<em>pi;<br>wp1&#x3D;fp1&#x2F;(Fs&#x2F;2)<em>pi;<br>wp2&#x3D;fp2&#x2F;(Fs&#x2F;2)<em>pi;<br>deltaw&#x3D;wp1-ws1;<br>N0&#x3D;ceil(11</em>pi&#x2F;deltaw);<br>N&#x3D;N0+mod(N0+1,2) %为实现FIR类型1偶对称滤波器，应确保N为奇数<br>windows&#x3D;blackman(N);<br>wc1&#x3D;(ws1+wp1)&#x2F;2&#x2F;pi;<br>wc2&#x3D;(ws2+wp2)&#x2F;2&#x2F;pi;<br>b&#x3D;fir1(N-1,[wc1,wc2],windows);<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>n&#x3D;0:N-1;dw&#x3D;2</em>pi&#x2F;1000;<br>Rp&#x3D;-(min(db(wp1&#x2F;dw+1:wp2&#x2F;dw+1))) %检验通带波动<br>ws0&#x3D;[1:ws1&#x2F;dw+1,ws2&#x2F;dw+1:501];%建立阻带频率样点数组<br>As&#x3D;-round(max(db(ws0))) %检验最小阻带衰减<br>subplot(2,2,1);stem(n,b);<br>axis([0,N,1.1</em>min(b),1.1</em>max(b)]);title(‘实际脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,2);stem(n,windows);<br>axis([0,N,0,1.1]);title(‘窗函数特性’);<br>xlabel(‘n’);ylabel(‘wd(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);<br>axis([0,1,-150,10]);title(‘幅度频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘H(e^{j\omega})’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,fs1,fp1,fp2,fs2,500]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-150,-40,-3,0]);grid<br>subplot(2,2,4);plot(w&#x2F;pi,pha);<br>axis([0,1,-4,4]);title(‘相位频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘\phi(\omega)’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,fs1,fp1,fp2,fs2,500]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>程序运行结果如下：<br>N &#x3D;   111<br>Rp &#x3D;    0.0033<br>As &#x3D;    73<br>特性曲线如图11-8所示：</p>
<p>图11-8<br>6、窗函数法设计FIR数字带阻滤波器<br>例11-9选择合适的窗函数设计一个FIR数字带阻滤波器，要求：下通带截止频率为wp1&#x3D;0.2 ，Rp&#x3D;0.1dB；阻带低端截止频率ws1&#x3D;0.3 ，As&#x3D;40dB；阻带高端截止频率ws2&#x3D;0.7 ，As&#x3D;40dB；上通带截止频率为wp2&#x3D;0.8 ，Rp&#x3D;0.1dB。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>分析：根据设计指标选择汉宁窗。程序清单如下：<br>wp1&#x3D;0.2<em>pi;wp2&#x3D;0.8</em>pi;<br>ws1&#x3D;0.3<em>pi;ws2&#x3D;0.7</em>pi;<br>wp&#x3D;[wp1,wp2];ws&#x3D;[ws1,ws2];<br>deltaw&#x3D;ws1-wp1;<br>N0&#x3D;ceil(6.2<em>pi&#x2F;deltaw);N&#x3D;N0+mod(N0+1,2)<br>windows&#x3D;(hanning(N))’;<br>wc1&#x3D;(ws1+wp1)&#x2F;2;wc2&#x3D;(ws2+wp2)&#x2F;2;<br>hd&#x3D;ideal_lp(wc1,N)+ideal_lp(pi,N)-ideal_lp(wc2,N);%建立理想带阻<br>b&#x3D;hd.<em>windows;<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>n&#x3D;0:N-1;dw&#x3D;2</em>pi&#x2F;1000;<br>wp0&#x3D;[1:wp1&#x2F;dw+1,wp2&#x2F;dw+1:501];%建立通带频率样点数组<br>As&#x3D;-round(max(db(ws1&#x2F;dw+1:ws2&#x2F;dw+1))) %检验最小阻带衰减<br>Rp&#x3D;-(min(db(wp0))) %检验通带波动<br>subplot(2,2,1);stem(n,b);axis([0,N,1.1</em>min(b),1.1*max(b)]);<br>title(‘实际脉冲响应’);xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,2);stem(n,windows);<br>axis([0,N,0,1.1]);title(‘窗函数特性’);xlabel(‘n’);ylabel(‘wd(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);axis([0,1,-150,10]);<br>title(‘幅度频率响应’);xlabel(‘频率（单位：\pi）’);ylabel(‘H(e^{j\omega})’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wp1&#x2F;pi,ws1&#x2F;pi,ws2&#x2F;pi,wp2&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-150,-40,-3,0]);grid<br>subplot(2,2,4);plot(w&#x2F;pi,pha);axis([0,1,-4,4]);<br>title(‘相位频率响应’);xlabel(‘频率（单位：\pi）’);ylabel(‘\phi(\omega)’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wp1&#x2F;pi,ws1&#x2F;pi,ws2&#x2F;pi,wp2&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>程序运行结果如下：<br>N &#x3D;    63<br>As &#x3D;    44<br>Rp &#x3D;    0.0887<br>特性曲线如图11-9所示：</p>
<p>图11-9<br>例11-10 用凯塞窗设计一个长度为75的FIR数字滤波器，要求：下通带截止频率为ωp1&#x3D;0.2 ，Rp&#x3D;0.1dB；阻带低端截止频率ωs1&#x3D;0.3 ，As&#x3D;60dB；阻带高端截止频率ωs2&#x3D;0.7 ，As&#x3D;60dB；上通带截止频率为ωp2&#x3D;0.8 ，Rp&#x3D;0.1dB。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>分析：凯塞窗参数β&#x3D;0.112×(As-8.7)。用fir1函数进行设计。程序清单如下：<br>N&#x3D;75;As&#x3D;60;<br>wp1&#x3D;0.2<em>pi;wp2&#x3D;0.8</em>pi;<br>ws1&#x3D;0.3<em>pi;ws2&#x3D;0.7</em>pi;<br>beta&#x3D;0.112*(As-8.7)<br>windows&#x3D;kaiser(N,beta);<br>wc1&#x3D;(ws1+wp1)&#x2F;2&#x2F;pi;wc2&#x3D;(ws2+wp2)&#x2F;2&#x2F;pi;<br>b&#x3D;fir1(N-1,[wc1,wc2],’stop’,windows);<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>n&#x3D;0:N-1;dw&#x3D;2<em>pi&#x2F;1000;<br>wp0&#x3D;[1:wp1&#x2F;dw+1,wp2&#x2F;dw+1:501];%建立通带频率样点数组<br>As&#x3D;-round(max(db(ws1&#x2F;dw+1:ws2&#x2F;dw+1))) %检验最小阻带衰减<br>Rp&#x3D;-(min(db(wp0))) %检验通带波动<br>subplot(2,2,1);stem(n,b);<br>axis([0,N,1.1</em>min(b),1.1*max(b)]);title(‘实际脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,2);stem(n,windows);<br>axis([0,N,0,1.1]);title(‘窗函数特性’);<br>xlabel(‘n’);ylabel(‘wd(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);<br>axis([0,1,-150,10]);title(‘幅度频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘H(e^{j\omega})’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wp1&#x2F;pi,ws1&#x2F;pi,ws2&#x2F;pi,wp2&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-150,-40,-3,0]);grid<br>subplot(2,2,4);plot(w&#x2F;pi,pha);<br>axis([0,1,-4,4]);title(‘相位频率响应’);<br>xlabel(‘频率（单位：\pi）’);ylabel(‘\phi(\omega)’);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wp1&#x2F;pi,ws1&#x2F;pi,ws2&#x2F;pi,wp2&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>程序运行结果如下：<br>beta &#x3D;    5.7456<br>As &#x3D;    61<br>Rp &#x3D;    0.0144<br>特性曲线如图11-10所示：</p>
<p>图11-10<br>注意：如果不满足设计指标要求，可适当增加凯塞窗的长度。<br>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据和图形，结合基本原理理解每一条语句的含义。<br>2、选择合适的窗函数设计FIR数字低通滤波器，要求：ωp&#x3D;0.2 ，Rp&#x3D;0.05dB；ωs&#x3D;0.3 ，As&#x3D;40dB。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>3、用凯塞窗设计一个FIR数字高通滤波器，要求：ωp&#x3D;0.3 ，Rp&#x3D;0.1dB；ωs&#x3D;0.2 ，As&#x3D;50dB。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>4、选择合适的窗函数设计一个FIR数字带通滤波器，要求：fp1&#x3D;3.5kHz，fp2&#x3D;6.5kHz，Rp&#x3D;0.05dB；fs1&#x3D;2.5kHz，fs2&#x3D;7.5kHz，As&#x3D;60dB。滤波器采样频率Fs&#x3D;20kHz。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>5、选择合适的窗函数设计一个FIR数字带阻滤波器，要求：fp1&#x3D;1kHz，fp2&#x3D;4.5kHz，Rp&#x3D;0.1dB；fs1&#x3D;2kHz，fs2&#x3D;3.5kHz，As&#x3D;40dB。滤波器采样频率Fs&#x3D;10kHz。描绘该滤波器的脉冲响应、窗函数及滤波器的幅频响应曲线和相频响应曲线。<br>四、实验预习：<br>1、认真阅读实验原理。明确本次实验任务，读懂例题程序，了解实验方法。<br>2、根据实验任务预先编写实验程序。<br>3、预习思考题：列写用窗函数法设计FIR数字滤波器的基本方法，并写出不同方法设计低通、高通、带通、带阻滤波器的主要程序语句。<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、列出本实验提出的有关MATLAB函数在调用时应注意的问题。<br>    3、给出预习思考题答案。</p>
<h1 id="实验12-用MATLAB设计FIR数字滤波器（三）"><a href="#实验12-用MATLAB设计FIR数字滤波器（三）" class="headerlink" title="实验12  用MATLAB设计FIR数字滤波器（三）"></a>实验12  用MATLAB设计FIR数字滤波器（三）</h1><p>一、实验目的：<br>1、加深对频率采样法设计FIR数字滤波器的基本原理的理解。<br>2、掌握在频域优化设计FIR数字滤波器的方法。<br>3、学习使用fir2函数设计FIR数字滤波器。<br>二、实验原理：<br>1、频率采样法的基本原理<br>设计滤波器时，通常给出的是幅频特性的技术指标，可直接在频域进行处理，按照理想的频率特性H(ejω)，在ω&#x3D;0到2π之间等间隔采样N点，得到：<br>    k&#x3D;0,1,2，…，N-1<br>然后用H(k)的傅里叶逆变换作为滤波器的系数：<br>b(n)&#x3D;h(n)&#x3D;IDFT[H(k)]<br>构成一个系统传递函数为 的实际的FIR数字滤波器，这种设计方法称为频率采样法。其中H(z)与H(k)的关系符合内插公式，即</p>
<p>使用频率采样法设计FIR数字滤波器时，应注意以下问题：<br>（1）根据频域抽样定理，被采样的理想频率特性其采样点数N与滤波器的长度M应满足N≥M，否则将造成混叠。本实验取N&#x3D;M。<br>（2）为保证滤波器的系数为实序列，作为复数序列的理想频率特性应具有共轭对称性，幅度特性应为偶函数，相位特性应为奇函数。注意：必须在0<del>2π的全频段上才能观察到其对称图形。习惯上，我们一般利用其对称性，只作0</del>π频段上的图形。<br>（3）理想频率特性的相位特性应该与频率成线性关系，即满足线性相位的条件。<br>由于第一类线性相位滤波器能进行低通、高通、带通、带阻滤波器的设计，因此本实验所有滤波器均采用第一类线性相位滤波器，即在时域脉冲响应满足h(n)&#x3D;h(N-n-1)，N为奇数。如果在频域用H(k)&#x3D;A(k)ejθ(k)表示对理想频率特性的等间隔采样，则有：<br>线性相位条件<br>符幅特性条件        A(k)＝A(N-k-1)<br>同理，对于第二、三、四类线性相位滤波器，读者可自行找出线性相位条件和符幅特性对称条件，进行滤波器设计。<br>2、频率采样法设计数字滤波器的方法及采样点数对滤波器特性的影响<br>例12-1 用频率采样法设计一个FIR数字低通滤波器，3dB截止频率ωc&#x3D;0.4π，采样点数分别取N&#x3D;21和N&#x3D;61，分别显示幅频特性和脉冲响应曲线，观察采样点数对滤波器特性的影响。<br>观察0<del>2π频段上理想的频率特性，程序清单如下：<br>N&#x3D;21;n&#x3D;0:N-1;wc&#x3D;0.4<em>pi;<br>N1&#x3D;fix(wc&#x2F;(2</em>pi&#x2F;N));     %样点间隔为2<em>pi&#x2F;N，N1为wc的样点数<br>N2&#x3D;N-2</em>N1-1;          %N2为阻带样点数<br>A&#x3D;[ones(1,N1+1),zeros(1,N2),ones(1,N1)];   %建立符幅特性样本序列<br>theta&#x3D;-pi*(N-1)&#x2F;N*[0:N-1];                %建立相位特性样本序列<br>wa&#x3D;[0:N-1]&#x2F;N*2;       %为作图建立对应的频率向量subplot(2,1,1);plot(wa,A,’.-‘);<br>axis([0,2,-0.1,1.2]);title(‘理想幅频响应及样点序列’)<br>xlabel(‘频率（单位\pi）’);ylabel(‘H(e^(j\omega))’);<br>subplot(2,1,2);plot(wa,theta,’.-‘);<br>axis([0,2,-90,1]);title(‘理想相频响应及样点序列’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘\phi(\omega)’);<br>理想的频响特性曲线如图12-1所示。由图可见，该滤波器特性符合幅度特性为偶函数，相位特性为奇函数的特点。以下例题的频率特性不再在全频段显示，仅在0</del>π频段上显示。</p>
<p>图12-1<br>将理想的和实际的频响特性在同一图形中显示，同时显示脉冲响应曲线，观察采样点数对滤波器特性的影响，程序清单如下：<br>N&#x3D;input(‘N&#x3D;’);n&#x3D;0:N-1;wc&#x3D;0.4<em>pi;<br>N1&#x3D;fix(wc&#x2F;(2</em>pi&#x2F;N));%样点间隔为2<em>pi&#x2F;N，N1为wc的样点数<br>N2&#x3D;N-2</em>N1-1;        %N2为阻带样点数<br>A&#x3D;[ones(1,N1+1),zeros(1,N2),ones(1,N1)];%建立符幅特性样本序列<br>theta&#x3D;-pi*(N-1)&#x2F;N*[0:N-1];              %建立相位特性样本序列<br>Hk&#x3D;A.<em>exp(j</em>theta);                     %建立频率特性样本序列<br>h&#x3D;real(ifft(Hk));  %由反变换求脉冲序列，去掉运算误差造成的虚部<br>[db,mag,pha,grd,w]&#x3D;freqz_m(h,1); %由脉冲序列求得频率特性<br>dw&#x3D;2<em>pi&#x2F;1000; %dw为频率分辨率，将0~2π分1000份<br>Rp&#x3D;-(min(db(1:fix(wc&#x2F;dw)+1))) %检验通带波动<br>ws&#x3D;wc+2</em>pi&#x2F;N; %确定ws的位置，比wc右移2*pi&#x2F;N<br>As&#x3D;-round(max(db(fix(ws&#x2F;dw)+1:501))) %检验最小阻带衰减<br>m&#x3D;(N-1)&#x2F;2;wa&#x3D;[0:m-1]&#x2F;m; %为作图求0~π的样点数，建立对应的频率向量<br>subplot(2,1,1);plot(wa,A(1:m),’.-‘,w&#x2F;pi,mag);<br>axis([0,1,-0.1,1.2]);title(‘理想幅频响应、样点序列及实际滤波器幅频响应’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘H(e^(j\omega))’);<br>subplot(2,1,2);stem(n,h);title(‘滤波器脉冲响应’);xlabel(‘n’);ylabel(‘h(n)’);<br>当N&#x3D;21时，程序运行结果如下：<br>Rp &#x3D;    2.4223<br>As &#x3D;    17</p>
<p>图12-2<br>当N&#x3D;61时，程序运行结果如下：<br>Rp &#x3D;    2.6389<br>As &#x3D;    18</p>
<p>图12-3<br>由图12-2可见，理想的幅频特性采样21点得到一个时域满足h(n)&#x3D;h(N-n-1)，N为奇数的脉冲响应曲线。由脉冲序列再求其实际的幅频特性，得到一个带有波动的幅频响应曲线，叠加在理想的幅频特性上。由图12-3可见，N&#x3D;61时实际的幅频特性更接近理想幅频特性，过渡带更窄，但是间断点因吉布斯效应产生的通带波动更剧烈。Rp由N&#x3D;21时的2.4223增至2.6389；阻带最小衰减在N增大时没有明显提高，仅从N&#x3D;21时的17dB增至18dB。<br>3、频率采样法的优化设计<br>为了提高阻带衰减，减小通带波动，可以采用频率采样的优化设计法，即在频响间断点区间内插一个或几个过渡采样点。<br>例12-2 在例12-1给定的设计要求下，在过渡带中增加一个样点T1，取值0.38。要求显示其幅频特性曲线，观察增加过渡采样点后对滤波器特性的影响。<br>程序清单如下：<br>N&#x3D;input(‘N&#x3D;’);<br>n&#x3D;0:N-1;<br>wc&#x3D;0.4<em>pi;T1&#x3D;0.38;<br>N1&#x3D;fix(wc&#x2F;(2</em>pi&#x2F;N));%样点间隔为2<em>pi&#x2F;N，N1为wc的样点数<br>N2&#x3D;N-2</em>N1-1;        %N2为阻带样点数<br>A&#x3D;[ones(1,N1+1),T1,zeros(1,N2),T1,ones(1,N1)];%建立符幅特性样本序列<br>N&#x3D;N+2;<br>theta&#x3D;-pi*(N-1)&#x2F;N*[0:N-1];              %建立相位特性样本序列<br>Hk&#x3D;A.<em>exp(j</em>theta);                     %建立频率特性样本序列<br>h&#x3D;real(ifft(Hk));  %由反变换求脉冲序列，去掉运算误差造成的虚部<br>[db,mag,pha,grd,w]&#x3D;freqz_m(h,1); %由脉冲序列求得频率特性<br>dw&#x3D;2<em>pi&#x2F;1000; %dw为频率分辨率，将0~2π分1000份<br>wp&#x3D;2</em>pi&#x2F;N<em>fix(wc&#x2F;(2</em>pi&#x2F;N)-1);    %确定wp的位置<br>Rp&#x3D;-(min(db(1:fix(wp&#x2F;dw)+1)))    %检验通带波动<br>ws&#x3D;wp+3<em>2</em>pi&#x2F;N;               %确定ws的位置<br>As&#x3D;-round(max(db(fix(ws&#x2F;dw)+1:501))) %检验最小阻带衰减<br>m&#x3D;(N-1)&#x2F;2;<br>wa&#x3D;[0:m-1]&#x2F;m; %为作图求0~π的样点数，建立对应的频率向量<br>subplot(2,1,1);plot(wa,A(1:m),’.-‘,w&#x2F;pi,mag);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wp&#x2F;pi,wc&#x2F;pi,ws&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,0.38,1]);grid<br>axis([0,1,-0.1,1.2]);<br>title(‘理想幅频响应、样点序列及实际滤波器幅频响应’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘H(e^(j\omega))’);<br>subplot(2,1,2);plot(w&#x2F;pi,db);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,wp&#x2F;pi,wc&#x2F;pi,ws&#x2F;pi,11]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-60,-40,-20,0]);grid<br>axis([0,1,-90,2]);<br>title(‘实际滤波器幅频响应(dB)’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘G(dB)’);<br>N&#x3D;21时，Rp&#x3D;0.6281，As &#x3D;40，滤波器幅频特性曲线如图12-4所示。<br>N&#x3D;61时，Rp&#x3D;0.7032，As &#x3D;44，滤波器幅频特性曲线如图12-5所示。<br>由图可见，在过渡带增加了一点之后，通带波动迅速减小，阻带衰减也得到了很大提高。<br>若在过渡带中增加两个采样点T1&#x3D;0.5886，T2&#x3D;0.1065，当N&#x3D;21时，Rp&#x3D;0.3000，As&#x3D;63，特性曲线如图12-6所示。由图可见在过渡带增加了两个采样点后，通带波动明显下降，阻带衰减明显提高，用较少的采样点已经能够实现较高的滤波性能要求。若在此基础上，将采样点数增至N&#x3D;61，则Rp&#x3D;0.3186，As&#x3D;66，滤波器特性曲线如图12-7所示。过渡带宽度明显减小，非常适合设计窄带滤波器。</p>
<p>图12-4</p>
<p>图12-5</p>
<p>图12-6</p>
<p>图12-7<br>4、频率采样法设计举例<br>使用频率采样法设计滤波器的最大优点是可以直接从频率域进行设计，缺点是通阻带边界频率不易控制，尤其是带通和带阻滤波器，通阻带边界频率常常会发生较大的偏离。提高采样点数可以适当改善这一状况，但需要进行试凑才能确定样本点。下面分别举例说明高通、带通和带阻滤波器的设计方法。<br>例12-3 用频率采样法设计一个FIR数字高通滤波器，要求：3dB截止频率ωc&#x3D;0.55π，通带最大波动Rp&#x3D;0.5dB，阻带最小衰减As&#x3D;60dB。描绘实际滤波器的脉冲响应、幅频响应和相频响应曲线，并检验通阻带衰减指标。<br>程序清单如下：<br>N&#x3D;29;T1&#x3D;0.5886;T2&#x3D;0.1065;<br>n&#x3D;0:N-1;wc&#x3D;0.55<em>pi;<br>N1&#x3D;fix(wc&#x2F;(2</em>pi&#x2F;N));%样点间隔为2<em>pi&#x2F;N，N1为wc的样点数<br>N2&#x3D;N-2</em>N1-1;        %N2为阻带样点数<br>A&#x3D;[zeros(1,N1+1),T2,T1,ones(1,N2),T1,T2,zeros(1,N1)];%建立符幅特性样本序列<br>N&#x3D;N+4;<br>theta&#x3D;-pi*(N-1)&#x2F;N*[0:N-1];              %建立相位特性样本序列<br>Hk&#x3D;A.<em>exp(j</em>theta);                     %建立频率特性样本序列<br>h&#x3D;real(ifft(Hk));  %由反变换求脉冲序列，去掉运算误差造成的虚部<br>[db,mag,pha,grd,w]&#x3D;freqz_m(h,1); %由脉冲序列求得频率特性<br>dw&#x3D;2<em>pi&#x2F;1000; %dw为频率分辨率，将0~2π分1000份<br>ws&#x3D;2</em>pi&#x2F;N<em>fix(wc&#x2F;(2</em>pi&#x2F;N)-2); %确定wp的位置<br>As&#x3D;-round(max(db(1:fix(ws&#x2F;dw)+1))) %检验通带波动<br>wp&#x3D;ws+3<em>2</em>pi&#x2F;N;               %确定ws的位置<br>Rp&#x3D;-(min(db(fix(wp&#x2F;dw)+1:501))) %检验最小阻带衰减<br>m&#x3D;(N-1)&#x2F;2;wa&#x3D;[0:m-1]&#x2F;m; %为作图求0~π的样点数，建立对应的频率向量<br>subplot(2,2,1);plot(wa,A(1:m),’.-‘,w&#x2F;pi,mag);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws&#x2F;pi,wp&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,T2,T1,1]);grid<br>axis([0,1,-0.1,1.2]);title(‘理想幅频响应、样点序列及实际滤波器幅频响应’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘H(e^(j\omega))’);<br>n&#x3D;0:N-1;<br>subplot(2,2,2);stem(n,h);axis([0,35,-0.4,0.6]);<br>title(‘滤波器脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws&#x2F;pi,wp&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-55,-20,0]);grid<br>axis([0,1,-100,2]);title(‘实际滤波器幅频响应(dB)’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘G(dB)’);<br>subplot(2,2,4);plot(w&#x2F;pi,pha);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,ws&#x2F;pi,wp&#x2F;pi,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>axis([0,1,-4,4]);title(‘实际滤波器相频响应(dB)’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘\phi(\omega)’);<br>程序运行结果为：As &#x3D;59    Rp &#x3D; 0.3361<br>特性曲线如图12-8所示：</p>
<p>图12-8<br>例12-4 用频率采样法设计一个FIR数字带通滤波器，要求：下通带截止频率为ωp1&#x3D;0.45 ，阻带低端截止频率ωs1&#x3D;0.3 ，阻带高端截止频率ωs2&#x3D;0.8 ，上通带截止频率为ωp2&#x3D;0.65 ，Rp&#x3D;0.5dB，As&#x3D;40dB。描绘实际滤波器的脉冲响应、理想及实际滤波器幅频响应曲线和相频响应曲线。<br>程序清单如下：<br>N&#x3D;41;T1&#x3D;0.5941;T2&#x3D;0.109;n&#x3D;0:N-1;ws1&#x3D;0.3<em>pi;ws2&#x3D;0.8</em>pi;wp1&#x3D;0.45<em>pi;wp2&#x3D;0.65</em>pi;<br>N1&#x3D;round((wp2-wp1)&#x2F;(2<em>pi&#x2F;N));%样点间隔为2</em>pi&#x2F;N，N1为通带样点数<br>N1&#x3D;N1+mod(N1+1,2);  %使N1为奇数<br>N2&#x3D;round((N-2<em>N1-9)&#x2F;4);N2&#x3D;N2+mod(N2+1,2);        %N2为阻带样点数<br>N3&#x3D;N-2</em>N2-2<em>N1-8;<br>%建立符幅特性样本序列<br>A&#x3D;[zeros(1,N2),T2,T1,ones(1,N1),T1,T2,zeros(1,N3),T2,T1,ones(1,N1),T1,T2,zeros(1,N2),];<br>theta&#x3D;-pi</em>(N-1)&#x2F;N*[0:N-1];              %建立相位特性样本序列<br>Hk&#x3D;A.<em>exp(j</em>theta);                     %建立频率特性样本序列<br>h&#x3D;real(ifft(Hk));  %由反变换求脉冲序列，去掉运算误差造成的虚部<br>[db,mag,pha,grd,w]&#x3D;freqz_m(h,1); %由脉冲序列求得频率特性<br>m&#x3D;(N-1)&#x2F;2;wa&#x3D;[0:m-1]&#x2F;m; %为作图求0~π的样点数，建立对应的频率向量<br>subplot(2,2,1);plot(wa,A(1:m),’.-‘,w&#x2F;pi,mag);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.3,0.45,0.65,0.8,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,T2,T1,1]);grid<br>axis([0,1,-0.1,1.2]);title(‘理想幅频响应、样点序列及实际滤波器幅频响应’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘H(e^(j\omega))’);<br>…<br>程序运行结果如图12-9所示：</p>
<p>图12-9<br>例12-5用频率采样法设计一个FIR数字带阻滤波器，要求：下通带截止频率为wp1&#x3D;0.35 ，Rp&#x3D;0.5dB；阻带低端截止频率ws1&#x3D;0.5 ，As&#x3D;40dB；阻带高端截止频率ws2&#x3D;0.6 ，As&#x3D;40dB；上通带截止频率为wp2&#x3D;0.75 ，Rp&#x3D;0.5dB。描绘实际滤波器的脉冲响应、理想及实际滤波器幅频响应曲线和相频响应曲线。<br>程序清单如下：<br>N&#x3D;41;T1&#x3D;0.5941;T2&#x3D;0.109;<br>n&#x3D;0:N-1;ws1&#x3D;0.4<em>pi;ws2&#x3D;0.6</em>pi;<br>wp1&#x3D;0.25<em>pi;wp2&#x3D;0.75</em>pi;<br>N1&#x3D;fix((ws2-ws1)&#x2F;(2<em>pi&#x2F;N));%样点间隔为2</em>pi&#x2F;N，N1为阻带样点数<br>N1&#x3D;N1+mod(N1+1,2);  %使N1为奇数<br>N2&#x3D;round((N-2<em>N1-8)&#x2F;4); %N2为通带样点数<br>N3&#x3D;N-2</em>N2-2<em>N1-8;<br>%建立符幅特性样本序列<br>A&#x3D;[ones(1,N2),T1,T2,zeros(1,N1),T2,T1,ones(1,N3),T1,T2,zeros(1,N1),T2,T1,ones(1,N2)];<br>theta&#x3D;-pi</em>(N-1)&#x2F;N*[0:N-1];              %建立相位特性样本序列<br>Hk&#x3D;A.<em>exp(j</em>theta);                     %建立频率特性样本序列<br>h&#x3D;real(ifft(Hk));  %由反变换求脉冲序列，去掉运算误差造成的虚部<br>[db,mag,pha,grd,w]&#x3D;freqz_m(h,1); %由脉冲序列求得频率特性<br>m&#x3D;(N-1)&#x2F;2;wa&#x3D;[0:m-1]&#x2F;m; %为作图求0~π的样点数，建立对应的频率向量<br>subplot(2,2,1);plot(wa,A(1:m),’.-‘,w&#x2F;pi,mag);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,0.6,0.75,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,T2,T1,1]);grid<br>axis([0,1,-0.1,1.2]);title(‘理想幅频响应、样点序列及实际滤波器幅频响应’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘H(e^(j\omega))’);<br>subplot(2,2,2);stem(n,h);axis([0,42,-0.2,0.8]);<br>title(‘滤波器脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,db);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,0.6,0.75,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-40,-20,0]);grid<br>axis([0,1,-100,2]);title(‘实际滤波器幅频响应(dB)’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘G(dB)’);<br>subplot(2,2,4);plot(w&#x2F;pi,pha);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.25,0.4,0.6,0.75,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>axis([0,1,-4,4]);title(‘实际滤波器相频响应(dB)’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘\phi(\omega)’);<br>程序运行结果如图12-10所示：</p>
<p>图12-10<br>5、用fir2函数设计FIR数字滤波器<br>函数fir2基于频率样本法和窗函数法综合设计FIR数字滤波器。利用该函数可以很方便地由理想滤波器频率特性设计实际的FIR数字滤波器，避免了频率采样法确定采样点时需试凑的麻烦。<br>例12-6 用fir2设计一个N&#x3D;41的FIR高通数字滤波器，要求通带截止频率ωc&#x3D;0.5π，描绘理想和实际滤波器的幅频响应曲线。<br>程序清单如下：<br>wc&#x3D;0.5;N&#x3D;41;<br>n&#x3D;0:N-1;<br>f&#x3D;[0,wc,wc,1]; %建立理想幅频特性频率向量<br>m&#x3D;[0,0,1,1];   %建立理想幅频特性幅度向量<br>b&#x3D;fir2(N-1,f,m);<br>[H,w]&#x3D;freqz(b,1);<br>dbH&#x3D;20<em>log10((abs(H)+eps)&#x2F;max(abs(H)));<br>subplot(2,2,1);axis([0,1,-0.1,1.1]);<br>title(‘理想和实际滤波器幅频响应’);<br>plot(f,m,w&#x2F;pi,abs(H));<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.5,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[0,0.5,0.707,1]);grid<br>xlabel(‘频率（单位\pi）’);ylabel(‘H(e^(j\omega))’);<br>subplot(2,2,2);stem(n,b);<br>axis([0,42,-0.4,0.6]);<br>title(‘滤波器脉冲响应’);<br>xlabel(‘n’);ylabel(‘h(n)’);<br>subplot(2,2,3);plot(w&#x2F;pi,dbH);<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.5,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-60,-40,-20,-3]);grid<br>axis([0,1,-110,2]);<br>title(‘实际滤波器幅频响应(dB)’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘G(dB)’);<br>subplot(2,2,4);plot(w&#x2F;pi,angle(H));<br>set(gca,’XTickMode’,’manual’,’XTick’,[0,0.5,1]);<br>set(gca,’YTickMode’,’manual’,’YTick’,[-pi,0,pi]);grid<br>axis([0,1,-4,4]);<br>title(‘实际滤波器相频响应’);<br>xlabel(‘频率（单位\pi）’);ylabel(‘\phi(\omega)’);<br>本例的fir2函数缺windows项，使用了默认的hamming窗。由图可见该滤波器幅频特性在阻带的最小衰减约为60dB，但通带截止频率不够明确。如果将设计指标改为阻带截止频率ωs&#x3D;0.4π，通带截止频率ωp&#x3D;0.55π，程序清单如下：<br>ws&#x3D;0.4;wp&#x3D;0.55;N&#x3D;61;n&#x3D;0:N-1;<br>wc&#x3D;(wp+ws)&#x2F;2;<br>f&#x3D;[0,wc,wc,1]; %建立理想幅频特性频率向量<br>m&#x3D;[0,0,1,1];   %建立理想幅频特性幅度向量<br>b&#x3D;fir2(N-1,f,m);<br>[H,w]&#x3D;freqz(b,1);<br>dbH&#x3D;20</em>log10((abs(H)+eps)&#x2F;max(abs(H)));<br>dw&#x3D;2<em>pi&#x2F;1000;<br>Rp&#x3D;-(min(dbH(wp</em>pi&#x2F;dw+1:501)))<br>As&#x3D;-round(max(dbH(1:ws*pi&#x2F;dw+1)))<br>作图部分省略。程序运行结果如下：<br>Rp &#x3D;    0.0408<br>As &#x3D;    58<br>特性曲线如图12-12所示：</p>
<p>图12-11</p>
<p>图12-12<br>例12-7 用fir2函数设计一个N&#x3D;61的FIR数字带阻滤波器，要求：通带低端截止频率ωc1&#x3D;0.4π，通带高端截止频率ωc2&#x3D;0.6π，描绘理想和实际滤波器的幅频响应曲线。<br>程序清单如下：<br>wc1&#x3D;0.4;wc2&#x3D;0.6;<br>N&#x3D;61;n&#x3D;0:N-1;<br>f&#x3D;[0,wc1,wc1,wc2,wc2,1]; %建立理想幅频特性频率向量<br>m&#x3D;[1,1,0,0,1,1];   %建立理想幅频特性幅度向量<br>windows&#x3D;boxcar(N);<br>b&#x3D;fir2(N-1,f,m,windows);<br>[H,w]&#x3D;freqz(b,1);<br>dbH&#x3D;20*log10((abs(H)+eps)&#x2F;max(abs(H)));<br>作图部分参考例12-6。特性曲线如图12-13所示。由图可见，该滤波器阻带衰减较小。</p>
<p>图12-13<br>如果将设计指标改为下通带截止频率ωp1&#x3D;0.3π，阻带低端截止频率ωs1&#x3D;0.4π，阻带高端截止频率ωs2&#x3D;0.6π，上通带截止频率ωp2&#x3D;0.7π，且在过渡带增加一点T1&#x3D;0.38，程序清单如下：<br>wp1&#x3D;0.3;ws1&#x3D;0.4;ws2&#x3D;0.6;wp2&#x3D;0.7;<br>N&#x3D;61;n&#x3D;0:N-1;T1&#x3D;0.38;<br>wc1&#x3D;(ws1+wp1)&#x2F;2;wc2&#x3D;(ws2+wp2)&#x2F;2;<br>f&#x3D;[0,wp1,wc1,ws1,ws2,wc2,wp2,1]; %建立理想幅频特性频率向量<br>m&#x3D;[1,1,T1,0,0,T1,1,1];   %建立理想幅频特性幅度向量<br>windows&#x3D;boxcar(N);<br>b&#x3D;fir2(N-1,f,m,windows);<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>dw&#x3D;2<em>pi&#x2F;1000;<br>wp0&#x3D;[1:wp1</em>pi&#x2F;dw+1,wp2<em>pi&#x2F;dw+1:501];%建立通带频率样点数组<br>Rp&#x3D;-(min(db(wp0)))<br>ws0&#x3D;[ws1</em>pi&#x2F;dw+1:ws2*pi&#x2F;dw+1];%建立阻带频率样点数组<br>As&#x3D;-round(max(db(ws0)))<br>程序运行结果为Rp&#x3D;0.5592，As&#x3D;31，阻带衰减有所提高。特性曲线如图12-14所示：</p>
<p>图12-14<br>若在过渡带增加两点T1&#x3D;0.5941，T2&#x3D;0.109，程序清单如下：<br>wp1&#x3D;0.3;ws1&#x3D;0.4;ws2&#x3D;0.6;wp2&#x3D;0.7;<br>N&#x3D;61;n&#x3D;0:N-1;T1&#x3D;0.5941;T2&#x3D;0.109;<br>wc1&#x3D;(ws1+wp1)&#x2F;2;wc2&#x3D;(wc1+ws1)&#x2F;2;<br>wc3&#x3D;(ws2+wp2)&#x2F;2;wc4&#x3D;(wc3+ws2)&#x2F;2;<br>f&#x3D;[0,wp1,wc1,wc2,ws1,ws2,wc4,wc3,wp2,1]; %建立理想幅频特性频率向量<br>m&#x3D;[1,1,T1,T2,0,0,T2,T1,1,1];   %建立理想幅频特性幅度向量<br>windows&#x3D;boxcar(N);<br>b&#x3D;fir2(N-1,f,m,windows);<br>[db,mag,pha,grd,w]&#x3D;freqz_m(b,1);<br>dw&#x3D;2<em>pi&#x2F;1000;<br>wp0&#x3D;[1:wp1</em>pi&#x2F;dw+1,wp2<em>pi&#x2F;dw+1:501];%建立通带频率样点数组<br>Rp&#x3D;-(min(db(wp0)))<br>ws0&#x3D;[ws1</em>pi&#x2F;dw+1:ws2*pi&#x2F;dw+1];%建立阻带频率样点数组<br>As&#x3D;-round(max(db(ws0)))<br>程序运行结果为Rp&#x3D;0.4602，As&#x3D;36，通阻带指标均有所提高。特性曲线如图12-15所示：</p>
<p>图12-15<br>三、实验内容：<br>1、阅读并输入实验原理中介绍的例题程序，观察输出的数据和图形，结合基本原理理解每一条语句的含义。<br>2、试用两种方法设计FIR数字高通滤波器，要求：ωp&#x3D;0.3 ，Rp&#x3D;0.5dB；ωs&#x3D;0.2 ，As&#x3D;55dB。选择合适的采样点数N，描绘该滤波器的脉冲响应、幅频响应曲线和相频响应曲线，并检验通阻带衰减指标是否满足设计要求。<br>方法一：用频率采样优化设计法，在过渡带增加两个采样点，T1&#x3D;0.5941，T2&#x3D;0.109。<br>方法二：用fir2函数进行设计，加hanning窗，在过渡带增加两个采样点，T1&#x3D;0.5941，T2&#x3D;0.109。<br>3、试用两种方法设计FIR数字带通滤波器，要求：ωp1&#x3D;0.4 ，ωp2&#x3D;0.4 ，Rp&#x3D;0.5dB；ωs1&#x3D;0.25 ，ωs2&#x3D;0.75 ，As&#x3D;40dB。选择合适的采样点数N，描绘该滤波器的脉冲响应、幅频响应曲线和相频响应曲线，并检验通阻带衰减指标是否满足设计要求。<br>方法一：用频率采样优化设计法，在过渡带增加一个采样点，T1&#x3D;0.38。<br>方法二：用fir2函数进行设计，加blackman窗，在过渡带增加一个采样点，T1&#x3D;0.38。<br>四、实验预习：<br>1、认真阅读实验原理。明确本次实验任务，读懂例题程序，了解实验方法。<br>2、根据实验任务预先编写实验程序。<br>3、预习思考题：<br>① 什么是频率采样法？简述频率采样法设计FIR数字滤波器的基本思路。<br>② 简述频率采样优化设计法的优缺点。<br>③ 用fir2函数设计FIR数字滤波器如何确定理想滤波器的幅频特性？如何在过渡带增加采样点？<br>五、实验报告：<br>1、列写调试通过的实验程序，打印实验程序产生的曲线图形。<br>2、给出预习思考题答案。</p>
<h1 id="附录1-MATLAB基础介绍"><a href="#附录1-MATLAB基础介绍" class="headerlink" title="附录1  MATLAB基础介绍"></a>附录1  MATLAB基础介绍</h1><p>1.1 MATLAB通用命令介绍<br>1.1.1、管理命令与函数<br>1、指定MATLAB搜索路径：path（），addpath（）与rmpath（）：指定、增加或删除MATLAB搜索路径。语法格式为<br>p&#x3D;path  将搜索路径字符串值返回给字符串变量p。<br>path(‘newdir’)  将搜索路径改变为字符串‘newdir’指定的路径。<br>rmpath(‘directory’)   删除‘directory’路径。<br>addpath(‘directory’)  增加‘directory’路径。<br>addpath（’dir1’,’dir2’,’dir3’,…）；<br>addpath(…,’-flag’)；其中flag值为0或begin表示将目录加在原搜索路径之前；1或end表示将目录加在原搜索路径之后。<br>addpath(‘newdir’,’begin’)相当于path(‘newdir’,path)；<br>addpath(‘newdir’,’end’)相当于path(path, ‘newdir’)。<br>2、doc命令：读入超文本文件<br>3、help命令：MATLAB函数和M-文件的在线式帮助。语法格式为<br>help topic   topic为要取得帮助的主题，可缺省topic。<br>4、type命令：在MATLAB命令窗口显示文件内容。语法格式为<br>type filename  filename 为文件名，缺省扩展名为“.m”。<br>5、what命令：列出给定目录下的所有M-文件、MAT-文件和MEX-文件。语法格式为<br>what  列出当前目录下的上述文件；<br>what dirname 列出给定目录dirname下的上述文件；dirname可不用全路径名称，只用最后一层或两层路径代替。<br>1.1.2、变量和工作空间管理命令与函数<br>1、clear命令：清除内存中的对象。语法格式为<br>clear 清除工作空间的所有变量；<br>clear name 清除工作空间中的M-文件、MEX-文件或变量name；如果name是全局变量，从工作空间清除后，任何定义全局变量的函数均可访问该变量；<br>clear name1 name2 name3… 从工作空间中清除name1 name2 name3…；<br>clear global name 从工作空间清除全局变量name；<br>clear keyword 根据不同keyword执行不同的操作；如果<br>keyword 为functions则从内存中清除现编译的M-函数；<br>keyword为variables则从工作空间中清除所有变量；<br>keyword为mex则从内存中清除MEX-文件；<br>keyword为global清除所有全局变量；<br>keyword为all清除内存中所有变量、函数、MEX-文件，使工作空间清空。<br>2、disp( )：显示文本或数组。语法格式为<br>disp(X)  如果X是数组，则显示数组内容；若X包含字符串，则显示字符串内容。<br>例1.1<br>Z&#x3D;[1+2i,2-2i,3-i;1+i,1+i,1-i;2-i,1+3i,4+i]<br>Z &#x3D;<br>   1.0000 + 2.0000i   2.0000 - 2.0000i   3.0000 - 1.0000i<br>   1.0000 + 1.0000i   1.0000 + 1.0000i   1.0000 - 1.0000i<br>   2.0000 - 1.0000i   1.0000 + 3.0000i   4.0000 + 1.0000i<br>str&#x3D;’Good Morning’<br>str &#x3D;Good Morning<br>disp(Z)<br>   1.0000 + 2.0000i   2.0000 - 2.0000i   3.0000 - 1.0000i<br>   1.0000 + 1.0000i   1.0000 + 1.0000i   1.0000 - 1.0000i<br>   2.0000 - 1.0000i   1.0000 + 3.0000i   4.0000 + 1.0000i<br>disp(str)<br>Good Morning<br>3、length()：计算向量长度。语法格式为<br>n&#x3D; length(X)  返回X最长维数大小；如果X是向量，返回其长度。<br>例1.2 以例1.1中的Z和str为例<br>n&#x3D;length(Z)<br>n &#x3D;     3<br>l&#x3D;length(str)<br>l &#x3D;12<br>4、size（）：计算数组维数大小。语法格式为<br>d&#x3D; size（X） 返回一个向量值d，向量中的元素值分别表示数组X的每维大小；<br>[m,n]&#x3D;size(X) 将矩阵X的大小返回到变量m,n中；<br>m&#x3D;size(X,dim) 返回X第dim指定维的大小。<br>例1.3 仍以1.1的Z和str为例<br>d&#x3D;size(Z)<br>d &#x3D;     3     3</p>
<blockquote>
<blockquote>
<p>[m,n]&#x3D;size(Z)<br>m &#x3D;     3<br>n &#x3D;     3<br>m1&#x3D;size(Z,1)<br>m1 &#x3D;     3<br>m3&#x3D;size(Z,3)<br>m3 &#x3D;    1<br>m2&#x3D;size(Z,2)<br>m2 &#x3D;     3<br>[m,n]&#x3D;size(str)<br>m &#x3D;     1<br>n &#x3D;     12<br>5、who，whos：列出内存中的变量目录。语法格式为<br>who  列出当前内存中的变量；<br>whos  列出当前内存值的变量、大小，以及是否有非零虚部；<br>who&#x2F;whos global 列出工作空间中的全局变量；<br>who&#x2F;whos- file  filename 列出所指定MAT文件中的变量；<br>who&#x2F;whos…var1 var2 显示指定的变量。<br>例1.4以例1.3运行后为例<br>who<br>Your variables are:<br>Z    d    m    m1   m2   m3   n    str<br>whos<br>  Name      Size                        Bytes  Class<br>  Z         3x3                         144  double array (complex)<br>  d         1x2                         16  double array<br>  m         1x1                         8  double array<br>  m1        1x1                         8  double array<br>  m2        1x1                         8  double array<br>  m3        1x1                         8  double array<br>  n         1x1                          8  double array<br>  str       1x12                         24  char array<br>Grand total is 28 elements using 224 bytes<br>6、clc：清除工作窗中的所有显示内容。<br>1.2 运算符和特殊字符<br>1、“+”：加号或一元运算符正号；A+B，则A和B两矩阵必须有相同的大小，或其中之一为标量，标量可以与任意大小的矩阵相加。<br>2、“-”：减号或一元运算符负号；A-B，则A和B两矩阵必须有相同的大小，或其中之一为标量，标量可以被任意大小的矩阵减去。<br>3、“﹡”：矩阵乘法；C&#x3D;A*B为两矩阵线性代数的乘积，即</p>
</blockquote>
</blockquote>
<p>对于非标量A和B，A的列数必须与B的行数相等，即公式中的n。一个标量可以与任何一个矩阵相乘。<br>4、“.﹡”：元素相乘；A.﹡B表示数组A和数组B的对应元素相乘；A和B必须大小相同，或者其中之一为标量。<br>5、“&#x2F;”：斜线或矩阵右除；B&#x2F;A近似等于B<em>inv(A)；精确地表示：B&#x2F;A&#x3D;(A’\B’)’。<br>6、“．&#x2F;”：元素右除；A.&#x2F;B表示矩阵元素A(i,j)&#x2F; B(i,j)；A和B必须大小相同，或者其中之一为标量。<br>7、“\”：反斜线或矩阵左除；如果A为方阵，A\B近似等于inv(A)<em>B。<br>8、“．\”：元素左除；A.\B表示矩阵元素B(i,j)&#x2F;A(i,j)；A和B必须大小相同，或者其中之一为标量。<br>9、“：”：冒号；是一个非常有用的操作符；可以产生向量、数组下标以及for循环。如：<br>j:k  相当于[j,j+1,….,k]；如果k&lt;j，则向量为空。<br>j:i:k  相当于[j,j+i,j+2i,…,k] ；如果i&gt;0,并且k&lt;j，则向量为空；或者i&lt;0,并且k&gt;j，则向量为空。<br>10、^：当A和B都是标量时，表示标量A的B次方幂。当A为方阵，B为正整数时，表示矩阵A的B次乘积；B为负整数时，表示矩阵A的逆的B次乘积。<br>11、关系运算符：&lt;,&gt;,&lt;&#x3D;,&gt;&#x3D;,&#x3D;&#x3D;,<del>&#x3D;分别表示“小于”“大于”“小于等于”“大于等于”“等于”“不等于”；对数组进行关系运算时，对每个元素进行比较，运算结果是一个与数组大小一样的由0和1构成的数组。&lt;,&gt;,&lt;&#x3D;,&gt;&#x3D;四种运算符只比较操作数实部，而&#x3D;&#x3D;,</del>&#x3D;既比较实部又比较虚部。<br>12、逻辑运算符：︱，&amp;，~，xor分别表示“或”“与”“非”“异或”运算。<br>1.3 基本概念<br>1、变量<br>MATLAB变量名遵循以下规则：<br>（1）必须以字母开头；<br>（2）字符长度不得超过31个；<br>（3）可以由字母、数字和下划线混合组成；<br>（4）区分大小写。<br>MATLAB中的固定变量：虚数单位i和j，圆周率pi<br>2、数值<br>MATLAB中常用十进制数来表示一个数值，也可用科学计数法来表示。如：<br>实数：123     虚数：3i        科学计数法：2.07e3（2.07×103）<br>3、矩阵<br>矩阵是MATLAB进行数据处理和运算的基本元素，是由下标表示次序的集合。通常意义上的标量（数量）是作为1×1的矩阵来处理的。<br>4、数组<br>从数的集合这个角度看，矩阵和数组并无不同，矩阵在某些情况下可视为二阶数组。但从运算角度看，二者的运算规则并不完全相同，因此在运算中要注意区别。<br>5、函数<br>MATLAB提供了丰富的内置函数，使用时可直接调用这些函数进行数据处理。函数由函数名和参数组成，调用格式如下：<br>6、函数名（参数）<br>如sin(t)<br>7、语句<br>MATLAB采用命令行式的表达式语言，一个命令就是一条语句，其格式与手写的数学表达式相似。在命令窗口输入语句并按回车键即可运行并输出结果。<br>MATLAB语句采用以下两种形式表示：<br>8、表达式<br>变量&#x3D;表达式<br>1.4  M文件<br>MATLAB的工作方式有两种：一种是交互式的指令操作方式，可在命令窗口直接输入命令行后按回车键，此方式适用于简单运算与结果分析；另一种是M文件的编程工作方式，适用于执行多条语句，解决复杂问题。<br>MATLAB为用户提供了专用的M文件编辑器，使用方法如下：<br>1、创建<br>启动MATLAB，单击命令窗口工具栏的“New M-File”图标按钮，即可打开M文件编辑器。在M文件编辑器中，用户可以用创建一般文本的办法编辑程序。<br>2、保存与打开<br>单击M文件编辑器窗口工具栏中的“Save”图标按钮。系统默认的文件名是“Untitled.m”,用户可重命名。系统默认的保存目录为“matlab所在目录\work”。<br>若要打开M文件，可单击MATLAB命令窗口工具栏的“Open file”按钮，打开用户指定的M文件。<br>3、执行<br>在MATLAB命令窗口键入M文件名（不加扩展名）并按回车键即可，或者在M文件编辑器的主工具栏上单击“run”图标。<br>若用户将文件保存在“work”以外的目录下，可通过在MATLAB命令窗口中添加工作路径来调用该文件：<br>【File】→【Set Path】→【Add Folder】→选择目录→【确定】→【Save】→【Close】<br>1.5 二维绘图<br>1、简单的二维曲线<br>一条曲线：plot(x,y)   以x向量为横轴，y向量为纵轴绘制曲线。<br>多条曲线：plot(x1,y1，’option’, x2,y2，’option’)   分别以x1,x2向量为横轴，y1,y2向量为纵轴绘制曲线。’option’表示每条曲线的属性，如颜色、线型等。曲线颜色、线型如下：<br>b     blue           .     point             -     solid<br>           g     green         o     circle             :     dotted<br>           r     red           x     x-mark            -.    dashdot<br>           c     cyan          +     plus              –    dashed<br>           m     magenta       *     star             (none)  no line<br>           y     yellow        s     square<br>           k     black         d     diamond<br>                               v     triangle (down)<br>                               ^     triangle (up)<br>                               &lt;     triangle (left)<br>                               &gt;     triangle (right)<br>                               p     pentagram<br>                               h     hexagram<br>亦可在画完一条曲线后用“hold”命令保持住，再画下一条曲线。<br>2、离散序列图的绘制<br>stem(k,y)    以k向量为横坐标，Y向量为纵坐标，画空心圆圈，并用线段连接到横轴。<br>stem(k,y,’filled’)或stem(k,y,’.’)  图形同上，只是空心圆圈变为实心。’filled’与’.’只是实心圆圈的大小不同。<br>1.6 图形处理<br>1.6.1 图形标注<br>1、坐标轴标注和图形标题<br>主要函数有xlable、ylabel、zlabel、和title等，它们的调用格式基本相同，具体代码如下：<br>xlabel(‘string’)<br>xlabel(fname)<br>xlabel(’…,’PropertyName’,PropertyValue,…)<br>ylabel(‘string’)<br>ylabel(fname)<br>zlabel(‘string’)<br>zlabel(fname)<br>title(‘string’)<br>titlel(fname)<br>title(’…,’PropertyName’,PropertyValue,…)<br>其中，string是标注所用的说明语句，fname是一个函数名，系统要求该函数必须返回一个字符串作为标注语句。’PropertyName’,PropertyValue,用于定义相应标注文本的属性和属性值，包括字体大小、字体名和字体粗细等。<br>例  x&#x3D;1:0.1</em>pi:2</em>pi;<br>y&#x3D;sin(x);<br>plot(x,y);<br>xlabel(‘x(0-2\pi)’,’fontweight’,’bold’);<br>ylabel(‘y&#x3D;sin(x)’,’fontweight’,’bold’);<br>title(‘正弦函数’,’fontsize’12,’FontWeight’,’bold’,’fontname’,’隶书’);<br>通过上述代码实现对坐标轴和图形的标注，如附图1-1所示：</p>
<p>附图1-1<br>在标注过程中经常会遇到特殊符号的输入问题，如上例中pi的输入，MATLAB语言提供了相应的字符转换。常见的转换如表1所示：<br>附表1-1                 MATLAB常见的字符转换<br>控制字符串	转换字符串	控制字符串	转换字符串<br>\alpha	α	\lambda	λ<br>\beta	β	\mu	μ<br>\gamma	γ	\xi	ξ<br>\delta	δ	\pi	π<br>\epsilon	ε	\omega	ω<br>\zeta	ζ	\tau	τ<br>\eta	η	\sigma	Σ<br>\theta	θ	\kappa	κ<br>\leftarrow	←	\uparrow	↑<br>2、用文本标注图形<br>在MATLAB语言中可以使用text或gtext命令对图形进行文本注释。使用text进行标注时需要定义用于注释的文本字符串和放置注释的位置，而使用gtext命令进行标注可以使用鼠标来选择标注文字放置的位置。调用格式如下：<br>text(x,y,’string’)<br>text(x,y,z,’string’)<br>text(x,y,z,’string’,’PropertyName’,PropertyValue….)<br>text(‘PropertyName’,PropertyValue….)<br>gtext(‘string’)<br>gtext({‘string1’,’string2’,’string3’,…})<br>gtext({‘string1’;’string2’;’string3’;…})<br>在定义标注放置的位置可以通过函数的计算值来确定，而且标注中还可以实时地调用返回值为字符串的函数，如num2str等，利用这些函数可以完成较为复杂的文本标注。<br>例   x&#x3D;1:0.1<em>pi:2</em>pi;<br>y&#x3D;sin(x);<br>plot(x,y);<br>xlabel(‘x(0-2\pi)’,’fontweight’,’bold’);<br>ylabel(‘y&#x3D;sin(x)’,’fontweight’,’bold’);<br>title(‘正弦函数’,’fontsize’,12,’fontweight’,’bold’,’fontname’,’隶书’);<br>text(3<em>pi&#x2F;4,sin(3</em>pi&#x2F;4),’\leftarrowsin(t)&#x3D;.707’,’fontsize’,16)<br>text(pi,sin(pi),’\leftarrowsin(t)&#x3D;0’,’fontsize’,16);<br>text(5<em>pi&#x2F;4,sin(5</em>pi&#x2F;4),’\leftarrowsin(t)&#x3D;-.707\rightarrow’,’HorizontalAlignment’,’right’,’fontsize’,16);<br>用text命令标注的图形如附图1-2所示</p>
<p>附图1-2<br>例  x&#x3D;1:0.1<em>pi:2</em>pi;<br>y&#x3D;sin(x);<br>plot(x,y);<br>gtext(‘y&#x3D;sin(x)’,’fontsize’,12);<br>执行gtext命令后，出现“+”形，如附图1-3所示：</p>
<p>附图1-3<br>通过“十”字形光标定位后最终图形如附图1-4所示</p>
<p>附图1-4<br>3、图例标注<br>在对数值结果绘图时，经常会出现在一张图中绘制多条曲线的情况，这时用户可以使用legend命令为曲线添加图例以便区分它们。该函数能够为图形中所有的曲线进行自动标注，并以输入变量作为标注文本。其调用格式如下：<br>legend(‘string1’,’string2’,…)<br>legend(…,’Location’,location)<br>其中’string1’,’string2’等分别标注对应绘图过程中按绘制先后顺序所生成的曲线，’Location’,location用于定义标注放置的位置。Location可以是一个1×4的向量（left bottom  width height）或任意一个字符串之一。对图例位置标注定义如下：<br>‘North’              inside plot box near top    绘图区内上中部<br>        ‘South’              inside bottom            绘图区内下部<br>        ‘East’               inside right              绘图区内右部<br>        ‘West’               inside left               绘图区内左部<br>        ‘NorthEast’          inside top right (default for 2-D plots)  右上部<br>        ‘NorthWest’           inside top left    左上部<br>        ‘SouthEast’          inside bottom right     右下<br>        ‘SouthWest’          inside bottom left     左下<br>        ‘NorthOutside’       outside plot box near top  绘图区外的上中部<br>        ‘SouthOutside’       outside bottom<br>        ‘EastOutside’        outside right<br>        ‘WestOutside’        outside left<br>        ‘NorthEastOutside’   outside top right (default for 3-D plots)<br>        ‘NorthWestOutside’   outside top left<br>        ‘SouthEastOutside’   outside bottom right<br>        ‘SouthWestOutside’   outside bottom left<br>        ‘Best’               least conflict with data in plot  标注与图形的重叠最小处<br>        ‘BestOutside’        least unused space outside plot绘图区外占用最小面积<br>标注的位置还可以通过定位代号来定义，代号说明如下：<br>0：自动定位，使得标注图标与图形重叠最少；<br>1：默认值，置于图形的右上角；<br>2：置于图形的左上角；<br>3：置于图形的左下角；<br>4：置于图形的右下角；<br>-1：置于图形的右外侧；<br>例  x&#x3D;-pi:pi&#x2F;20:pi;<br>plot(x,cos(x),’-ro’,x,sin(x),’-.b’);<br>legend(‘cos’,’sin’,2);<br>通过上述示例代码可以用鼠标来调整图例标注的位置，图例标注效果如附图1-5</p>
<p>附图1-5<br>1.6.2 坐标轴的控制<br>在MATLAB中可以通过设置各种参数来实现对坐标轴的控制，其中的高级控制涉及到图形句柄，这里只介绍初级的控制命令。<br>1、axis函数控制坐标轴特征<br>该命令用于控制坐标轴的刻度范围及显示形式，调用格式如下：<br>axis([xmin xmax ymin ymax])<br>axis([xmin xmax ymin ymax zmin zmax cmin cmax])<br>axis’控制字符串’<br>其中[xmin xmax ymin ymax zmin zmax]用于定义坐标轴范围，控制字符串可以是以下的任一表达式：<br>auto       自动模式，使得坐标轴范围能容下所有图形<br>manual     以当前的坐标轴范围限定图形的绘制，此后使用hold on命令再次绘图时保持坐标轴范围不变<br>tight       将坐标范围限制在指定的数据范围内<br>fill        设置坐标范围和PlotBoxAspectRatio属性以使坐标满足要求<br>ij         将坐标设置成矩阵形式，原点在左上角<br>xy        将坐标设置成直角坐标系<br>equal      将各坐标轴的刻度设置成相同<br>image     与equal类似<br>square    设置绘图区为正方形<br>vis3d     使图形在旋转或拉伸过程中保持坐标轴比例不变<br>normal    解除对坐标轴的任何限制<br>off       取消对坐标轴的一切设置<br>on       恢复对坐标轴的一切设置<br>例  x&#x3D;0:.025:pi&#x2F;2;<br>plot(x,tan(x),’-ro’)<br>使用axis命令设定坐标轴之前的图形如附图1-6所示：</p>
<p>附图1-6<br>axis([0 pi&#x2F;2 0 5]);<br>使用axis命令设定坐标轴之后的图形如附图1-7所示：</p>
<p>附图1-7<br>2、zoom函数控制坐标轴缩放，其调用格式如下：<br>zoom’控制字符串’<br>其中控制字符串可以是以下任一字符串：<br>空：在zoom on 和zoom off之间切换<br>（factor）：以factor作为缩放因子进行坐标轴缩放<br>on：允许对坐标轴缩放<br>off：禁止对坐标轴缩放<br>out：恢复到最初的坐标轴设置<br>reset：设置当前的坐标轴为最初值<br>xon：允许对x轴进行缩放<br>yon：允许对y轴进行缩放<br>3、grid函数控制坐标网格<br>该命令用于绘制坐标网格，其调用格式如下：<br>grid on &#x2F;&#x2F;给当前坐标轴添加网格线<br>grid off &#x2F;&#x2F;取消坐标轴的网格线<br>grid minor &#x2F;&#x2F;设置网格绘制的密度，即网格线间的间距<br>grid   &#x2F;&#x2F;在grid on和grid off之间切换<br>例  x&#x3D;0:0.1<em>pi:2</em>pi;<br>y&#x3D;sin(x);<br>plot(x,y);<br>grid on<br>使用grid添加网格线后如附图1-8所示：</p>
<p>附图1-8<br>4、box函数控制坐标轴封闭<br>该命令用于在图形四周都能显示坐标，其调用格式如下：<br>box on<br>box off<br>box<br>例  上例中添加box off命令后，其效果如附图1-9所示：</p>
<p>附图1-9<br>1.6.3 、图形数据取点<br>使用取点命令ginput可通过鼠标来读取二维平面图中任一点的坐标值。其调用格式如下：<br>[x,y]&#x3D;ginput(n) &#x2F;&#x2F; 可通过鼠标来选择n个点，它们的坐标值保存在[x,y]中，用户可通过enter键来结束取点<br>[x,y]&#x3D;ginput &#x2F;&#x2F;取点的数目不受限制，它们的坐标值保存在[x,y]中，用户可通过enter键来结束取点<br>[x,y，button]&#x3D;ginput (….)   &#x2F;&#x2F;返回值button记录了在选取每个点时的相关信息；<br>例    x&#x3D;0:0.1<em>pi:2</em>pi;<br>y&#x3D;sin(x);<br>plot(x,y);<br>[m,n]&#x3D;ginput(1)<br>hold on<br>plot(m,n,’ro’);<br>text(m(1),n(1),[‘m(1)&#x3D;’,num2str(m(1)),’n(1)&#x3D;’,num2str(n(1))]);<br>运行程序后取点前图形中会出现“＋”光标，如附图1-10所示：</p>
<p>附图1-10<br>取点结束后图形效果如附图1-11所示：</p>
<p>附图1-11<br>在MATLAB命令窗口会显示以下结果：<br>m &#x3D;    3.0081<br>n &#x3D;   0.11404<br>1.6.4  子图和图形保持<br>在绘图过程中，经常会碰到下面两种情形：在已存的一张图中添加新的曲线；将几个图形在同一个图形窗口表现出来，但又不在同一个坐标系中绘制。MATLAB为这两种需要分别提供hold函数和subplot函数。用法如下：<br>【hold函数】<br>hold on  &#x2F;&#x2F;启动图形保持功能，此后绘制的图形都添加到当前的图形窗口中，并自动调整坐标轴范围<br>hold off  &#x2F;&#x2F;关闭图形保持功能<br>hold   &#x2F;&#x2F;在hold on和hold off之间切换<br>【subplot函数】<br>该函数用于生成并控制多个坐标轴。把当前图形窗口分隔成几个矩形部分，不同的部分是按行方向以数字进行标号的。每一部分有一坐标轴。常用调用格式如下：<br>subplot(m,n,p)  &#x2F;&#x2F;将一图形窗口分成m*n个小窗口，在第p个小窗口中创建一坐标轴。则新的坐标轴成为当前坐标轴。如附图1-12所示。若p为一向量，则创建一坐标轴，包含所有罗列在p中的小窗口。用户可以通过参数p分别对各子绘图区域进行操作，子绘图区域的编号按行从左至右编号，如附图1-13所示.<br>subplot(m,n,p,’replace’)  &#x2F;&#x2F;如果定义的坐标轴已存在，那么就删掉已有的，并创建一个新的坐标轴<br>subplot(m,n,p,’align’)  &#x2F;&#x2F;对齐坐标轴<br>subplot(h)  &#x2F;&#x2F;使句柄h对应的坐标轴成为当前的，用于后面图形的显示<br>subplot(‘position’,[left bottom width height])  &#x2F;&#x2F;在由4个元素指定的位置上创建一坐标轴。位置元素的单位为归一化单位。<br>例  income&#x3D;[3.2 4.1 5.0 5.6];outgo&#x3D;[2.5 4.0 3.35 4.9];<br>subplot(2,1,1);plot(income);subplot(2,1,2);plot(outgo);</p>
<p>附图1-12</p>
<p>附图1-13<br>1.7 矩阵元素的数学函数<br>1.7.1 三角函数<br>MATLAB提供的三角函数及其功能如附表1-1所示：<br>附表1-1 三角函数<br>函数名	功能描述	函数名	功能描述<br>sin	正弦	sec	正割<br>sind	正弦，输出以度为单位	secd	正割，输出以度为单位<br>sinh	双曲正弦	sech	双曲正割<br>asin	反正弦	asec	反正割<br>asind	反正弦，输出以度为单位	asecd	反正割，输出以度为单位<br>asinh	反双曲正弦	asech	反双曲正割<br>cos	余弦	csc	余割<br>cosd	余弦，输出以度为单位	cscd	余割，输出以度为单位<br>cosh	双曲余弦	csch	双曲余割<br>acos	反余弦	acsc	反余割<br>acosd	反余弦，输出以度为单位	acscd	反余割，输出以度为单位<br>acosh	反双曲余弦	acsch	反双曲余割<br>tan	正切	cot	余切<br>tand	正切，输出以度为单位	cotd	余切，输出以度为单位<br>tanh	双曲正切	coth	双曲余切<br>atan	反正切	acot	反余切<br>atand	反正切，输出以度为单位	acotd	反余切，输出以度为单位<br>atan2	四象限反正切	acoth	反双曲余切<br>atanh	反双曲正切		<br>1.7.2 指数和对数函数<br>MATLAB提供的指数、对数函数及其功能如附表1-2所示：<br>附表1-2 指数和对数函数<br>函数名	功能描述	函数名	功能描述<br>exp	以e为底的指数	realpow	对数，若结果是复数则报错<br>expm1	准确计算exp(x)-1的值	reallog	自然对数，若输入不是正数则报错<br>log	自然对数（以e为底）	realsqrt	开平方根，若输入不是正数则报错<br>log1p	准确计算log(1+x)的值	sqrt	开平方根<br>log10	常用对数（以10为底）	nthroot	求x的n次方根<br>log2	以2为底的对数	nextpow2	返回满足2^P&gt;&#x3D;abs(N)的最小整数P，其中N为输入<br>pow2	以2为底的指数		</p>
<p>1.7.3 复数函数<br>MATLAB提供的复数函数及其功能如附表1-3所示：<br>附表1-3 复数函数<br>函数名	功能描述	函数名	功能描述<br>abs	绝对值（复数的模）	real	复数的实部<br>angle	复数的相角	unwrap	调整矩阵元素的相位<br>complex	用实部和虚部构造一个复数	isreal	是否为实数矩阵<br>conj	复数的共轭	cplxpair	把复数矩阵排列成为复共轭对<br>imag	复数的虚部		</p>
<p>1.7.4  截断和求余函数<br>MATLAB提供的截断和求余函数及其功能如附表1-4所示：<br>附表1-4 截断和求余函数<br>函数名	功能描述	函数名	功能描述<br>fix	向零取整	mod	除法求余（与除数同号）<br>floor	向负无穷方向取整	rem	除法求余（与被除数同号）<br>ceil	向正无穷方向取整	sign	符号函数<br>round	四舍五入		</p>
<p>下例说明函数fix()，floor()，ceil()和round()的区别，具体代码如下：<br>a&#x3D;[-1.55 -1.45 1.45 1.55];<br>a_fix&#x3D;fix(a)<br>a_floor&#x3D;floor(a)<br>a_ceil&#x3D;ceil(a)<br>a_round&#x3D;round(a)<br>代码运行结果如下：<br>a_fix &#x3D;    -1    -1     1     1<br>a_floor &#x3D;    -2    -2     1     1<br>a_ceil &#x3D;    -1    -1     2     2<br>a_round &#x3D;    -2    -1     1     2<br>下面的例子说明函数mod()和rem()的区别，具体代码如下：<br>a&#x3D;[10 -10 10 -10];<br>b&#x3D;[8 -8 -8 8];<br>c_rem&#x3D;rem(a,b)<br>c_mod&#x3D;mod(a,b)<br>代码运行结果如下<br>c_rem &#x3D;     2    -2     2    -2<br>c_mod &#x3D;     2    -2    -6     6<br>求矩阵的符号使用函数sign()，示例代码如下：<br>a&#x3D;-2:2;<br>a_sign&#x3D;sign(a)<br>代码运行结果如下：<br>a_sign &#x3D;   -1    -1     0     1     1<br>1.8  基本数据分析函数<br>MATLAB提供的部分基本数据分析函数的功能和调用格式如附表1-5所示：<br>附表 1-5<br>函数名	功能描述	基本调用格式<br>max	求最大值	C&#x3D;max(A)，如果A是向量，返回向量中的最大值；如果A是矩阵，返回一个包含各列最大值的行向量<br>C&#x3D;max(A,B)，返回矩阵A和B中较大的元素，矩阵A和B必须具有相同的大小<br>C&#x3D;max(A，[]，dim)，返回dim维上的最大值<br>[C，I]&#x3D;max(…)，多返回最大值的下标<br>min	求最小值	同max函数的调用格式<br>mean	求平均值	M&#x3D;mean(A)，如果A是向量，返回向量的平均值；如果A是矩阵，返回一个包含各列平均值的行向量<br>M&#x3D;mean(A，dim)，返回dim维上的平均值<br>median	求中间值	同mean函数的调用格式</p>
<h1 id="附录2-信号处理工具箱常用函数介绍"><a href="#附录2-信号处理工具箱常用函数介绍" class="headerlink" title="附录2   信号处理工具箱常用函数介绍"></a>附录2   信号处理工具箱常用函数介绍</h1><p>MATLAB提供了许多进行信号处理的工具箱函数，本附录仅给出部分在数字信号处理教学中常用函数的说明。更多有关这些工具箱函数的使用可参考help文件。<br>为方便查阅，分组给出这些常用函数的说明。</p>
<p>一、波形产生<br>1、chirp：产生扫频余弦函数<br>2、diric：产生Dirichlet或周期sinc函数<br>3、gauspuls：产生高斯调制的正弦曲线脉冲<br>4、gmonopuls：产生高斯单脉冲<br>5、pulstran：产生一个脉冲序列<br>6、rectpuls：产生一个非周期的抽样方波<br>7、sawtooth：产生锯齿波或三角波<br>8、sinc：产生sinc函数，即<br>9、square：产生方波<br>10、tripuls：产生一个非周期的采样三角波<br>11、vco：压控振荡器</p>
<p>二、线性系统变换<br>1、latc2tf：由格形结构向传递函数转变<br>2、polystab：使多项式稳定<br>3、polyscal：多项式根乘以倍率<br>4、residuez：z变换部分分式展开<br>5、sos2ss：级联二阶节向状态空间转换<br>6、sos2tf：级联二阶节向传递函数转换<br>7、sos2zp：级联二阶节向零增益转换<br>8、ss2sos：状态空间转换为二阶节级联<br>9、ss2tf：状态空间向传递函数转换<br>10、ss2zp：状态空间向零增益转换<br>11、tf2latc：传递函数向格形转换<br>12、tf2sos：传递函数向级联二阶节转换<br>13、tf2ss：传递函数向状态空间转换<br>14、tf2zp：传递函数向零增益转换<br>15、zp2sos：零增益向级联二阶节转换<br>16、zp2ss：零增益向状态空间转换<br>17、zp2tf：零增益向传递函数转换<br>三、系统分析<br>1、abs：取绝对值（幅值）<br>2、angle：取相角<br>3、freqs：模拟系统频率响应<br>4、freqspace：为频率响应设定频率间隔<br>5、freqz：数字滤波器频率响应<br>6、freqzplot：频率响应绘制<br>7、grpdelay：群迟延<br>8、impz：数字系统的冲激响应<br>9、zplane：离散系统的零极点图</p>
<p>四、滤波器实现<br>1、conv：卷积<br>2、conv2：二维卷积<br>3、deconv：解卷积<br>4、filtic：确定滤波器原始条件<br>5、filter：滤波器实现<br>6、filter2：二维滤波器实现<br>7、filtfilt：零相位滤波<br>8、fftfilt：重叠相加滤波器实现<br>9、latcfilt：格形滤波器实现<br>10、sosfilt：二阶节（biquad）滤波实现</p>
<p>五、FIR滤波器设计<br>1、fir1：基于窗函数FIR滤波器设计<br>2、fir2：基于窗函数的任意响应FIR滤波器设计<br>3、fir1s：最小二乘法FIR滤波器设计<br>4、firrcos：升余弦FIR滤波器设计<br>5、intfilt：插值FIR滤波器设计<br>6、kaiserord：基于窗函数的Kaiser滤波器阶数选择<br>7、remez：Parks-McClellan最优FIR滤波器设计<br>8、remezord：Parks-McClellan最优FIR滤波器阶数估计</p>
<p>六、IIR滤波器设计<br>1、butter：巴特沃斯滤波器设计<br>2、cheby1：切比雪夫Ⅰ型滤波器设计<br>3、cheby2：切比雪夫Ⅱ型滤波器设计<br>4、ellip：椭圆滤波器设计<br>5、maxfiat：归一化的巴特沃斯低通滤波器设计<br>6、yulewalk：耶鲁-沃克滤波器设计<br>7、buttord：巴特沃斯滤波器阶数选择<br>8、cheb1ord：切比雪夫Ⅰ型滤波器阶数选择<br>9、cheb2ord：切比雪夫Ⅱ型滤波器阶数选择<br>10、ellipord：椭圆滤波器阶数选择</p>
<p>七、模拟低通原型滤波器设计<br>1、besselap：贝塞尔滤波器原型<br>2、buttap：巴特沃斯滤波器原型<br>3、cheb1ap：切比雪夫Ⅰ型滤波器原型<br>4、cheb2ap：切比雪夫Ⅱ型滤波器原型<br>5、ellipap：椭圆滤波器原型<br>八、模拟低通滤波器设计<br>1、besself：贝塞尔模拟滤波器设计<br>2、butter：巴特沃斯滤波器设计<br>3、cheby1：切比雪夫Ⅰ型滤波器设计<br>4、cheby2：切比雪夫Ⅱ型滤波器设计<br>5、ellip：椭圆滤波器设计</p>
<p>九、模拟滤波器频带变换<br>1、lp2bp：低通向带通模拟滤波器变换<br>2、lp2bs：低通向带阻模拟滤波器变换<br>3、lp2hp：低通向高通模拟滤波器变换<br>4、lp2lp：低通向低通模拟滤波器变换</p>
<p>十、滤波器离散化<br>1、bilinear：双线性变换<br>2、impinvar：脉冲响应不变法模拟向数字的转换</p>
<p>十一、窗函数<br>1、boxcar：矩形窗函数<br>2、bartlett：Bartlett窗函数<br>3、blackman：布莱克曼窗函数<br>4、chebwin：切比雪夫窗函数<br>5、hamming：汉明窗函数<br>6、hanning：汉宁窗函数<br>7、kaiser：凯赛尔窗函数<br>8、triang：三角窗函数</p>
<p>十二、变换<br>1、czt：线性调频z变换<br>2、dct：离散的余弦变换<br>3、fft：快速傅立叶变换<br>4、fft2：二维快速傅立叶变换<br>5、fftshift：交换矢量的一半<br>6、hilbert：希尔伯特变换<br>7、idct：离散的余弦逆变换<br>8、ifft：快速傅立叶逆变换<br>9、ifft2维快速傅立叶逆变换</p>
<p>十三、图形用户界面工具<br>1、fdatool：滤波器分析设计工具<br>2、sptool：信号处理工具</p>

</div>

        </div>
    </div>
    
<script src="/lib/highlight/highlight.pack.js"></script>

    
<script src="/lib/jquery-3.4.1.min.js"></script>

    
<script src="/lib/jquery.pjax.js"></script>

    
<script src="/js/main.js"></script>


</body>
</html>
